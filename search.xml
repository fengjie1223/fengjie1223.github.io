<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>复卷定长校准方案</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E5%A4%8D%E5%8D%B7%E5%AE%9A%E9%95%BF%E6%A0%A1%E5%87%86%E6%96%B9%E6%A1%88/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E5%A4%8D%E5%8D%B7%E5%AE%9A%E9%95%BF%E6%A0%A1%E5%87%86%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h1 id="复卷定长校准方案"><a href="#复卷定长校准方案" class="headerlink" title="复卷定长校准方案"></a>复卷定长校准方案</h1><h2 id="1-方案描述"><a href="#1-方案描述" class="headerlink" title="1. 方案描述"></a>1. 方案描述</h2><p>复卷定长校准方案，是针对复卷生产与复卷由于张力或其它因素造成缺陷位置变化的定长校准缺陷位置的方案。</p><h2 id="2-方案原理"><a href="#2-方案原理" class="headerlink" title="2. 方案原理"></a>2. 方案原理</h2><p>主线生产定长打标，复卷机复卷，检测标签，根据检测到的标签位置校准放卷米数。</p><h2 id="3-方案流程"><a href="#3-方案流程" class="headerlink" title="3. 方案流程"></a>3. 方案流程</h2><h3 id="3-1-方案流程图"><a href="#3-1-方案流程图" class="headerlink" title="3.1 方案流程图"></a>3.1 方案流程图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line"></span><br><span class="line">大线</span><br><span class="line">--&gt;每100米贴标</span><br><span class="line">--&gt;复卷</span><br><span class="line">--&gt;检测标签--有标签</span><br><span class="line">--&gt;校准计米</span><br></pre></td></tr></table></figure><h3 id="3-2-方案流程描述"><a href="#3-2-方案流程描述" class="headerlink" title="3.2 方案流程描述"></a>3.2 方案流程描述</h3><p>复卷定长校准方案，主线每隔100米贴标，然后复卷，检测标签，根据检测到的标签位置校准放卷米数。</p><h3 id="软件重启"><a href="#软件重启" class="headerlink" title="软件重启"></a>软件重启</h3><p>重启软件读取控制器的计米。</p><h3 id="自动计算系数"><a href="#自动计算系数" class="headerlink" title="自动计算系数"></a>自动计算系数</h3><p>探测到标签自动计算系数。</p><h3 id="按钮纠偏"><a href="#按钮纠偏" class="headerlink" title="按钮纠偏"></a>按钮纠偏</h3><ul><li>验光板上下2排按钮，每按一下上下纠偏固定长度。</li><li>18个通道，每个通道两个按钮。</li><li>每次停机只能纠偏一次，纠偏与复位按钮为独立的按钮。</li></ul><h3 id="软件贴标"><a href="#软件贴标" class="headerlink" title="软件贴标"></a>软件贴标</h3><ul><li>软件贴标，每100米贴一次，不要记录到报表中。</li><li>PLC根据实际米长以及检测到的标签位置，计算校准系数。并完成校准。</li><li>定长贴标的记录，校准</li><li>卷尾贴标必须使用。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 复卷瑕疵定位系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 复卷瑕疵定位系统 </tag>
            
            <tag> 复卷 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode-随用笔记</title>
      <link href="/2023/11/17/%E7%BB%BC%E5%90%88/vscode/vscode-%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/11/17/%E7%BB%BC%E5%90%88/vscode/vscode-%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="VScode"><a href="#VScode" class="headerlink" title="VScode"></a>VScode</h1><h2 id="配置VScode语言"><a href="#配置VScode语言" class="headerlink" title="配置VScode语言"></a>配置VScode语言</h2><ol><li>调出命令框（Ctrl+Shift+P）</li><li>输入language</li><li>选择configure display language</li><li>选择en（英文），zH-cn（中文简体）</li></ol><h2 id="格式化文本"><a href="#格式化文本" class="headerlink" title="格式化文本"></a>格式化文本</h2><ol><li>安装插件Clang-Format（写文档的时候，不确定是否一定要安装这个插件）</li><li>clang-Format 下载LLVM，并安装。（还需要在vs中设置google格式化规则）<ol><li>Ctrl + ,， 打开设置</li><li>输入 clang-format</li><li>将C_Cpp.clang_format_fallbackStyle值从Visual Studio改为 Google</li><li>如图<img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111717270318-1691114628952.png" alt="image"></li></ol></li><li>默认格式化配置<ol><li>右键-&gt;使用…格式化-&gt;选择clang-Format（google格式），也可以选择系统默认格式化。</li></ol></li></ol><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><ol><li>C&#x2F;C++</li><li>ChatGPT-中文版 （注册账号可以免费使用gpt-3.5）</li><li>Chinese（简体中文）</li><li>Clang-Format   （代码google格式化规则）</li><li>Code Runner    （运行多种语言代码）</li><li>Keil Assistant    （MDK开发支持）</li><li>Markdown PDF</li><li>Markdown All in One</li><li>Markdown Preview Enhanced （预览可以有目录）</li><li>markdownlint  （检查md语法格式，格式化）</li><li>Typora</li><li>python</li><li>Var Conversion （变量名称转换）</li><li>verilog-HDL&#x2F;System Verilog&#x2F;Bluespec SystemVerilog（verilog语法高亮，格式化）</li><li>vscode-icons （图标）</li><li>vscode-mindmap   (思维导图，文件名*.km可以使用)</li><li>Qt tools   （备选，扫描套件用，不建议工程使用）</li><li>Qt Configure （备选，可以用vscode新建并开发qt程序，需要注意，尽量不要用qt creator 大量改动文件结构，不建议工程使用）</li><li>GitHub Copilot （很好用的代码AI提示，需要付费，会严重拖慢VScode的启动速度</li><li>Tabnine AI ***** （免费的代码AI提示，相对不那么智能，会严重拖慢VScode的启动速度</li><li>markmap (好用的markdown转思维导图工具)</li><li>var-translate-en (好用的中文翻译工具)</li></ol>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> vscode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vscode </tag>
            
            <tag> 环境搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>项目经验-张力分段折叠机</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8A%98%E5%8F%A0%E6%9C%BA/%E5%BC%A0%E5%8A%9B%E5%88%86%E6%AE%B5%E6%8A%98%E5%8F%A0%E6%9C%BA/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8A%98%E5%8F%A0%E6%9C%BA/%E5%BC%A0%E5%8A%9B%E5%88%86%E6%AE%B5%E6%8A%98%E5%8F%A0%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="张力分段折叠机"><a href="#张力分段折叠机" class="headerlink" title="张力分段折叠机"></a>张力分段折叠机</h1><h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><ul><li>崇阳稳健</li></ul><h2 id="要点简述"><a href="#要点简述" class="headerlink" title="要点简述"></a>要点简述</h2><ul><li>项目主要难点为材料分折叠前和折叠后两段，中间由一个浮动滚保持整体张力，由于浮动滚为循环滚动，故此无法准确得知折叠前的动态踢废间隔。</li><li>解决方法：使用了两段编码器互差的方法，以浮动滚落在最低处为基准点，计算出两段编码器差值，以此计算出两段材料之间的间距。</li><li>此方法存在误差，误差为浮动滚限位响应误差。</li><li>另一个主要难点：折叠前使用了面阵相机拍照一片产品拍两次，上半部分拍一张，下半部分拍一张，以此计算出产品对应的踢废间隔。对齐工位踢废。</li><li>解决方法：拍照时候记录位置信息。每个光电信号与产品对应。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目经验 </category>
          
          <category> 折叠机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目经验 </tag>
            
            <tag> 张力分段折叠机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>项目经验-多通道折叠机</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8A%98%E5%8F%A0%E6%9C%BA/%E5%A4%9A%E9%80%9A%E9%81%93%E6%8A%98%E5%8F%A0%E6%9C%BA/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8A%98%E5%8F%A0%E6%9C%BA/%E5%A4%9A%E9%80%9A%E9%81%93%E6%8A%98%E5%8F%A0%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="多通道折叠机"><a href="#多通道折叠机" class="headerlink" title="多通道折叠机"></a>多通道折叠机</h1><h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><ul><li>崇阳稳健</li></ul><h2 id="要点简述"><a href="#要点简述" class="headerlink" title="要点简述"></a>要点简述</h2><ul><li>两个通道，四台相机，两台相机为一个通道</li><li>排片为固定节拍，踢废产品不计入节拍数量</li><li>使用光电计数</li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目经验 </category>
          
          <category> 多通道折叠机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目经验 </tag>
            
            <tag> 多通道折叠机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows-环境搭建</title>
      <link href="/2023/11/17/%E7%BB%BC%E5%90%88/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/Windows/"/>
      <url>/2023/11/17/%E7%BB%BC%E5%90%88/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/Windows/</url>
      
        <content type="html"><![CDATA[<h1 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h1><h2 id="系统语言"><a href="#系统语言" class="headerlink" title="系统语言"></a>系统语言</h2><p>系统语言选择English，地区选择china，格式选择chinese<br><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111717252575-1690882648100.png" alt="image"></p><h2 id="通用软件语言"><a href="#通用软件语言" class="headerlink" title="通用软件语言"></a>通用软件语言</h2><p>部分软件乱码解决办法<br><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111717253821-1690882746021.png" alt="image"></p>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> 办公 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 环境搭建 </tag>
            
            <tag> Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>InnoSetup-脚本定制</title>
      <link href="/2023/11/17/Qt/InnoSetup/%E8%84%9A%E6%9C%AC%E5%AE%9A%E5%88%B6/"/>
      <url>/2023/11/17/Qt/InnoSetup/%E8%84%9A%E6%9C%AC%E5%AE%9A%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="InnoSetup"><a href="#InnoSetup" class="headerlink" title="InnoSetup"></a>InnoSetup</h1><h2 id="添加和卸载环境变量"><a href="#添加和卸载环境变量" class="headerlink" title="添加和卸载环境变量"></a>添加和卸载环境变量</h2><figure class="highlight pascal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[Code]</span><br><span class="line"><span class="comment">// 设置环境变量函数</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">SetEnv</span><span class="params">(aEnvName, aEnvValue: <span class="keyword">string</span>; aIsInstall, aIsInsForAllUser: Boolean)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">sOrgValue: <span class="keyword">string</span>;</span><br><span class="line">sFileName: <span class="keyword">string</span>;</span><br><span class="line">S1: AnsiString;                                                  <span class="comment">//注意类型是AnsiString,不是string</span></span><br><span class="line">bRetValue, bInsForAllUser: Boolean;</span><br><span class="line">SL: TStringList;</span><br><span class="line">x: integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">bInsForAllUser := aIsInsForAllUser;</span><br><span class="line"><span class="keyword">if</span> UsingWinNT <span class="keyword">then</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> bInsForAllUser <span class="keyword">then</span></span><br><span class="line">      bRetValue := RegQueryStringValue(HKEY_LOCAL_MACHINE, <span class="string">&#x27;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&#x27;</span>, aEnvName, sOrgValue)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      bRetValue := RegQueryStringValue(HKEY_CURRENT_USER, <span class="string">&#x27;Environment&#x27;</span>, aEnvName, sOrgValue);</span><br><span class="line">    sOrgValue := Trim(sOrgValue);</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      S1 := aEnvValue;</span><br><span class="line">      <span class="keyword">if</span> pos(Uppercase(s1), Uppercase(sOrgValue)) = <span class="number">0</span> <span class="keyword">then</span> <span class="comment">//还没有加入</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> aIsInstall <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          x := Length(sOrgValue);</span><br><span class="line">          <span class="keyword">if</span> (x &gt; <span class="number">0</span>) <span class="keyword">and</span> (StringOfChar(sOrgValue[x], <span class="number">1</span>) &lt;&gt; <span class="string">&#x27;;&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">            sOrgValue := sOrgValue + <span class="string">&#x27;;&#x27;</span>;</span><br><span class="line">          sOrgValue := sOrgValue + S1;</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">else</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> aIsInstall <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          StringChangeEx(sOrgValue, S1 + <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, True);</span><br><span class="line">          StringChangeEx(sOrgValue, S1, <span class="string">&#x27;&#x27;</span>, True);</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> bInsForAllUser <span class="keyword">then</span></span><br><span class="line">        RegWriteStringValue(HKEY_LOCAL_MACHINE, <span class="string">&#x27;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&#x27;</span>, aEnvName, sOrgValue)</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">not</span> aIsInstall) <span class="keyword">and</span> (Trim(sOrgValue) = <span class="string">&#x27;&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">          RegDeleteValue(HKEY_CURRENT_USER, <span class="string">&#x27;Environment&#x27;</span>, aEnvName)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          RegWriteStringValue(HKEY_CURRENT_USER, <span class="string">&#x27;Environment&#x27;</span>, aEnvName, sOrgValue);</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">else</span> <span class="comment">//非NT 系统,如Win98</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    SL := TStringList.Create;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">      sFileName := ExpandConstant(<span class="string">&#x27;&#123;sd&#125;\autoexec.bat&#x27;</span>);</span><br><span class="line">      LoadStringFromFile(sFileName, S1);</span><br><span class="line">      SL.Text := s1;</span><br><span class="line">      s1 :=   <span class="string">&#x27;&quot;&#x27;</span> + aEnvValue + <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">      s1 := <span class="string">&#x27;set &#x27;</span>+aEnvName +<span class="string">&#x27;=%path%;&#x27;</span> + s1 ;</span><br><span class="line"></span><br><span class="line">      bRetValue := False;</span><br><span class="line">      x := SL.IndexOf(s1);</span><br><span class="line">      <span class="keyword">if</span> x = -<span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> aIsInstall <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          SL.Add(s1);</span><br><span class="line">          bRetValue := True;</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">else</span> <span class="comment">//还没添加</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> aIsInstall <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          SL.Delete(x);</span><br><span class="line">          bRetValue := True;</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> bRetValue <span class="keyword">then</span></span><br><span class="line">        SL.SaveToFile(sFileName);</span><br><span class="line">    <span class="keyword">finally</span></span><br><span class="line">      SL.free;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 安装前添加环境变量</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">CurStepChanged</span><span class="params">(CurStep: TSetupStep)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">if</span> CurStep = ssInstall <span class="keyword">then</span>                        <span class="comment">//对于(ssInstall)这个变量可依据自身需要进行更改，帮助文档中有说明(也可是安装完成之后进行写入对应变量为ssDone)</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="comment">// 将&#123;app&#125;路径添加到path环境变量中</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;;&#x27;),true,true); //对于添加多个环境变量需要注意要添加分割符号&quot;;&quot;,否则系统会认为是一个</span></span><br><span class="line">     SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\pylon&#x27;</span>),true,true); <span class="comment">//在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">     SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\opencv&#x27;</span>),true,true); <span class="comment">//在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\x86&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">     SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\x64&#x27;</span>),true,true); <span class="comment">//在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//if CurStep = ssDone then                        //对于(ssInstall)这个变量可依据自身需要进行更改，帮助文档中有说明(也可是安装完成之后进行写入对应变量为ssDone)</span></span><br><span class="line">  <span class="comment">//begin</span></span><br><span class="line">  <span class="comment">// 将&#123;app&#125;路径添加到path环境变量中</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;;&#x27;),true,true); //对于添加多个环境变量需要注意要添加分割符号&quot;;&quot;,否则系统会认为是一个</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\pylon&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\opencv&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">    <span class="comment">// SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\x86&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\x64&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">  <span class="comment">//end;</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 卸载前删除环境变量</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">CurUninstallStepChanged</span><span class="params">(CurUninstallStep: TUninstallStep)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">// 将&#123;app&#125;路径从path环境变量中删除</span></span><br><span class="line">  <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;;&#x27;),false,true);</span></span><br><span class="line">  SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\pylon&#x27;</span>),false,true); <span class="comment">//卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line">  SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\opencv&#x27;</span>),false,true); <span class="comment">//卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line">  <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\x86&#x27;),false,true); //卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line">  SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\x64&#x27;</span>),false,true); <span class="comment">//卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="完整项目示例"><a href="#完整项目示例" class="headerlink" title="完整项目示例"></a>完整项目示例</h2><figure class="highlight pascal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br></pre></td><td class="code"><pre><span class="line">; Script generated by the Inno Setup Script Wizard.</span><br><span class="line">; SEE THE DOCUMENTATION <span class="keyword">FOR</span> DETAILS <span class="keyword">ON</span> CREATING INNO SETUP SCRIPT FILES!</span><br><span class="line"></span><br><span class="line">#define MyAppName &quot;恒意得上位机_230809&quot;</span><br><span class="line">#define MyAppVersion &quot;<span class="number">9.22</span>.<span class="number">10.26</span>&quot;</span><br><span class="line">#define MyAppPublisher &quot;HID&quot;</span><br><span class="line">#define MyAppURL &quot;https:<span class="comment">//www.hengideal.com/&quot;</span></span><br><span class="line">#define MyAppExeName &quot;controller.exe&quot;</span><br><span class="line"></span><br><span class="line">;标准控制器</span><br><span class="line">#define btn_Controller_V9</span><br><span class="line">;检测停机V3                             </span><br><span class="line">;#define btn_RewindDetectionShutdown_V3              </span><br><span class="line">;信号转换器</span><br><span class="line">;#define btn_InputSignalConverter                    </span><br><span class="line">;一体机</span><br><span class="line">;#define btn_YiTiJi                                  </span><br><span class="line">;复卷系统</span><br><span class="line">;#define btn_Rewinding_System                        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;****************我是分割线****************</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;是否集成X线组件</span><br><span class="line">;#define btn_XLine                                   </span><br><span class="line">;定位转IO</span><br><span class="line">;#define btn_PositioningTo                           </span><br><span class="line">;检测停机V2</span><br><span class="line">;#define btn_RewindDetectionShutdown_V2              </span><br><span class="line">;光源控制器</span><br><span class="line">;#define btn_Light_source_controller                 </span><br><span class="line">;崇阳折叠机<span class="number">2</span>通道<span class="number">4</span>相机</span><br><span class="line">;#define btn_Gauze_2ch_4cam                          </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[Types]</span><br><span class="line"><span class="keyword">Name</span>: Compact ;Description:&quot;简洁安装&quot;;        </span><br><span class="line"><span class="keyword">Name</span>: Full ;Description:&quot;完全安装&quot;;    </span><br><span class="line"><span class="keyword">Name</span>: Custom; Description:&quot;自定义安装&quot;;       Flags: iscustom</span><br><span class="line">;上述代码会根据写代码顺序排列选择顺序,,,Flags:iscustom,为标记该类型为自定义安装.配合下述Components代码实现选择安装</span><br><span class="line"></span><br><span class="line">#ifdef  btn_Controller_V9</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:control_v9;Description:&quot;标准控制器&quot;;Types:Full Compact Custom;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\标准控制器\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\标准控制器&quot;; Flags: ignoreversion   ;Components: control_v9</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#MyAppExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion ; Components: control_v9</span><br><span class="line">;语句后增加 Flags:fixed 字段 可强制安装</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#MyAppName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#MyAppExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:control_v9</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#MyAppExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(MyAppName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent    ;Components:control_v9</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;X线定义</span><br><span class="line">#ifdef btn_XLine</span><br><span class="line">#define X_LineName &quot;X线控制器&quot;</span><br><span class="line">#define X_LineExeName &quot;X_line.exe&quot;</span><br><span class="line">#define Xline_HMIName &quot;X线PLC设置&quot;</span><br><span class="line">#define Xline_HMIExeName &quot;Xline_HMI.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:X_Line;Description:<span class="comment">&#123;#X_LineName&#125;</span>;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\折叠机_X线\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\折叠机_X线&quot;; Flags: ignoreversion   ;Components: X_Line</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: X_Line</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#Xline_HMIExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: X_Line</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#Xline_HMIName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Xline_HMIExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:X_Line</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(X_LineName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent   ;Components:X_Line</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Xline_HMIExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(Xline_HMIName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent     ;Components:X_Line</span><br><span class="line">;上述代码将在安装完成界面添加check选项框,是否运行,或者可以添加打开更新日志之类的功能</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;一体机定义</span><br><span class="line">#ifdef btn_YiTiJi</span><br><span class="line">#define YiTiJiName &quot;一体机&quot;</span><br><span class="line">#define YiTiJiExeName &quot;YiTiJi.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:YiTiJi;Description:<span class="comment">&#123;#YiTiJiName&#125;</span>;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\包装检测一体机\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\包装检测一体机&quot;; Flags: ignoreversion   ;Components: YiTiJi</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#YiTiJiExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: YiTiJi</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#YiTiJiName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#YiTiJiExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:YiTiJi</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#YiTiJiExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(YiTiJiName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent   ;Components:YiTiJi</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;复卷系统定义</span><br><span class="line">#ifdef btn_Rewinding_System </span><br><span class="line">#define  Rewinding_SystemName &quot;复卷数据系统&quot;</span><br><span class="line">#define  Rewinding_SystemExeName &quot;复卷系统/复卷系统.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:Rewinding_System;Description:&quot;复卷系统&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\复卷系统\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\复卷系统&quot;; Flags: ignoreversion   ;Components: Rewinding_System</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#Rewinding_SystemExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\复卷系统&quot;; Flags: ignoreversion; Components: Rewinding_System</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#Rewinding_SystemName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Rewinding_SystemExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:Rewinding_System</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Rewinding_SystemExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(Rewinding_SystemName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent    ;Components:Rewinding_System</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;定位测量转IO定义</span><br><span class="line">#ifdef btn_PositioningTo </span><br><span class="line">#define  PositioningToIOName &quot;定位测量转IO&quot;</span><br><span class="line">#define  PositioningToIOExeName &quot;LocationToIO.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:PositioningToIO;Description:&quot;定位测量转IO&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\定位测量转IO\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\定位测量转IO&quot;; Flags: ignoreversion   ;Components: PositioningToIO</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#PositioningToIOExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: PositioningToIO</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#PositioningToIOName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#PositioningToIOExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:PositioningToIO</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#PositioningToIOExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(PositioningToIOName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent     ;Components:PositioningToIO</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;复卷检测停机V2定义</span><br><span class="line">#ifdef btn_RewindDetectionShutdown_V2</span><br><span class="line">#define  RewindDetectionShutdownNameV2 &quot;复卷检测停机V2&quot;</span><br><span class="line">#define  RewindDetectionShutdownExeNameV2 &quot;RewindingV2.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:RewindDetectionShutdownV2;Description:&quot;复卷检测停机V2&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\复卷检测停机\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\复卷检测停机&quot;; Flags: ignoreversion recursesubdirs createallsubdirs  ;Components: RewindDetectionShutdownV2</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#RewindDetectionShutdownExeNameV2&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: RewindDetectionShutdownV2</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownNameV2&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownExeNameV2&#125;</span>&quot;; Tasks: desktopicon      ;Components:RewindDetectionShutdownV2</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownExeNameV2&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(RewindDetectionShutdownNameV2, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent    ;Components:RewindDetectionShutdownV2</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;复卷检测停机V3定义</span><br><span class="line">#ifdef btn_RewindDetectionShutdown_V3</span><br><span class="line">#define  RewindDetectionShutdownName &quot;复卷检测停机V3&quot;</span><br><span class="line">#define  RewindDetectionShutdownExeName &quot;RewindingDetectionV3.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:RewindDetectionShutdownV3;Description:&quot;复卷检测停机V3&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\复卷检测停机\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\复卷检测停机&quot;; Flags: ignoreversion recursesubdirs createallsubdirs  ;Components: RewindDetectionShutdownV3</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#RewindDetectionShutdownExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: RewindDetectionShutdownV3</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:RewindDetectionShutdownV3</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(RewindDetectionShutdownName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent    ;Components:RewindDetectionShutdownV3</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;光源控制器定义</span><br><span class="line">#ifdef btn_Light_source_controller </span><br><span class="line">#define  Light_source_controllerName &quot;光源控制器&quot;</span><br><span class="line">#define  Light_source_controllerExeName &quot;Light_source_controller.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:Light_source_controller;Description:&quot;光源控制器&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\光源控制器\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\光源控制器&quot;; Flags: ignoreversion   ;Components: Light_source_controller</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#Light_source_controllerExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: Light_source_controller</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#Light_source_controllerName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Light_source_controllerExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:Light_source_controller</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Light_source_controllerExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(Light_source_controllerName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent    ;Components:Light_source_controller</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;纱布折叠机_两通道_四相机定义</span><br><span class="line">#ifdef btn_Gauze_2ch_4cam </span><br><span class="line">#define  Gauze_2ch_4camName &quot;纱布折叠机_两通道_四相机&quot;</span><br><span class="line">#define  Gauze_2ch_4camExeName &quot;Gauze_2ch_4cam.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:Gauze_2ch_4cam;Description:&quot;纱布折叠机_两通道_四相机&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\折叠机_双通道四相机\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\折叠机_双通道四相机&quot;; Flags: ignoreversion   ;Components: Gauze_2ch_4cam</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#Gauze_2ch_4camExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: Gauze_2ch_4cam</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#Gauze_2ch_4camName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Gauze_2ch_4camExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:Gauze_2ch_4cam</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Gauze_2ch_4camExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(Gauze_2ch_4camName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent        ;Components:Gauze_2ch_4cam</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;产线信号转换器定义</span><br><span class="line">#ifdef btn_InputSignalConverter </span><br><span class="line">#define  ProductionLineSignalConverterName &quot;产线信号转换器&quot;</span><br><span class="line">#define  ProductionLineSignalConverterExeName &quot;&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:ProductionLineSignalConverter;Description:&quot;产线信号转换器&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\产线信号转换器\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\产线信号转换器&quot;; Flags: ignoreversion   ;Components: ProductionLineSignalConverter</span><br><span class="line">;Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#ProductionLineSignalConverterExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: ProductionLineSignalConverter</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#ProductionLineSignalConverterName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#ProductionLineSignalConverterExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:ProductionLineSignalConverter</span><br><span class="line">[Run]</span><br><span class="line">;Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#ProductionLineSignalConverterExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(ProductionLineSignalConverterName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">[Setup]</span><br><span class="line">; NOTE: The value <span class="keyword">of</span> AppId uniquely identifies this application. <span class="keyword">Do</span> <span class="keyword">not</span> use the same AppId value <span class="keyword">in</span> installers <span class="keyword">for</span> other applications.</span><br><span class="line">; (<span class="keyword">To</span> generate a new GUID, click Tools | Generate GUID inside the IDE.)</span><br><span class="line">AppId=<span class="comment">&#123;&#123;433F837C-1CBE-45B1-948F-B33CB8DC0191&#125;</span></span><br><span class="line">AppName=<span class="comment">&#123;#MyAppName&#125;</span></span><br><span class="line">AppVersion=<span class="comment">&#123;#MyAppVersion&#125;</span></span><br><span class="line">;AppVerName=<span class="comment">&#123;#MyAppName&#125;</span> <span class="comment">&#123;#MyAppVersion&#125;</span></span><br><span class="line">AppPublisher=<span class="comment">&#123;#MyAppPublisher&#125;</span></span><br><span class="line">AppPublisherURL=<span class="comment">&#123;#MyAppURL&#125;</span></span><br><span class="line">AppSupportURL=<span class="comment">&#123;#MyAppURL&#125;</span></span><br><span class="line">AppUpdatesURL=<span class="comment">&#123;#MyAppURL&#125;</span></span><br><span class="line">DefaultDirName=C:/恒意得上位机系统</span><br><span class="line">DisableProgramGroupPage=yes</span><br><span class="line">;InfoAfterFile=C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\更新日志.md</span><br><span class="line">; Uncomment the following line <span class="keyword">to</span> run <span class="keyword">in</span> non administrative install mode (install <span class="keyword">for</span> current user only.)</span><br><span class="line">;PrivilegesRequired=lowest</span><br><span class="line">OutputDir=C:\Users\fengj\OneDrive\Programs\Controller\Release_Installation_Package</span><br><span class="line">OutputBaseFilename=<span class="comment">&#123;#MyAppName&#125;</span>_setup_安装包</span><br><span class="line">SetupIconFile=C:\\Users\\fengj\\OneDrive\\Programs\\Controller\\Release\\Software_msvc\\source_material\\icon\\install.ico</span><br><span class="line">UninstallDisplayIcon=C:\\Users\\fengj\\OneDrive\\Programs\\Controller\\Release\\Software_msvc\\source_material\\icon\\install.ico</span><br><span class="line">Compression=lzma</span><br><span class="line">SolidCompression=yes</span><br><span class="line">WizardStyle=modern</span><br><span class="line">ChangesEnvironment=true</span><br><span class="line">UsePreviousAppDir=no</span><br><span class="line">;UsePreviousAppDir该字段设置为no则允许用户使用非覆盖的方式安装应用,若需要还原为覆盖安装则删除该字段即可</span><br><span class="line">ShowLanguageDialog=yes</span><br><span class="line">;上述语句为组件选择安装使用</span><br><span class="line">password=heng</span><br><span class="line">;上述语句用于添加安装密码</span><br><span class="line"></span><br><span class="line">;ChangesEnvironment=yes</span><br><span class="line">;上述语句用于环境变量相关</span><br><span class="line"></span><br><span class="line">;AlwaysRestart =yes</span><br><span class="line">;  上述 用于重启</span><br><span class="line"></span><br><span class="line">;RestartIfNeededByRun=yes</span><br><span class="line">;重启相关</span><br><span class="line"></span><br><span class="line">DefaultGroupName=<span class="comment">&#123;#MyAppName&#125;</span> </span><br><span class="line">;菜单栏创建文件夹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[Languages]</span><br><span class="line"><span class="keyword">Name</span>: &quot;english&quot;; MessagesFile: &quot;compiler:<span class="keyword">Default</span>.isl&quot;</span><br><span class="line"><span class="keyword">Name</span>: &quot;chinesesimplified&quot;; MessagesFile: &quot;compiler:Languages\ChineseSimplified.isl&quot;</span><br><span class="line"></span><br><span class="line">[Tasks]</span><br><span class="line"><span class="keyword">Name</span>: &quot;desktopicon&quot;; Description: &quot;<span class="comment">&#123;cm:CreateDesktopIcon&#125;</span>&quot;; GroupDescription: &quot;<span class="comment">&#123;cm:AdditionalIcons&#125;</span>&quot;; Flags: checkablealone; </span><br><span class="line">;以上若需要默认不勾选安装快捷方式,则可以将flags替换为unchecked ,若默认需要勾选则为checkablealone</span><br><span class="line">; 只是在同级页面添加了选项.....<span class="keyword">Name</span>:&quot;YiTiJi&quot;;Description: &quot;测试&quot;;Flags:unchecked</span><br><span class="line">; 只是在同级页面添加了选项.....<span class="keyword">Name</span>:&quot;X_Line&quot;;Description:&quot;测试<span class="number">2</span>&quot;;Components:X_Line</span><br><span class="line"></span><br><span class="line">;<span class="keyword">Name</span>:&quot;RestartPC&quot;; Description:&quot;Restart the Computer&quot;; GroupDescription:&quot;Post Installation Options&quot;; Flags: unchecked;</span><br><span class="line">;上述代码用于设定安装完重启</span><br><span class="line"></span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\*.dll&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\iconengines\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\iconengines&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\imageformats\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\imageformats&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\platforms\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\platforms&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\styles\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\styles&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\translations\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\translations&quot;; Flags: ignoreversion                </span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Skin\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Skin&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\参数管理\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\参数管理&quot;; Flags: ignoreversion onlyifdoesntexist</span><br><span class="line">;Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\dll修复工具\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\dll修复工具&quot;; Flags: ignoreversion   recursesubdirs createallsubdirs</span><br><span class="line"></span><br><span class="line">;Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\标准控制器\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\标准控制器&quot;; Flags: ignoreversion</span><br><span class="line">;Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\复卷检测\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\复卷检测&quot;; Flags: ignoreversion   ;Components: Rewinding_System</span><br><span class="line">;Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\复卷系统\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\复卷系统&quot;; Flags: ignoreversion recursesubdirs createallsubdirs;Components: Rewinding_System</span><br><span class="line">; NOTE: Don<span class="string">&#x27;t use &quot;Flags: ignoreversion&quot; on any shared system files</span></span><br><span class="line"><span class="string">;后缀加上 recursesubdirs createallsubdirs 可以包含文件夹下所有内容</span></span><br><span class="line"><span class="string">;后缀加上 onlyifdoesntexist 可以判断文件夹是否有该文件,若存在该文件则不替换</span></span><br><span class="line"><span class="string">;[Icons]</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autoprograms&#125;\&#123;#MyAppName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#MyAppExeName&#125;&quot;  </span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autodesktop&#125;\&#123;#MyAppName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#MyAppExeName&#125;&quot;; Tasks: desktopicon </span></span><br><span class="line"><span class="string">;下述代码实现了安装完成后桌面显示多个快捷方式的功能</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autoprograms&#125;\&#123;#YiTiJiName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#YiTiJiExeName&#125;&quot;      ;Components:YiTiJi</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autodesktop&#125;\&#123;#YiTiJiName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#YiTiJiExeName&#125;&quot;; Tasks: desktopicon      ;Components:YiTiJi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;复卷系统的桌面快捷方式</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autoprograms&#125;\&#123;#Rewinding_SystemName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#Rewinding_SystemExeName&#125;&quot;      ;Components:Rewinding_System</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autodesktop&#125;\&#123;#Rewinding_SystemName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#Rewinding_SystemExeName&#125;&quot;; Tasks: desktopicon      ;Components:Rewinding_System</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;菜单栏创建文件夹</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;group&#125;\&#123;#MyAppName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#MyAppExeName&#125;&quot;; WorkingDir:&quot;&#123;app&#125;&quot;</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;group&#125;\&#123;cm:UninstallProgram,&#123;#MyAppName&#125;&#125;&quot;; Filename: &quot;&#123;uninstallexe&#125;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Code]</span></span><br><span class="line"><span class="string">// 设置环境变量函数</span></span><br><span class="line"><span class="string">procedure SetEnv(aEnvName, aEnvValue: string; aIsInstall, aIsInsForAllUser: Boolean);</span></span><br><span class="line"><span class="string">var</span></span><br><span class="line"><span class="string">sOrgValue: string;</span></span><br><span class="line"><span class="string">sFileName: string;</span></span><br><span class="line"><span class="string">S1: AnsiString;                                                  //注意类型是AnsiString,不是string</span></span><br><span class="line"><span class="string">bRetValue, bInsForAllUser: Boolean;</span></span><br><span class="line"><span class="string">SL: TStringList;</span></span><br><span class="line"><span class="string">x: integer;</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">bInsForAllUser := aIsInsForAllUser;</span></span><br><span class="line"><span class="string">if UsingWinNT then</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">    if bInsForAllUser then</span></span><br><span class="line"><span class="string">      bRetValue := RegQueryStringValue(HKEY_LOCAL_MACHINE, &#x27;</span>SYSTEM\CurrentControlSet\Control\Session Manager\Environment<span class="string">&#x27;, aEnvName, sOrgValue)</span></span><br><span class="line"><span class="string">    else</span></span><br><span class="line"><span class="string">      bRetValue := RegQueryStringValue(HKEY_CURRENT_USER, &#x27;</span>Environment<span class="string">&#x27;, aEnvName, sOrgValue);</span></span><br><span class="line"><span class="string">    sOrgValue := Trim(sOrgValue);</span></span><br><span class="line"><span class="string">    begin</span></span><br><span class="line"><span class="string">      S1 := aEnvValue;</span></span><br><span class="line"><span class="string">      if pos(Uppercase(s1), Uppercase(sOrgValue)) = 0 then //还没有加入</span></span><br><span class="line"><span class="string">      begin</span></span><br><span class="line"><span class="string">        if aIsInstall then</span></span><br><span class="line"><span class="string">        begin</span></span><br><span class="line"><span class="string">          x := Length(sOrgValue);</span></span><br><span class="line"><span class="string">          if (x &gt; 0) and (StringOfChar(sOrgValue[x], 1) &lt;&gt; &#x27;</span>;<span class="string">&#x27;) then</span></span><br><span class="line"><span class="string">            sOrgValue := sOrgValue + &#x27;</span>;<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">          sOrgValue := sOrgValue + S1;</span></span><br><span class="line"><span class="string">        end;</span></span><br><span class="line"><span class="string">      end else</span></span><br><span class="line"><span class="string">      begin</span></span><br><span class="line"><span class="string">        if not aIsInstall then</span></span><br><span class="line"><span class="string">        begin</span></span><br><span class="line"><span class="string">          StringChangeEx(sOrgValue, S1 + &#x27;</span>;<span class="string">&#x27;, &#x27;&#x27;, True);</span></span><br><span class="line"><span class="string">          StringChangeEx(sOrgValue, S1, &#x27;&#x27;, True);</span></span><br><span class="line"><span class="string">        end;</span></span><br><span class="line"><span class="string">      end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      if bInsForAllUser then</span></span><br><span class="line"><span class="string">        RegWriteStringValue(HKEY_LOCAL_MACHINE, &#x27;</span>SYSTEM\CurrentControlSet\Control\Session Manager\Environment<span class="string">&#x27;, aEnvName, sOrgValue)</span></span><br><span class="line"><span class="string">      else</span></span><br><span class="line"><span class="string">      begin</span></span><br><span class="line"><span class="string">        if (not aIsInstall) and (Trim(sOrgValue) = &#x27;&#x27;) then</span></span><br><span class="line"><span class="string">          RegDeleteValue(HKEY_CURRENT_USER, &#x27;</span>Environment<span class="string">&#x27;, aEnvName)</span></span><br><span class="line"><span class="string">        else</span></span><br><span class="line"><span class="string">          RegWriteStringValue(HKEY_CURRENT_USER, &#x27;</span>Environment<span class="string">&#x27;, aEnvName, sOrgValue);</span></span><br><span class="line"><span class="string">      end;</span></span><br><span class="line"><span class="string">    end;</span></span><br><span class="line"><span class="string">end else //非NT 系统,如Win98</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">    SL := TStringList.Create;</span></span><br><span class="line"><span class="string">    try</span></span><br><span class="line"><span class="string">      sFileName := ExpandConstant(&#x27;</span><span class="comment">&#123;sd&#125;</span>\autoexec.bat<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">      LoadStringFromFile(sFileName, S1);</span></span><br><span class="line"><span class="string">      SL.Text := s1;</span></span><br><span class="line"><span class="string">      s1 :=   &#x27;</span>&quot;<span class="string">&#x27; + aEnvValue + &#x27;</span>&quot;<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">      s1 := &#x27;</span><span class="keyword">set</span> <span class="string">&#x27;+aEnvName +&#x27;</span>=%path%;<span class="string">&#x27; + s1 ;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      bRetValue := False;</span></span><br><span class="line"><span class="string">      x := SL.IndexOf(s1);</span></span><br><span class="line"><span class="string">      if x = -1 then</span></span><br><span class="line"><span class="string">      begin</span></span><br><span class="line"><span class="string">        if aIsInstall then</span></span><br><span class="line"><span class="string">        begin</span></span><br><span class="line"><span class="string">          SL.Add(s1);</span></span><br><span class="line"><span class="string">          bRetValue := True;</span></span><br><span class="line"><span class="string">        end;</span></span><br><span class="line"><span class="string">      end else //还没添加</span></span><br><span class="line"><span class="string">        if not aIsInstall then</span></span><br><span class="line"><span class="string">        begin</span></span><br><span class="line"><span class="string">          SL.Delete(x);</span></span><br><span class="line"><span class="string">          bRetValue := True;</span></span><br><span class="line"><span class="string">        end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      if bRetValue then</span></span><br><span class="line"><span class="string">        SL.SaveToFile(sFileName);</span></span><br><span class="line"><span class="string">    finally</span></span><br><span class="line"><span class="string">      SL.free;</span></span><br><span class="line"><span class="string">    end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">end;</span></span><br><span class="line"><span class="string">end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// 安装前添加环境变量</span></span><br><span class="line"><span class="string">procedure CurStepChanged(CurStep: TSetupStep);</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">  if CurStep = ssInstall then                        //对于(ssInstall)这个变量可依据自身需要进行更改，帮助文档中有说明(也可是安装完成之后进行写入对应变量为ssDone)</span></span><br><span class="line"><span class="string">  begin</span></span><br><span class="line"><span class="string">  // 将&#123;app&#125;路径添加到path环境变量中</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>;<span class="string">&#x27;),true,true); //对于添加多个环境变量需要注意要添加分割符号&quot;;&quot;,否则系统会认为是一个</span></span><br><span class="line"><span class="string">     SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\pylon<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">     SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\opencv<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x86<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">     SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x64<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">  end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  //if CurStep = ssDone then                        //对于(ssInstall)这个变量可依据自身需要进行更改，帮助文档中有说明(也可是安装完成之后进行写入对应变量为ssDone)</span></span><br><span class="line"><span class="string">  //begin</span></span><br><span class="line"><span class="string">  // 将&#123;app&#125;路径添加到path环境变量中</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>;<span class="string">&#x27;),true,true); //对于添加多个环境变量需要注意要添加分割符号&quot;;&quot;,否则系统会认为是一个</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\pylon<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\opencv<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">    // SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x86<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x64<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">  //end;</span></span><br><span class="line"><span class="string">end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// 卸载前删除环境变量</span></span><br><span class="line"><span class="string">procedure CurUninstallStepChanged(CurUninstallStep: TUninstallStep);</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">  // 将&#123;app&#125;路径从path环境变量中删除</span></span><br><span class="line"><span class="string">  //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>;<span class="string">&#x27;),false,true);</span></span><br><span class="line"><span class="string">  SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\pylon<span class="string">&#x27;),false,true); //卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line"><span class="string">  SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\opencv<span class="string">&#x27;),false,true); //卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line"><span class="string">  //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x86<span class="string">&#x27;),false,true); //卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line"><span class="string">  SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x64<span class="string">&#x27;),false,true); //卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line"><span class="string">end;</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> InnoSetup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> InnoSetup </tag>
            
            <tag> 安装包制作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>InnoSetup-向导创建</title>
      <link href="/2023/11/17/Qt/InnoSetup/%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/"/>
      <url>/2023/11/17/Qt/InnoSetup/%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="Inno-Setup-制作安装包"><a href="#Inno-Setup-制作安装包" class="headerlink" title="Inno Setup:制作安装包"></a>Inno Setup:制作安装包</h1><p>简述:Inno Setup有两种方式可以制作安装包</p><p>图片</p><p>使用向导方式制作,优点:简单快捷.缺点:仅基础安装,很多功能向导不提供</p><p>编写脚本,优点:可定制化程度高.缺点:需要一定的学习成本</p><p>制作过程如下:</p><p>一. 向导制作安装包</p><p> 点击新建,创建一个带向导的文件,点击OK</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHLShjEica2xX2F3140WSf1ILeYb8koHvGd4E3l1cIxRTUGzOBWic1oVtg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>点击下一步</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHAFS57oPROEb17sT8huWjXqGpANWZUwpcZOPLGb3iaVCVzEqzegYz4Aw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>输入软件名称,软件版本(也可使用默认不填),应用网址</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHp5s0JUFqzMvspcgGuvPbPOSCeUsMfCDicWqHCJBiah09cFKcaf8NNeFA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>下一步,选择自定义默认输出路径</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHcYRzP1kC2rk2eOy1tfj11oBnM5qFDMZs0ia7wb421UNN21svQ2fEVXA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>下一步,选择要封装的软件的路径,other application files:选择要封装的依赖文件</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmH5hoYCKKQDicrfcenOWyb3kIy4VTPsMh8NaQ1kHQ96vialFTRzTx9aibpA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>下一步</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHDphgQPnWdfvmC57RCzibwXxzoQVAUrSNj8GoNBrTRj6x0rp6EjO0wLw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>默认勾选创建菜单快捷方式以及桌面快捷方式,下一步</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHgqz7k13TaGmS0CrkW3A5DicnBKf2V3MlVb2esTVwgwfG3r26KRLoEAA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>根据需要是否加入安装前显示文本文件或安装后显示文本文件,下一步</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHiaucRJlm5qb6U7Cz7XYkysttia5IVhL0SdOd9mtJpqRBAZEpVShrSmtQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>默认管理安装,下一步</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHQzJdcF2Nh0DfhDNZd5J99CVoqhCJZIKmyEY6tPwQtYNTeB3HcTVuoQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>安装语言文件选择,中文,下一步</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHymBicyIyGJ35NUGd5sUjIRbVNAAbV5icw91ibibEPM6h5HCfiaKaLP4wewA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>图标文件和密码可以不填</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHicibico56Ih22CiakHonqWibYqDTySiatFB0hATFib5buicQYDgeSmwnAticwGg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>下一步</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHqiaxbzdTZENiacEV7vXlNJbic9B20rqQGd0upcykfqKDQzzKd9WDyuRPA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>完成</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHmhLcUAKibsH7T6eJyFeokgoT0xhs34JtnnYkKAib3VsmtXhAZpAsoyPw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>立即编译脚本</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHLicdZyhrFq8NyxpjJE3kanltsrZMJBW6LKbTdv7fgV5owCOJzibFyy6Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>保存脚本文件,选择是</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHDWTboPmJkWIVgIsRoF9geIiczALISPnwQiaEtonqZv7Mib0TIYoQk8AYg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>保存文件</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHzqPLicQOAN4ibtgb6VwYOJ1Ldcb7SVblyXJtMcDGjGvJib5ibg7Qqlj8ibg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>编译完成</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHbWibia2N15iaczmibacpWMv5Ac7wVRs9LvktoRPTR37iahkgAZKI9iaecG4w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>输出路径找到生成的安装包</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/oDib8icG0lHiaY2l29ArQTF1AEqCCX3rZmHDrIl1r9EAT0jYrdqTzoiaY0II9HhXoWuModzmraBUZqneTcmyL9yk2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Title"></p><p>评价:</p><p>用向导制作可以快速完成一个软件安装包的制作,但若想要添加环境变量,根据选择安装语言实现软件语言包的相应安装,美化界面等定制化功能,则需要使用inno setup的脚本语言(下篇记录脚本语言).</p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> InnoSetup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> InnoSetup </tag>
            
            <tag> 安装包制作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitea-部署笔记</title>
      <link href="/2023/11/17/git/gitea/"/>
      <url>/2023/11/17/git/gitea/</url>
      
        <content type="html"><![CDATA[<h1 id="Gitea"><a href="#Gitea" class="headerlink" title="Gitea"></a>Gitea</h1><h2 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h2><p><a href="https://github.com/go-gitea/gitea">github链接</a></p><h2 id="配置服务器"><a href="#配置服务器" class="headerlink" title="配置服务器"></a>配置服务器</h2><ul><li>双击gieta.exe</li><li>打开网页</li><li>配置信息，数据库使用sqlite，路径地址使用相对地址</li></ul><h2 id="注册服务"><a href="#注册服务" class="headerlink" title="注册服务"></a>注册服务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nssm install gitea</span><br><span class="line">nssm start gitea</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="配置发布版本附件大小以及数量"><a href="#配置发布版本附件大小以及数量" class="headerlink" title="配置发布版本附件大小以及数量"></a>配置发布版本附件大小以及数量</h2><p>custom文件夹-&gt;conf文件夹-&gt;app.ini</p><p>添加以下内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[attachment]</span><br><span class="line">ENABLED=true</span><br><span class="line">ALLOWED_TYPES=*/*</span><br><span class="line">MAX_SIZE=1024</span><br><span class="line">MAX_FILES=10</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> 版本管理 </tag>
            
            <tag> 服务器部署 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git-随用笔记</title>
      <link href="/2023/11/17/git/git_note/"/>
      <url>/2023/11/17/git/git_note/</url>
      
        <content type="html"><![CDATA[<h1 id="git笔记"><a href="#git笔记" class="headerlink" title="git笔记"></a>git笔记</h1><h2 id="一-如何修改-gitignore"><a href="#一-如何修改-gitignore" class="headerlink" title="一. 如何修改.gitignore"></a>一. 如何修改.gitignore</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#add .gitignore</span><br><span class="line">#查看状态，是否忽略了指定的文件？ </span><br><span class="line">$ git status --ignored #查看状态，包括忽略的文件</span><br><span class="line"> </span><br><span class="line">#让其对已经跟踪的文件也起作用</span><br><span class="line">$ git rm -r --cached .  #清除缓存 -r 表示递归删除（如果有文件夹的话） . 表示所有文件</span><br><span class="line"> </span><br><span class="line">#查看一下具体效果</span><br><span class="line">$ git status --ignored</span><br><span class="line">$ git add .           #重新trace file</span><br><span class="line">$ git commit -m &quot;update .gitignore&quot;     #提交和注释</span><br></pre></td></tr></table></figure><h2 id="二-如何删除分支"><a href="#二-如何删除分支" class="headerlink" title="二. 如何删除分支"></a>二. 如何删除分支</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d branch-name</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin --delete dev</span><br></pre></td></tr></table></figure><h2 id="三-合并指定文件夹"><a href="#三-合并指定文件夹" class="headerlink" title="三. 合并指定文件夹"></a>三. 合并指定文件夹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout 分支名 根目录/demo1.txt    //指定文件</span><br><span class="line">git checkout dev lib/ui/pages/member/** //多级目录</span><br></pre></td></tr></table></figure><h2 id="四-强制推送分支"><a href="#四-强制推送分支" class="headerlink" title="四. 强制推送分支"></a>四. 强制推送分支</h2><ul><li>命令格式为:<br>git push &lt;远程名称&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;<br>例如,推送本地的 master 分支到远程的 master 分支,强制覆盖远程代码:<br>git push origin master:master -f</li></ul>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> 版本管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UDP_socket</title>
      <link href="/2023/11/17/Qt/UDP_socket/"/>
      <url>/2023/11/17/Qt/UDP_socket/</url>
      
        <content type="html"><![CDATA[<h1 id="QUdpSocket"><a href="#QUdpSocket" class="headerlink" title="QUdpSocket"></a>QUdpSocket</h1><p>详见Qt高级，Qt_UDP.pdf</p><h1 id="libuv"><a href="#libuv" class="headerlink" title="libuv"></a>libuv</h1><p>两种模式，事件循环调用（回调）</p><p>1.The I&#x2F;O loop</p><p>2.File I&#x2F;O</p><h1 id="系统知识"><a href="#系统知识" class="headerlink" title="系统知识"></a>系统知识</h1><p>系统缓存约64KB字节，（超过这么多字节的数据，则会丢包。直到程序读取走一包数据。）</p><h1 id="测试过程试和验结果"><a href="#测试过程试和验结果" class="headerlink" title="测试过程试和验结果"></a>测试过程试和验结果</h1><p>总结：是否丢包主要取决于系统性能（以及是否繁忙等），低性能设备给高性能设备发数据丢包率小于高性能设备给低性能设备发数据。</p><p>libuv，与QUdpSocket性能相差不大，均为一定概率丢包。系统缓存64KB，不能单独设置缓存。</p><h1 id="测试工具-NetAssist"><a href="#测试工具-NetAssist" class="headerlink" title="测试工具 NetAssist"></a>测试工具 NetAssist</h1><ol><li>必须连接上网络，并且网络设置中已经显示正在识别或未识别的网络（否则可能会无法发现，不能被枚举出来）</li><li>与是否开启高性能模式无关，与是否插电源无关，是否开启无线网络无关，是否安装开启网卡属性中basler等其它gige无关，与是否开启虚拟网络无关</li></ol><p><img src="/image/UDP_socket/1697421119249.png" alt="1697421119249"></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> 技术 </tag>
            
            <tag> udp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt高级</title>
      <link href="/2023/11/17/Qt/Qt%E9%AB%98%E7%BA%A7/"/>
      <url>/2023/11/17/Qt/Qt%E9%AB%98%E7%BA%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="Qt高级编程"><a href="#Qt高级编程" class="headerlink" title="Qt高级编程"></a>Qt高级编程</h1><h2 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h2><h3 id="QUdpSocket"><a href="#QUdpSocket" class="headerlink" title="QUdpSocket"></a>QUdpSocket</h3><h4 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h4><ol><li>pro文件添加模块，QT       +&#x3D;  network</li><li>添加头文件#include <code>&lt;QUdpSocket&gt;</code> <code>&lt;QHostAddress&gt;</code></li><li>创建对象并实例化  private:    QUdpSocket *udpSocket;    udpSocket&#x3D;new QUdpSocket(this);</li><li>绑定IP地址和端口：udpSocket-&gt;bind(QHostAddress::AnyIPv4,port);&#x2F;&#x2F;port是端口号，任意指定，建议大于1024小于65535</li><li>连接接收数据槽函数   connect(udpSocket,&amp;QUdpSocket::readyRead,this,&amp;MainWindow::read_image);&#x2F;&#x2F;接收数据，处理函数为read_image</li><li>发送数据 udpSocket-&gt;writeDatagram(ui-&gt;textEdit-&gt;toPlainText().toUtf8(),QHostAddress(ui-&gt;linee_IP-&gt;text()),i-&gt;linee_port-&gt;text().toInt());</li></ol><h4 id="其它UDP库"><a href="#其它UDP库" class="headerlink" title="其它UDP库"></a>其它UDP库</h4><p>1.c++系统库 <code>&lt;sys/socket.h&gt;性能较高，非异步，可能会阻塞主线程，需要额外处理</code></p><p>2.libuv <code>&lt;uv.h&gt;异步，性能高，使用单独的事件循环</code></p><p>&lt;**处理接收数据**&gt;</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">QHostAddress address;</span><br><span class="line">    quint16 port;</span><br><span class="line"></span><br><span class="line">    QByteArray array;</span><br><span class="line">    array.<span class="built_in">resize</span>(udpSocket-&gt;<span class="built_in">bytesAvailable</span>());<span class="comment">//根据可读数据来设置空间大小</span></span><br><span class="line">    <span class="comment">//读取数据，获取客户端的IP地址和端口号</span></span><br><span class="line">    <span class="type">int</span> tmp = udpSocket-&gt;<span class="built_in">readDatagram</span>(array.<span class="built_in">data</span>(),array.<span class="built_in">size</span>(),&amp;address,&amp;port);</span><br><span class="line">    <span class="keyword">if</span> (tmp&gt;<span class="number">0</span>&amp;&amp;tmp&lt;=<span class="number">1000</span>) &#123;</span><br><span class="line">           ui-&gt;textEdit-&gt;<span class="built_in">append</span>(<span class="string">&quot;接收来自：&quot;</span>+address.<span class="built_in">toString</span>()+<span class="string">&quot;:&quot;</span>+QString::<span class="built_in">number</span>(port)+array);</span><br><span class="line">       &#125;</span><br><span class="line">    <span class="keyword">if</span> (array.<span class="built_in">size</span>() &gt;<span class="number">1000</span>) &#123; <span class="comment">// 假设2表示其他类型的消息</span></span><br><span class="line">           <span class="comment">// 处理其他类型的消息</span></span><br><span class="line"></span><br><span class="line">           <span class="function">QBuffer <span class="title">buffer</span><span class="params">(&amp;array)</span></span>;<span class="comment">//添加数据到缓冲器</span></span><br><span class="line">           buffer.<span class="built_in">open</span>(QIODevice::ReadOnly);<span class="comment">//读取</span></span><br><span class="line"></span><br><span class="line">           <span class="function">QImageReader <span class="title">reader</span><span class="params">(&amp;buffer,<span class="string">&quot;JPG&quot;</span>)</span></span>;<span class="comment">//读取img</span></span><br><span class="line">           QImage img = reader.<span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span>(!img.<span class="built_in">isNull</span>())&#123;</span><br><span class="line"></span><br><span class="line">               QMessageBox::<span class="built_in">information</span>(<span class="literal">NULL</span>,<span class="string">&quot;ima&quot;</span>,<span class="string">&quot;ima&quot;</span>);</span><br><span class="line">               ui-&gt;lb_image_show-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(img));</span><br><span class="line">               ui-&gt;lb_image_show-&gt;<span class="built_in">show</span>();</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="built_in">qDebug</span>()&lt;&lt;address&lt;&lt;<span class="string">&quot;---&quot;</span>&lt;&lt;port;</span><br><span class="line"></span><br><span class="line">           ui-&gt;textEdit-&gt;<span class="built_in">append</span>(<span class="string">&quot;接收来自：&quot;</span>+address.<span class="built_in">toString</span>()+<span class="string">&quot;:&quot;</span>+<span class="string">&quot;\r\n&quot;</span>+QString::<span class="built_in">number</span>(port)+array.<span class="built_in">toHex</span>());</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>&lt;**发送图像数据**&gt;</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">QString filename = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>, <span class="built_in">tr</span>(<span class="string">&quot;选择图片&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="built_in">tr</span>(<span class="string">&quot;图片文件 (*.png *.jpg *.jpeg)&quot;</span>));</span><br><span class="line">   <span class="keyword">if</span> (!filename.<span class="built_in">isEmpty</span>()) &#123;</span><br><span class="line">   <span class="comment">// 打开图片并进行相应操作</span></span><br><span class="line"></span><br><span class="line">   QImage image;</span><br><span class="line">   <span class="keyword">if</span> (image.<span class="built_in">load</span>(filename)) &#123;</span><br><span class="line">       QLabel* label = ui-&gt;lb_image_show;</span><br><span class="line">       label-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(image));</span><br><span class="line">       label-&gt;<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       QByteArray byteArray;</span><br><span class="line">       QBuffer buffer;</span><br><span class="line">       buffer.<span class="built_in">open</span>(QIODevice::WriteOnly);</span><br><span class="line">       image.<span class="built_in">save</span>(&amp;buffer, <span class="string">&quot;JPG&quot;</span>);  <span class="comment">// 将图片数据保存到byteArray中</span></span><br><span class="line">       byteArray.<span class="built_in">append</span>(buffer.<span class="built_in">data</span>());</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(udpSocket-&gt;<span class="built_in">writeDatagram</span>(byteArray.<span class="built_in">data</span>(),</span><br><span class="line">            byteArray.<span class="built_in">size</span>(), <span class="built_in">QHostAddress</span>(ui-&gt;linee_IP-&gt;<span class="built_in">text</span>()),</span><br><span class="line">                                    ui-&gt;linee_port-&gt;<span class="built_in">text</span>().<span class="built_in">toInt</span>())==<span class="number">-1</span>)&#123;</span><br><span class="line">           <span class="built_in">qDebug</span>()&lt;&lt;udpSocket-&gt;<span class="built_in">error</span>();</span><br><span class="line">           QMessageBox::<span class="built_in">warning</span>(<span class="literal">NULL</span>,<span class="string">&quot;erro&quot;</span>,udpSocket-&gt;<span class="built_in">errorString</span>());</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="comment">// 图片加载失败</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h3 id="libuv"><a href="#libuv" class="headerlink" title="libuv"></a>libuv</h3><h4 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h4><ol><li>下载源码 <a href="https://github.com/libuv/libuv.git">https://github.com/libuv/libuv.git</a></li><li>下载cmake</li><li>cmake编译源码，使用msvc编译器，记住构建路径，点configure后串口显示的内容中有（生成的lib文件，dll，都在这里）（第四第五步骤可以忽略）</li><li>打开编译好的内容，找到.sln文件打开工程</li><li>选择编译器，release，全部生成</li><li>添加lib文件，dll文件，源码中include文件夹，src文件夹到qt工程中。</li><li>还需要再pro文件中添加以下内容</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">DEFINES += _WIN32_WINNT=<span class="number">0x0602</span></span><br><span class="line">LIBS += -lws2_32</span><br><span class="line">LIBS += -lUserEnv</span><br><span class="line">LIBS += -lIPHLPAPI</span><br><span class="line">LIBS += -lPsapi</span><br><span class="line">LIBS += -ladvapi32</span><br><span class="line">LIBS += -lUser32</span><br><span class="line">LIBS += -lGdi32</span><br></pre></td></tr></table></figure><h2 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h2><h3 id="QThread-线程类"><a href="#QThread-线程类" class="headerlink" title="QThread 线程类"></a>QThread 线程类</h3><h4 id="常用操作函数"><a href="#常用操作函数" class="headerlink" title="常用操作函数"></a>常用操作函数</h4><p>QThread::QThread(QObject * parent&#x3D;0);   &#x2F;&#x2F;构造函数</p><p>void QThread::start();  &#x2F;&#x2F;启动线程</p><p>bool QThread::wait(unsigned long time &#x3D; ULONG_MAX); &#x2F;&#x2F;阻塞调用该函数线程</p><p>void QThread::terminate(); &#x2F;&#x2F;结束线程</p><p>启动线程后，QThread::run()会被调用；</p><h4 id="QThread操作步骤"><a href="#QThread操作步骤" class="headerlink" title="QThread操作步骤"></a>QThread操作步骤</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QThread&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>新建文件c++类，基类为QThread，继承QObject</li><li>头文件重写虚函数，virtual void run();</li><li>cpp实现，run();</li><li>回主线程，包含子线程头文件</li><li>创建子线程类，MyThread mt；  mt.start();</li></ol><h3 id="QSemaphore-同步"><a href="#QSemaphore-同步" class="headerlink" title="QSemaphore 同步"></a>QSemaphore 同步</h3><p><a href="https://www.bilibili.com/video/BV1ka411y7oP?p=2&amp;spm_id_from=pageDriver&amp;vd_source=468a1f7565d351f1fb1599d05949abd0">https://www.bilibili.com/video/BV1ka411y7oP?p=2&amp;spm_id_from=pageDriver&amp;vd_source=468a1f7565d351f1fb1599d05949abd0</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QSemaphore&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>新建文件，SemManager，</li><li>包含QSemaphore，私有化单例：SemManager</li><li>公有成员 QSemaphore semA，semB,构造函数分别赋值1，和0</li><li>创建一个单例模式</li><li>子线程中调用sm-&gt;semB.acquire();阻塞B</li><li>子线程中调用sm-&gt;semA.release();释放A</li><li>另一个子线程顺序相反，先sm-&gt;semA.acquire();阻塞B</li><li>然后sm-&gt;semB.release();释放B</li><li>以此实现同步</li></ol><h3 id="QMutex-互斥"><a href="#QMutex-互斥" class="headerlink" title="QMutex  互斥"></a>QMutex  互斥</h3><p>保护一段代码同一个时刻只有一个线程可以执行</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMutex&gt;</span></span></span><br></pre></td></tr></table></figure><p>常用成员函数：</p><p>QMutex::QMutex(RecurisonMode mode&#x3D; NonRescursive)&#x2F;&#x2F;构造函数<br>void QMutex::lock();&#x2F;&#x2F;上锁<br>void QMutex::unlock();&#x2F;&#x2F;解锁</p><h3 id="moveToThread-委托槽函数给线程执行"><a href="#moveToThread-委托槽函数给线程执行" class="headerlink" title="moveToThread    委托槽函数给线程执行"></a>moveToThread    委托槽函数给线程执行</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QThread&gt;</span></span></span><br><span class="line">SlotObject *slotObj =<span class="keyword">new</span> <span class="built_in">SlotObject</span>(); <span class="comment">//槽函数，功能实现子类,**moveToThread时不能指定父对象**因为没有指定父对象，所以需要自己析构（在关闭窗口中，写delete slotObj;）</span></span><br><span class="line">QThread *thread = <span class="keyword">new</span> <span class="built_in">QThread</span>(<span class="keyword">this</span>);     <span class="comment">//创建一个线程类</span></span><br><span class="line">slotObj-&gt;<span class="built_in">moveToThread</span>(thread);<span class="comment">//委托线程</span></span><br><span class="line"><span class="built_in">connect</span>(ui-&gt;btn_start,QPushbutton::clicked,slotObj,SlotObject::fun);</span><br><span class="line">thread-&gt;<span class="built_in">start</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="插件QPlagin-带界面动态库"><a href="#插件QPlagin-带界面动态库" class="headerlink" title="插件QPlagin(带界面动态库)"></a>插件QPlagin(带界面动态库)</h2><p><a href="https://www.bilibili.com/video/BV1Sh4y1X7wQ/?spm_id_from=333.999.0.0&vd_source=468a1f7565d351f1fb1599d05949abd0">参考视频</a></p><ul><li>创建主框架程序</li><li>创建插件工程</li><li>插件工程添加界面类</li><li>插件创建头文件</li><li>定义接口</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> PLUGININTERFACE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLUGININTERFACE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Qwidget&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PluginInterfaceIID <span class="string">&quot;com.szweebon.PluginInterface/1.0.0&quot;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PluginInterface</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">virtual</span> ~<span class="built_in">PluginInterface</span>() = <span class="keyword">default</span>;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> QWidget *<span class="title">genWidget</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">Q_DECLARE_INTERFACE</span>(PluginInterface，PluginInterfaceIID)</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// PLUGININTERFACE_H</span></span></span><br></pre></td></tr></table></figure><p>未完待续</p><h2 id="树形结构浏览器"><a href="#树形结构浏览器" class="headerlink" title="树形结构浏览器"></a>树形结构浏览器</h2><h2 id="显示图片"><a href="#显示图片" class="headerlink" title="显示图片"></a>显示图片</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//QLabel显示OpenCV图像</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_pushButton_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Mat srcImg = <span class="built_in">imread</span>(<span class="string">&quot;1.jpg&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(srcImg.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;警告&quot;</span>,<span class="string">&quot;图片读取失败，请检查图片路径！&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Mat imgShow;</span><br><span class="line">    <span class="built_in">cvtColor</span>(srcImg, imgShow, COLOR_BGR2RGB); <span class="comment">// 图像格式转换</span></span><br><span class="line">    QImage qImg = <span class="built_in">QImage</span>((<span class="type">unsigned</span> <span class="type">char</span>*)(imgShow.data), imgShow.cols,</span><br><span class="line">                             imgShow.rows, imgShow.cols*imgShow.<span class="built_in">channels</span>(), QImage::Format_RGB888);</span><br><span class="line">    ui-&gt;label-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(qImg.<span class="built_in">scaled</span>(ui-&gt;label-&gt;<span class="built_in">size</span>(), Qt::KeepAspectRatio)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Graphics View显示OpenCV图像</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_pushButton_2_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Mat srcImg = <span class="built_in">imread</span>(<span class="string">&quot;2.jpg&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(srcImg.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;警告&quot;</span>,<span class="string">&quot;图片读取失败，请检查图片路径！&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Mat imgShow;</span><br><span class="line">    <span class="built_in">cvtColor</span>(srcImg, imgShow, COLOR_BGR2RGB); <span class="comment">// 图像格式转换</span></span><br><span class="line">    QImage qImg = <span class="built_in">QImage</span>((<span class="type">unsigned</span> <span class="type">char</span>*)(imgShow.data), imgShow.cols,</span><br><span class="line">                             imgShow.rows, imgShow.cols*imgShow.<span class="built_in">channels</span>(), QImage::Format_RGB888);</span><br><span class="line"></span><br><span class="line">    QGraphicsScene *scene = <span class="keyword">new</span> QGraphicsScene;<span class="comment">//图像显示</span></span><br><span class="line">    ui-&gt;graphicsView-&gt;<span class="built_in">setScene</span>(scene);</span><br><span class="line">    ui-&gt;graphicsView-&gt;<span class="built_in">show</span>();</span><br><span class="line">    scene-&gt;<span class="built_in">addPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(qImg));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> 技术 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt基础</title>
      <link href="/2023/11/17/Qt/Qt%E5%9F%BA%E7%A1%80/"/>
      <url>/2023/11/17/Qt/Qt%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="Qt"><a href="#Qt" class="headerlink" title="Qt"></a>Qt</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QByteArray data;</span><br><span class="line">    data.<span class="built_in">clear</span>();</span><br><span class="line">    data.<span class="built_in">append</span>(<span class="number">0xac</span>);</span><br><span class="line">    data.<span class="built_in">append</span>(<span class="number">0x02</span>);</span><br><span class="line">    data.<span class="built_in">append</span>(<span class="number">0x55</span>);</span><br><span class="line">    serial-&gt;<span class="built_in">write</span>(data);</span><br></pre></td></tr></table></figure><h2 id="ini文件中文"><a href="#ini文件中文" class="headerlink" title="ini文件中文"></a>ini文件中文</h2><p>Qt的ini配置文件默认不支持直接读写中文，需要手动设置下编码格式才行，强烈建议统一用utf-8<br>编码，包括代码文件。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置了编码以后配置文件内容为 Company=上海物联网技术研究中心</span></span><br><span class="line"><span class="comment">//没有设置编码则配置文件内容为</span></span><br><span class="line">Company=\xe4\xb8\x8a\xe6\xb5\xb7\xe7\x89\xa9\xe8\x81\x94\xe7\xbd\x91\xe6\x8a</span><br><span class="line">\x80\xe6\x9c\xaf\xe7\xa0\x94\xe7\xa9\xb6\xe4\xb8\xad\xe5\xbf\x83</span><br><span class="line"><span class="type">void</span> App::<span class="built_in">readConfig</span>()</span><br><span class="line">&#123;</span><br><span class="line">QSettings <span class="built_in">set</span>(App::ConfigFile, QSettings::IniFormat);</span><br><span class="line">set.<span class="built_in">setIniCodec</span>(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">set.<span class="built_in">beginGroup</span>(<span class="string">&quot;AppConfig1&quot;</span>);</span><br><span class="line">App::Company = set.<span class="built_in">value</span>(<span class="string">&quot;Company&quot;</span>, App::Company).<span class="built_in">toString</span>();</span><br><span class="line">set.<span class="built_in">endGroup</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">App::writeConfig</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">QSettings <span class="title">set</span><span class="params">(App::ConfigFile, QSettings::IniFormat)</span></span>;</span><br><span class="line">set.<span class="built_in">setIniCodec</span>(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">set.<span class="built_in">beginGroup</span>(<span class="string">&quot;AppConfig1&quot;</span>);</span><br><span class="line">set.<span class="built_in">setValue</span>(<span class="string">&quot;Company&quot;</span>, App::Company);</span><br><span class="line">set.<span class="built_in">endGroup</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> 技术 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一体机-图像处理时间计算</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E4%B8%80%E4%BD%93%E6%9C%BA/%E4%B8%80%E4%BD%93%E6%9C%BA%E6%97%B6%E9%97%B4%E5%85%AC%E5%BC%8F%E8%AE%A1%E7%AE%97/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E4%B8%80%E4%BD%93%E6%9C%BA/%E4%B8%80%E4%BD%93%E6%9C%BA%E6%97%B6%E9%97%B4%E5%85%AC%E5%BC%8F%E8%AE%A1%E7%AE%97/</url>
      
        <content type="html"><![CDATA[<h1 id="一体机处理时间计算"><a href="#一体机处理时间计算" class="headerlink" title="一体机处理时间计算"></a>一体机处理时间计算</h1><h2 id="相关参数（数据来源：上海富永）"><a href="#相关参数（数据来源：上海富永）" class="headerlink" title="相关参数（数据来源：上海富永）"></a>相关参数（数据来源：上海富永）</h2><ul><li>速度：50片&#x2F;分钟</li><li>产品长度：120毫米</li><li>产品间隔：360毫米</li><li>编码器型号：2000</li><li>编码器周长：300毫米</li><li>踢废位置间隔：400毫米</li><li>踢废脉冲间隔：1000</li></ul><h2 id="拍照"><a href="#拍照" class="headerlink" title="拍照"></a>拍照</h2><ol><li><p><strong>完整公式</strong></p><p> t&#x3D;（产品长度+产品间隔）&#x2F;（（产品长度+产品间隔）<em>（速度）&#x2F;60）</em>1000</p></li><li><p><strong>简化公式</strong></p><p> t&#x3D;60&#x2F;速度*1000</p></li></ol><h2 id="踢废"><a href="#踢废" class="headerlink" title="踢废"></a>踢废</h2><ol><li><p><strong>完整公式</strong></p><p> t&#x3D;（踢废间隔-（产品长度&#x2F;2））&#x2F;（编码器周长<em>（（产品长度+产品间隔）</em>60&#x2F;（每圈周长<em>60）））</em>1000</p></li><li><p><strong>解析：</strong></p><p> t&#x3D;S&#x2F;V<br> 时间&#x3D;距离&#x2F;每秒速度<br> S&#x3D;（踢废间隔-产品长度&#x2F;2）<br> V&#x3D;（编码器周长<em>（（50</em>（120+360）&#x2F;300）&#x2F;60））</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 一体机控制器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 一体机控制器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>STM32-HAL库</title>
      <link href="/2023/11/17/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/%E7%BC%96%E7%A8%8B/STM32-HAL%E5%BA%93/"/>
      <url>/2023/11/17/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/%E7%BC%96%E7%A8%8B/STM32-HAL%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h1 id="STM32-HAL库"><a href="#STM32-HAL库" class="headerlink" title="STM32-HAL库"></a>STM32-HAL库</h1><h2 id="cubemx创建工程"><a href="#cubemx创建工程" class="headerlink" title="cubemx创建工程"></a>cubemx创建工程</h2><h3 id="下载cubemx"><a href="#下载cubemx" class="headerlink" title="下载cubemx"></a>下载cubemx</h3><p><a href="https://www.st.com/zh/microcontrollers-microprocessors/stm32-32-bit-arm-cortex-mcus.html#tools-software">下载链接:STM32CubeMX</a></p><h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><p>安装路径中不得出现中文,一路下一步即可</p><h3 id="安装基础包"><a href="#安装基础包" class="headerlink" title="安装基础包"></a>安装基础包</h3><p>找到需要的芯片,展开,勾选需要安装的版本,点击install安装即可,该方式为网络安装,时间较长.</p><p><img src="/image/STM32-HAL%E5%BA%93/1678324388669.png" alt="1678324388669"></p><p><img src="/image/STM32-HAL%E5%BA%93/1678324508331.png" alt="1678324508331"></p><h3 id="新建工程"><a href="#新建工程" class="headerlink" title="新建工程"></a>新建工程</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678324629993.png" alt="1678324629993"></p><h3 id="选择芯片"><a href="#选择芯片" class="headerlink" title="选择芯片"></a>选择芯片</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678324701939.png" alt="1678324701939"></p><h3 id="配置引脚"><a href="#配置引脚" class="headerlink" title="配置引脚"></a>配置引脚</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678757272425.png" alt="1678757272425"></p><h3 id="配置时钟-外部时钟源"><a href="#配置时钟-外部时钟源" class="headerlink" title="配置时钟(外部时钟源)"></a>配置时钟(外部时钟源)</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678757334195.png" alt="1678757334195"></p><p><img src="/image/STM32-HAL%E5%BA%93/1678757389703.png" alt="1678757389703"></p><h3 id="配置swd"><a href="#配置swd" class="headerlink" title="配置swd"></a>配置swd</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678757519490.png" alt="1678757519490"></p><h3 id="配置定时器-需完善"><a href="#配置定时器-需完善" class="headerlink" title="配置定时器(需完善)"></a>配置定时器(需完善)</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678757656276.png" alt="1678757656276"></p><h3 id="配置SPI"><a href="#配置SPI" class="headerlink" title="配置SPI"></a>配置SPI</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678757844213.png" alt="1678757844213"></p><h3 id="配置IIC"><a href="#配置IIC" class="headerlink" title="配置IIC"></a>配置IIC</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678757779450.png" alt="1678757779450"></p><h3 id="配置USART"><a href="#配置USART" class="headerlink" title="配置USART"></a>配置USART</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678757939219.png" alt="1678757939219"></p><h3 id="配置ADC"><a href="#配置ADC" class="headerlink" title="配置ADC"></a>配置ADC</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678758098659.png" alt="1678758098659"></p><h3 id="配置DAC"><a href="#配置DAC" class="headerlink" title="配置DAC"></a>配置DAC</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678758181318.png" alt="1678758181318"></p><h3 id="设置工程"><a href="#设置工程" class="headerlink" title="设置工程"></a>设置工程</h3><p><img src="/image/STM32-HAL%E5%BA%93/1678758391540.png" alt="1678758391540"><br><img src="/image/STM32-HAL%E5%BA%93/1678758449042.png" alt="1678758449042"></p><h3 id="生成代码"><a href="#生成代码" class="headerlink" title="生成代码"></a>生成代码</h3><p>确保工程路径后点击,GENERATE CODE</p><p><img src="/image/STM32-HAL%E5%BA%93/1678758518181.png" alt="1678758518181"></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> STM32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> STM32 </tag>
            
            <tag> HAL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>差分编码器转接板说明书</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%B7%AE%E5%88%86%E4%BF%A1%E5%8F%B7%E8%BD%AC%E6%8E%A5%E6%9D%BF/%E5%B7%AE%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8%E8%BD%AC%E6%8E%A5%E6%9D%BF%E8%AF%B4%E6%98%8E%E4%B9%A6/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%B7%AE%E5%88%86%E4%BF%A1%E5%8F%B7%E8%BD%AC%E6%8E%A5%E6%9D%BF/%E5%B7%AE%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8%E8%BD%AC%E6%8E%A5%E6%9D%BF%E8%AF%B4%E6%98%8E%E4%B9%A6/</url>
      
        <content type="html"><![CDATA[<h1 id="差分编码器转接板"><a href="#差分编码器转接板" class="headerlink" title="差分编码器转接板"></a>差分编码器转接板</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ol><li>差分编码器转接板，由差分编码器输入差分信号，输出差分信号给线扫相机，输出IO信号给控制器，实现差分信号到差分信号的转换。</li><li>差分编码器转接板还集成了一个24V（9V~26V）-5V的电源，用于给差分编码器供电。</li><li>控制器可以输出IO信号给差分编码器转接板，用于控制差分编码器转接板的差分信号输出开关。</li></ol><!-- ## 原理图 --><!-- ![原理图](image/SCH_STM32F103C8T6_1-P1_2023-09-11.png) --><h2 id="管脚定义"><a href="#管脚定义" class="headerlink" title="管脚定义"></a>管脚定义</h2><p><img src="/image/3D_STM32F103C8T6_2023-09-11.png" alt="管脚定义"></p><h2 id="功能定义"><a href="#功能定义" class="headerlink" title="功能定义"></a>功能定义</h2><table><thead><tr><th>引脚</th><th>功能描述</th><th>备注</th></tr></thead><tbody><tr><td>GND</td><td>电源负极引脚</td><td>接开关电源</td></tr><tr><td>24V</td><td>电源正极引脚</td><td>接开关电源</td></tr><tr><td>TRA-</td><td>差分输出A-</td><td>接相机input-</td></tr><tr><td>TRA+</td><td>差分输出A+</td><td>接相机input+</td></tr><tr><td>TRB-</td><td>差分输出B-</td><td>接相机input-</td></tr><tr><td>TRB+</td><td>差分输出B+</td><td>接相机input+</td></tr><tr><td>GND</td><td>电源负极引脚</td><td>接差分编码器</td></tr><tr><td>5V</td><td>5V供电输出</td><td>接差分编码器</td></tr><tr><td>EN_A-</td><td>差分信号输入</td><td>接差分编码器A-</td></tr><tr><td>EN_A+</td><td>差分信号输入</td><td>接差分编码器A+</td></tr><tr><td>EN_B-</td><td>差分信号输入</td><td>接差分编码器B-</td></tr><tr><td>EN_B+</td><td>差分信号输入</td><td>接差分编码器B+</td></tr><tr><td>EN_Z-</td><td>差分信号输入</td><td>接差分编码器Z-</td></tr><tr><td>EN_Z+</td><td>差分信号输入</td><td>接差分编码器Z+</td></tr><tr><td>IO_A</td><td>使能差分输出</td><td>默认开启，输入信号关闭。接控制器，IO引脚，控制差分输出A</td></tr><tr><td>IO_B</td><td>使能差分呼出</td><td>默认开启，输入信号关闭。接控制器，IO引脚，控制差分输出B</td></tr><tr><td>OUTA</td><td>差分转电极</td><td>接控制器编码器输入引脚A</td></tr><tr><td>OUTB</td><td>差分转电极</td><td>预留</td></tr><tr><td>OUTZ</td><td>差分转电极</td><td>接控制器编码器输入引脚Z</td></tr></tbody></table><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>差分编码器转接板统一使用500P&#x2F;R的差分编码器输入信号</li></ol><h2 id="控制器设置"><a href="#控制器设置" class="headerlink" title="控制器设置"></a>控制器设置</h2><ol><li>参数设置<ul><li>编码器型号：倍频后的一圈脉冲数量<br> <img src="/image/%E5%B7%AE%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8%E8%BD%AC%E6%8E%A5%E6%9D%BF%E8%AF%B4%E6%98%8E%E4%B9%A6/1695195457272.png" alt="1695195457272"></li><li>高级-&gt;差分编码器倍频系数：与相机设置的倍频系数一致<br> <img src="/image/%E5%B7%AE%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8%E8%BD%AC%E6%8E%A5%E6%9D%BF%E8%AF%B4%E6%98%8E%E4%B9%A6/1695195433602.png" alt="1695195433602"></li></ul></li></ol><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ol><li>卫品（帧触发）</li><li>卫材</li></ol><h2 id="参考资料（相机驱动设置编码器模式以及倍频）"><a href="#参考资料（相机驱动设置编码器模式以及倍频）" class="headerlink" title="参考资料（相机驱动设置编码器模式以及倍频）"></a>参考资料（相机驱动设置编码器模式以及倍频）</h2><ol><li><a href="Basler.html">Basler相机差分编码器设置及倍频设置</a></li><li><a href="HIK.html">海康相机差分编码器设置及倍频设置</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 差分编码器转接板 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 差分编码器转接板 </tag>
            
            <tag> 倍分频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>复卷瑕疵定位系统</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E5%A4%8D%E5%8D%B7%E7%91%95%E7%96%B5%E5%AE%9A%E4%BD%8D%E7%B3%BB%E7%BB%9F/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E5%A4%8D%E5%8D%B7%E7%91%95%E7%96%B5%E5%AE%9A%E4%BD%8D%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="复卷瑕疵定位系统"><a href="#复卷瑕疵定位系统" class="headerlink" title="复卷瑕疵定位系统"></a>复卷瑕疵定位系统</h1><h2 id="产线速度计算公式"><a href="#产线速度计算公式" class="headerlink" title="产线速度计算公式"></a>产线速度计算公式</h2><p>$$生产速度&#x3D;频率<em>60&#x2F;脉冲数量</em>(脉冲数量&#x2F;压轮周长)$$<br>$$speed&#x3D;frequency<em>60&#x2F;pulseNumber</em>(pulseNumber&#x2F;perimeter)$$</p><h2 id="减速度计算公式"><a href="#减速度计算公式" class="headerlink" title="减速度计算公式"></a>减速度计算公式</h2><p>$$减速度&#x3D;运行速度&#x2F;减速时间$$<br>$$reduceSpeed&#x3D;runningSpeed&#x2F;decelerationTime$$</p><h2 id="锥度计算公式"><a href="#锥度计算公式" class="headerlink" title="锥度计算公式"></a>锥度计算公式</h2><p>$$减速距离&#x3D;0.5*(运行速度&#x2F;减速时间)<em>减速时间²+初始速度</em>时间$$</p><h2 id="位移反推适当速度"><a href="#位移反推适当速度" class="headerlink" title="位移反推适当速度"></a>位移反推适当速度</h2><h3 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h3><p>$$时间&#x3D;\sqrt[]{距离&#x2F;(0.5*减速度)}$$</p><h3 id="速度"><a href="#速度" class="headerlink" title="速度"></a>速度</h3><p>$$速度&#x3D;时间*加速度$$</p><h2 id="收卷寻疵停机距离递增计算公式"><a href="#收卷寻疵停机距离递增计算公式" class="headerlink" title="收卷寻疵停机距离递增计算公式"></a>收卷寻疵停机距离递增计算公式</h2><h3 id="计算圈数"><a href="#计算圈数" class="headerlink" title="计算圈数"></a>计算圈数</h3><p>$$当前圈数&#x3D;(-2<em>PI</em>初始半径+\sqrt[]{(4<em>PI²</em>初始半径²+4<em>厚度</em>材料长度<em>PI)})&#x2F;(2</em>厚度*PI)$$</p><h3 id="外圈半径"><a href="#外圈半径" class="headerlink" title="外圈半径"></a>外圈半径</h3><p>$$外圈半径&#x3D;初始半径+当前圈数*厚度$$</p><h3 id="外圈周长"><a href="#外圈周长" class="headerlink" title="外圈周长"></a>外圈周长</h3><p>$$外圈周长&#x3D;2<em>PI</em>外圈半径$$</p>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 复卷瑕疵定位系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 复卷瑕疵定位系统 </tag>
            
            <tag> 复卷 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>检测停机-Dalsa倍分频-差分转接板-控制器</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="检测停机"><a href="#检测停机" class="headerlink" title="检测停机"></a>检测停机</h1><h2 id="Dalsa倍频设置"><a href="#Dalsa倍频设置" class="headerlink" title="Dalsa倍频设置"></a>Dalsa倍频设置</h2><h3 id="下载SDK"><a href="#下载SDK" class="headerlink" title="下载SDK"></a>下载SDK</h3><p><a href="http://teledynedalsa.com/sapera-lt-dl/?dl=1&pkg=SDKWOW64&key=BezZNB87ZcwFO7mZ1Neb1g==">Sapera LT 8.73 SDK (WoW64)</a></p><p><a href="http://teledynedalsa.com/sapera-lt-dl/?dl=1&pkg=SDK&key=BezZNB87ZcwFO7mZ1Neb1g==">Sapera LT 8.73 SDK For Developers</a></p><h3 id="8K线扫-LA-GM-08K08A-00-R-Linea-M8192-7um-1"><a href="#8K线扫-LA-GM-08K08A-00-R-Linea-M8192-7um-1" class="headerlink" title="8K线扫(LA-GM-08K08A-00-R&#x2F;Linea_M8192-7um_1)"></a>8K线扫(LA-GM-08K08A-00-R&#x2F;Linea_M8192-7um_1)</h3><h4 id="接口-引脚定义"><a href="#接口-引脚定义" class="headerlink" title="接口&#x2F;引脚定义"></a>接口&#x2F;引脚定义</h4><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111715061840-1699844368847.png" alt="image"></p><h4 id="倍频设置（编码器型号500，设置2000）"><a href="#倍频设置（编码器型号500，设置2000）" class="headerlink" title="倍频设置（编码器型号500，设置2000）"></a>倍频设置（编码器型号500，设置2000）</h4><ol><li>点击show more<img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111715065374-1699845828795.png" alt="image"></li><li>Trigger Selector 选择 Single Line Trigger（Start）</li><li>Trigger Mode 选择 On</li><li>Trigger Source 选择 Rotary Encoder   （触发源选择编码器模式）</li><li>Trigger Overlap 选择 Readout</li><li>Rotary Encoder Output Mode 选择 Motion   （编码器方向：忽略方向）</li><li>Rotary Encoder Input A Source 选择 Line1 （编码器A）</li><li>Rotary Encoder Input B Source 选择 Line2 （编码器B）</li><li>Rotary Encoder Source Activation 选择 Any Edge   （边沿触发）</li><li>Rotary Encoder Multiplier 选择 1    （倍频）</li><li>Rotary Encoder Divider 选择 1   （分频）</li><li>Line Selector 选择 Line1    （设置Line1滤波）</li><li>Input Line Debouncing Period（in us）设置5  （滤波设置5us）</li><li>Line Selector 选择 Line2    （设置Line2滤波）</li><li>Input Line Debouncing Period（in us）设置5  （滤波设置5us）</li></ol><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111715071163-1699846663334.png" alt="image"></p><h4 id="PLC接线"><a href="#PLC接线" class="headerlink" title="PLC接线"></a>PLC接线</h4><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111715072407-1699847663497.png" alt="image"></p><h4 id="差分编码器转接板接线"><a href="#差分编码器转接板接线" class="headerlink" title="差分编码器转接板接线"></a>差分编码器转接板接线</h4><h5 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h5><ol><li>差分编码器转接板，由差分编码器输入差分信号，输出差分信号给线扫相机，输出IO信号给控制器，实现差分信号到差分信号的转换。</li><li>差分编码器转接板还集成了一个24V（9V~26V）-5V的电源，用于给差分编码器供电。</li><li>控制器可以输出IO信号给差分编码器转接板，用于控制差分编码器转接板的差分信号输出开关。</li></ol><!-- ## 原理图 --><!-- ![原理图](image/SCH_STM32F103C8T6_1-P1_2023-09-11.png) --><h5 id="管脚定义"><a href="#管脚定义" class="headerlink" title="管脚定义"></a>管脚定义</h5><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111715075301-3D_STM32F103C8T6_2023-09-11.png" alt="image"></p><h5 id="功能定义"><a href="#功能定义" class="headerlink" title="功能定义"></a>功能定义</h5><table><thead><tr><th>引脚</th><th>功能描述</th><th>备注</th></tr></thead><tbody><tr><td>GND</td><td>电源负极引脚</td><td>接开关电源</td></tr><tr><td>24V</td><td>电源正极引脚</td><td>接开关电源</td></tr><tr><td>TRA-</td><td>差分输出A-</td><td>接相机input-</td></tr><tr><td>TRA+</td><td>差分输出A+</td><td>接相机input+</td></tr><tr><td>TRB-</td><td>差分输出B-</td><td>接相机input-</td></tr><tr><td>TRB+</td><td>差分输出B+</td><td>接相机input+</td></tr><tr><td>GND</td><td>电源负极引脚</td><td>接差分编码器</td></tr><tr><td>5V</td><td>5V供电输出</td><td>接差分编码器</td></tr><tr><td>EN_A-</td><td>差分信号输入</td><td>接差分编码器A-</td></tr><tr><td>EN_A+</td><td>差分信号输入</td><td>接差分编码器A+</td></tr><tr><td>EN_B-</td><td>差分信号输入</td><td>接差分编码器B-</td></tr><tr><td>EN_B+</td><td>差分信号输入</td><td>接差分编码器B+</td></tr><tr><td>EN_Z-</td><td>差分信号输入</td><td>接差分编码器Z-</td></tr><tr><td>EN_Z+</td><td>差分信号输入</td><td>接差分编码器Z+</td></tr><tr><td>IO_A</td><td>使能差分输出</td><td>默认开启，输入信号关闭。接控制器，IO引脚，控制差分输出A</td></tr><tr><td>IO_B</td><td>使能差分呼出</td><td>默认开启，输入信号关闭。接控制器，IO引脚，控制差分输出B</td></tr><tr><td>OUTA</td><td>差分转电极</td><td>接控制器编码器输入引脚A</td></tr><tr><td>OUTB</td><td>差分转电极</td><td>预留</td></tr><tr><td>OUTZ</td><td>差分转电极</td><td>接控制器编码器输入引脚Z</td></tr></tbody></table><h5 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h5><ol><li>差分编码器转接板统一使用500P&#x2F;R的差分编码器输入信号</li></ol><h5 id="控制器设置"><a href="#控制器设置" class="headerlink" title="控制器设置"></a>控制器设置</h5><ol><li>参数设置<ul><li>编码器型号：倍频后的一圈脉冲数量<br> <img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111715081364-1695195457272.png" alt="image"></li><li>高级-&gt;差分编码器倍频系数：与相机设置的倍频系数一致<br> <img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111715082563-1695195433602.png" alt="image"></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 检测停机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 控制器 </tag>
            
            <tag> 检测停机 </tag>
            
            <tag> Dalsa </tag>
            
            <tag> 倍频 </tag>
            
            <tag> 差分转接板 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>控制器-串口1对多方案设计</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8E%A7%E5%88%B6%E5%99%A8/%E6%8E%A7%E5%88%B6%E5%99%A8-%E4%B8%80%E4%B8%BB%E5%A4%9A%E4%BB%8E/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8E%A7%E5%88%B6%E5%99%A8/%E6%8E%A7%E5%88%B6%E5%99%A8-%E4%B8%80%E4%B8%BB%E5%A4%9A%E4%BB%8E/</url>
      
        <content type="html"><![CDATA[<h1 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h1><h2 id="1-串口1对多方案设计"><a href="#1-串口1对多方案设计" class="headerlink" title="1.串口1对多方案设计"></a>1.串口1对多方案设计</h2><h3 id="1-1需求一"><a href="#1-1需求一" class="headerlink" title="1.1需求一"></a>1.1需求一</h3><ul><li>黄冈稳健：主机1，控制器10，用来踢废。纵向精度毫米级</li></ul><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><ul><li>主机使用串口1，串口转485通信，485转串口接控制器，作为通信组网硬件配置</li><li>控制器协议使用自定义的带协议站号，寄存器地址分配，写入和读取的协议</li><li>协议简述：站号0，作为广播通用配置，用于配置站号属性</li><li>功能地址位：1~100为硬件写功能地址</li><li>功能地址位：1000~1120为写掉电保持地址</li><li>功能地址位：3001~6000为硬件读功能地址</li><li>功能地址位：60000~65535为保留地址</li></ul><h3 id="1-2需求二"><a href="#1-2需求二" class="headerlink" title="1.2需求二"></a>1.2需求二</h3><ul><li>杭州豪悦: 主机1，控制器1，相机2</li></ul><h4 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h4><ul><li>主机使用串口1，从机通信参考上述黄冈稳健，编码器为1个，两个相机，功能：标准控制器功能即可</li></ul>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 控制器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 控制器 </tag>
            
            <tag> 通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>qudpsocket</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/qudpsocket/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/qudpsocket/</url>
      
        <content type="html"><![CDATA[<h1 id="QUdpSocket"><a href="#QUdpSocket" class="headerlink" title="QUdpSocket"></a>QUdpSocket</h1><h2 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h2><ol><li>pro文件添加模块，QT       +&#x3D;  network</li><li>添加头文件#include <code>&lt;QUdpSocket&gt;</code> <code>&lt;QHostAddress&gt;</code></li><li>创建对象并实例化  private:    QUdpSocket *udpSocket;    udpSocket&#x3D;new QUdpSocket(this);</li><li>绑定IP地址和端口：udpSocket-&gt;bind(QHostAddress::AnyIPv4,port);&#x2F;&#x2F;port是端口号，任意指定，建议大于1024小于65535</li><li>连接接收数据槽函数   connect(udpSocket,&amp;QUdpSocket::readyRead,this,&amp;MainWindow::read_image);&#x2F;&#x2F;接收数据，处理函数为read_image</li><li>发送数据 udpSocket-&gt;writeDatagram(ui-&gt;textEdit-&gt;toPlainText().toUtf8(),QHostAddress(ui-&gt;linee_IP-&gt;text()),i-&gt;linee_port-&gt;text().toInt());</li></ol><h2 id="其它UDP库"><a href="#其它UDP库" class="headerlink" title="其它UDP库"></a>其它UDP库</h2><p>1.c++系统库 <code>&lt;sys/socket.h&gt;性能较高，非异步，可能会阻塞主线程，需要额外处理</code></p><p>2.libuv <code>&lt;uv.h&gt;异步，性能高，使用单独的事件循环</code></p><p>&lt;**处理接收数据**&gt;</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">QHostAddress address;</span><br><span class="line">    quint16 port;</span><br><span class="line"></span><br><span class="line">    QByteArray array;</span><br><span class="line">    array.<span class="built_in">resize</span>(udpSocket-&gt;<span class="built_in">bytesAvailable</span>());<span class="comment">//根据可读数据来设置空间大小</span></span><br><span class="line">    <span class="comment">//读取数据，获取客户端的IP地址和端口号</span></span><br><span class="line">    <span class="type">int</span> tmp = udpSocket-&gt;<span class="built_in">readDatagram</span>(array.<span class="built_in">data</span>(),array.<span class="built_in">size</span>(),&amp;address,&amp;port);</span><br><span class="line">    <span class="keyword">if</span> (tmp&gt;<span class="number">0</span>&amp;&amp;tmp&lt;=<span class="number">1000</span>) &#123;</span><br><span class="line">           ui-&gt;textEdit-&gt;<span class="built_in">append</span>(<span class="string">&quot;接收来自：&quot;</span>+address.<span class="built_in">toString</span>()+<span class="string">&quot;:&quot;</span>+QString::<span class="built_in">number</span>(port)+array);</span><br><span class="line">       &#125;</span><br><span class="line">    <span class="keyword">if</span> (array.<span class="built_in">size</span>() &gt;<span class="number">1000</span>) &#123; <span class="comment">// 假设2表示其他类型的消息</span></span><br><span class="line">           <span class="comment">// 处理其他类型的消息</span></span><br><span class="line"></span><br><span class="line">           <span class="function">QBuffer <span class="title">buffer</span><span class="params">(&amp;array)</span></span>;<span class="comment">//添加数据到缓冲器</span></span><br><span class="line">           buffer.<span class="built_in">open</span>(QIODevice::ReadOnly);<span class="comment">//读取</span></span><br><span class="line"></span><br><span class="line">           <span class="function">QImageReader <span class="title">reader</span><span class="params">(&amp;buffer,<span class="string">&quot;JPG&quot;</span>)</span></span>;<span class="comment">//读取img</span></span><br><span class="line">           QImage img = reader.<span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span>(!img.<span class="built_in">isNull</span>())&#123;</span><br><span class="line"></span><br><span class="line">               QMessageBox::<span class="built_in">information</span>(<span class="literal">NULL</span>,<span class="string">&quot;ima&quot;</span>,<span class="string">&quot;ima&quot;</span>);</span><br><span class="line">               ui-&gt;lb_image_show-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(img));</span><br><span class="line">               ui-&gt;lb_image_show-&gt;<span class="built_in">show</span>();</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="built_in">qDebug</span>()&lt;&lt;address&lt;&lt;<span class="string">&quot;---&quot;</span>&lt;&lt;port;</span><br><span class="line"></span><br><span class="line">           ui-&gt;textEdit-&gt;<span class="built_in">append</span>(<span class="string">&quot;接收来自：&quot;</span>+address.<span class="built_in">toString</span>()+<span class="string">&quot;:&quot;</span>+<span class="string">&quot;\r\n&quot;</span>+QString::<span class="built_in">number</span>(port)+array.<span class="built_in">toHex</span>());</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>&lt;**发送图像数据**&gt;</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">QString filename = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>, <span class="built_in">tr</span>(<span class="string">&quot;选择图片&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="built_in">tr</span>(<span class="string">&quot;图片文件 (*.png *.jpg *.jpeg)&quot;</span>));</span><br><span class="line">   <span class="keyword">if</span> (!filename.<span class="built_in">isEmpty</span>()) &#123;</span><br><span class="line">   <span class="comment">// 打开图片并进行相应操作</span></span><br><span class="line"></span><br><span class="line">   QImage image;</span><br><span class="line">   <span class="keyword">if</span> (image.<span class="built_in">load</span>(filename)) &#123;</span><br><span class="line">       QLabel* label = ui-&gt;lb_image_show;</span><br><span class="line">       label-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(image));</span><br><span class="line">       label-&gt;<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       QByteArray byteArray;</span><br><span class="line">       QBuffer buffer;</span><br><span class="line">       buffer.<span class="built_in">open</span>(QIODevice::WriteOnly);</span><br><span class="line">       image.<span class="built_in">save</span>(&amp;buffer, <span class="string">&quot;JPG&quot;</span>);  <span class="comment">// 将图片数据保存到byteArray中</span></span><br><span class="line">       byteArray.<span class="built_in">append</span>(buffer.<span class="built_in">data</span>());</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(udpSocket-&gt;<span class="built_in">writeDatagram</span>(byteArray.<span class="built_in">data</span>(),</span><br><span class="line">            byteArray.<span class="built_in">size</span>(), <span class="built_in">QHostAddress</span>(ui-&gt;linee_IP-&gt;<span class="built_in">text</span>()),</span><br><span class="line">                                    ui-&gt;linee_port-&gt;<span class="built_in">text</span>().<span class="built_in">toInt</span>())==<span class="number">-1</span>)&#123;</span><br><span class="line">           <span class="built_in">qDebug</span>()&lt;&lt;udpSocket-&gt;<span class="built_in">error</span>();</span><br><span class="line">           QMessageBox::<span class="built_in">warning</span>(<span class="literal">NULL</span>,<span class="string">&quot;erro&quot;</span>,udpSocket-&gt;<span class="built_in">errorString</span>());</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="comment">// 图片加载失败</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> udp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> udp </tag>
            
            <tag> 测试 </tag>
            
            <tag> qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>npcap</title>
      <link href="/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/npcap/"/>
      <url>/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/npcap/</url>
      
        <content type="html"><![CDATA[<h1 id="Npcap"><a href="#Npcap" class="headerlink" title="Npcap"></a>Npcap</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul><li>官网下载：<a href="https://npcap.com/dist/npcap-sdk-1.13.zip">Npcap SDK 1.13 (ZIP).</a></li></ul><h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">├─docs</span><br><span class="line">│  └─wpcap</span><br><span class="line">├─Examples-pcap</span><br><span class="line">    ├─MakeAll.sln</span><br><span class="line">├─Examples-remote</span><br><span class="line">├─Include</span><br><span class="line">│  └─pcap</span><br><span class="line">└─Lib</span><br><span class="line">    ├─ARM64</span><br><span class="line">    └─x64</span><br></pre></td></tr></table></figure><p>其中需要关注的有Lib文件夹，以及Examples-pcap和Examples-remote文件夹。</p><h2 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h2><ul><li>打开Examples-pcap文件夹下的MakeAll.sln，使用Visual Studio 2019编译。</li><li>若编译失败，查看是否需要链接库，若需要，则将Lib-&gt;x64-&gt;下的wpcap.lib与Packet.lib添加到工程中。包含Include文件夹下的内容。</li></ul><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ul><li>设置udpdump为启动项（也可以是basic_dump），会弹出控制台窗口，输入数字选择网卡，即开启抓包。</li><li>修改printf内容，增加一个序号打印如下： <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//printf(&quot;%s,%.6d len:%d\n&quot;, timestr, header-&gt;ts.tv_usec, header-&gt;len);</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">i++;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d,l:%d\n&quot;</span>,i,header-&gt;len);</span><br></pre></td></tr></table></figure></li><li>测试抓包数量小于wireshark抓包速度，约为其一半左右，与第三方udp库速度差不多。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> udp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> udp </tag>
            
            <tag> 测试 </tag>
            
            <tag> npcap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>libuv</title>
      <link href="/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libuv/"/>
      <url>/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libuv/</url>
      
        <content type="html"><![CDATA[<h1 id="libuv"><a href="#libuv" class="headerlink" title="libuv"></a>libuv</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>libuv 是一个多平台 C 库，它支持基于事件循环的异步 I&#x2F;O。它支持 epoll（4）、kqueue（2）、Windows IOCP、Solaris 事件移植和 Linux io_uring。它主要设计用于 Node.js，但它也被其他软件项目使用。[3] 它最初是围绕 libev 或 Microsoft IOCP 的抽象，因为 libev 在 Windows 上不支持 IOCP。在 node-v0.9.0 的 libuv 版本中，删除了对 libev 的依赖。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul><li>vcpkg 安装    vcpkg install libuv</li><li>github上的<a href="https://github.com/libuv/libuv">libuv</a></li></ul><h2 id="客户端-服务器代码"><a href="#客户端-服务器代码" class="headerlink" title="客户端&#x2F;服务器代码"></a>客户端&#x2F;服务器代码</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFuture&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> *read_image_data;</span><br><span class="line"></span><br><span class="line">    <span class="type">uv_loop_t</span> *loop;        <span class="comment">//</span></span><br><span class="line">    <span class="type">uv_udp_t</span> send_socket;   <span class="comment">//“客户端”句柄，发送消息</span></span><br><span class="line">    <span class="type">uv_udp_t</span> recv_socket;   <span class="comment">//“服务器”句柄，接收消息</span></span><br><span class="line"></span><br><span class="line">    <span class="type">uv_udp_send_t</span> send_req;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">send_addr</span>;</span></span><br><span class="line">    <span class="type">uv_buf_t</span> discover_msg;</span><br><span class="line"></span><br><span class="line">    <span class="type">uv_buf_t</span> <span class="title function_">make_discover_msg</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">set_uv_receive</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    read_image_data = new <span class="type">char</span>[<span class="number">9</span>*<span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回初始化的默认循环。在以下情况下，它可能会返回 NULL。 分配失败。</span></span><br><span class="line">    <span class="comment">//此函数只是在整个过程中进行全局循环的便捷方式 一个应用程序，默认循环与默认循环没有任何不同 用 初始化。</span></span><br><span class="line">    <span class="comment">//因此，默认循环可以（和 应该）关闭，以便关联的资源 有了它就被释放了。</span></span><br><span class="line">    loop = uv_default_loop();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化新的 UDP 句柄。实际的套接字是延迟创建的。 成功时返回 0。</span></span><br><span class="line">    uv_udp_init(loop, &amp;recv_socket);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//结构体，成员有IP地址，端口号</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">recv_addr</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//将包含 IPv4 地址的字符串转换为二进制结构。</span></span><br><span class="line">    uv_ip4_addr(<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">6800</span>, &amp;recv_addr);   <span class="comment">//监听地址和端口</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    将IP地址和端口绑定到UDP 句柄。</span></span><br><span class="line">    <span class="comment">//    句柄 – UDP 句柄。。</span></span><br><span class="line">    <span class="comment">//    addr – 具有要绑定到的地址和端口的结构sockaddr_in或结构sockaddr_in6。</span></span><br><span class="line">    <span class="comment">//    flags – 指示套接字的绑定方式、、 以及受支持方式。UV_UDP_IPV6ONLYUV_UDP_REUSEADDRUV_UDP_RECVERR</span></span><br><span class="line">    <span class="comment">//    返回值:</span></span><br><span class="line">    <span class="comment">//    成功时为 0，失败时错误代码&lt; 0。</span></span><br><span class="line">    uv_udp_bind(&amp;recv_socket, (<span class="type">const</span> <span class="keyword">struct</span> sockaddr *)&amp;recv_addr, UV_UDP_REUSEADDR);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    准备接收数据。如果套接字以前未绑定 与它绑定到 0.0.0.0（“所有接口” IPv4 地址）和随机端口号。</span></span><br><span class="line">    <span class="comment">//    参数：</span></span><br><span class="line">    <span class="comment">//    句柄 – UDP 句柄。应该使用 初始化。</span></span><br><span class="line">    <span class="comment">//    alloc_cb – 需要临时存储时调用的回调。  //无法设置缓存区大小，默认使用系统参数（一般为4K~64K，即65535字节）</span></span><br><span class="line">    <span class="comment">//    recv_cb – 使用接收到的数据进行调用的回调。</span></span><br><span class="line">    <span class="comment">//    返回值:</span></span><br><span class="line">    <span class="comment">//    成功时为 0，失败时错误代码&lt; 0。</span></span><br><span class="line">    uv_udp_recv_start(&amp;recv_socket, alloc_buffer, on_read);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//发送消息，已验证成功</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化新的 UDP 句柄。实际的套接字是延迟创建的。 成功时返回 0。</span></span><br><span class="line">    uv_udp_init(loop, &amp;send_socket);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//绑定发送端的IP以及端口号</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">broadcast_addr</span>;</span></span><br><span class="line">    uv_ip4_addr(<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">6800</span>, &amp;broadcast_addr);</span><br><span class="line">    uv_udp_bind(&amp;send_socket, (<span class="type">const</span> <span class="keyword">struct</span> sockaddr *)&amp;broadcast_addr, <span class="number">0</span>);</span><br><span class="line">    uv_udp_set_broadcast(&amp;send_socket, <span class="number">1</span>);  <span class="comment">//打开或关闭广播功能，1为开启，0为关闭</span></span><br><span class="line"></span><br><span class="line">    discover_msg = make_discover_msg();</span><br><span class="line"></span><br><span class="line">    uv_ip4_addr(<span class="string">&quot;192.168.1.198&quot;</span>, <span class="number">6700</span>, &amp;send_addr);<span class="comment">//要发送到哪里</span></span><br><span class="line">    uv_udp_send(&amp;send_req, &amp;send_socket, &amp;discover_msg, <span class="number">1</span>, (<span class="type">const</span> <span class="keyword">struct</span> sockaddr *)&amp;send_addr, on_send);</span><br><span class="line"></span><br><span class="line">    uv_run(loop, UV_RUN_DEFAULT);</span><br><span class="line"></span><br><span class="line">    qDebug()&lt;&lt;<span class="string">&quot;end&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//void thread_uv_receive::on_send(uv_udp_send_t *req, int status) &#123;&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">alloc_buffer</span><span class="params">(<span class="type">uv_handle_t</span> *handle, <span class="type">size_t</span> suggested_size, <span class="type">uv_buf_t</span> *buf)</span> &#123;</span><br><span class="line">    buf-&gt;base =static_cast&lt;<span class="type">char</span> *&gt;( <span class="built_in">malloc</span>(suggested_size));</span><br><span class="line">    buf-&gt;len = suggested_size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">on_read</span><span class="params">(<span class="type">uv_udp_t</span> *req, <span class="type">ssize_t</span> nread, <span class="type">const</span> <span class="type">uv_buf_t</span> *buf, <span class="type">const</span> <span class="keyword">struct</span> sockaddr *addr, <span class="type">unsigned</span> flags)</span> &#123;</span><br><span class="line">    <span class="comment">//    qDebug()&lt;&lt;&quot;接收消息&quot;;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    qDebug()&lt;&lt;&quot;buf_base_size&quot;&lt;&lt;nread ;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    QByteArray j;</span></span><br><span class="line"><span class="comment">//    j.clear();</span></span><br><span class="line"><span class="comment">//    for(int i=0;i&lt;2;i++)&#123;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        j.append(buf-&gt;base[i]);</span></span><br><span class="line"><span class="comment">//        //        QString str=j.toHex();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    qDebug()&lt;&lt;&quot;buf_base:&quot;&lt;&lt;j.toHex();</span></span><br><span class="line">    <span class="comment">//    if(j.at(0)==0x60)</span></span><br><span class="line">    <span class="comment">//    uv_udp_send(&amp;send_req, &amp;send_socket, &amp;discover_msg, 1, (const struct sockaddr *)&amp;send_addr, on_send);</span></span><br><span class="line"><span class="comment">//    QFuture&lt;void&gt; future = QtConcurrent::run([=]()&#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="type">uint16_t</span> offset_data=<span class="number">6</span>;</span><br><span class="line">    <span class="type">uint16_t</span> index;</span><br><span class="line">    <span class="type">uint16_t</span> height_index= (((<span class="type">uint16_t</span>)buf-&gt;base[<span class="number">0</span>])&lt;&lt;<span class="number">8</span>)&amp;<span class="number">0xff00</span>;</span><br><span class="line">    index=height_index|(((<span class="type">uint16_t</span>)buf-&gt;base[<span class="number">1</span>])&amp;<span class="number">0x00ff</span>);</span><br><span class="line">    qDebug()&lt;&lt;<span class="string">&quot;index:&quot;</span>&lt;&lt;index;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    memcpy(read_image_data + index * (buf-&gt;len - offset_data),</span></span><br><span class="line"><span class="comment">//           buf-&gt;base + offset_data, buf-&gt;len - offset_data);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    if (nread &lt; 0) &#123;</span></span><br><span class="line"><span class="comment">//        fprintf(stderr, &quot;Read error %s\n&quot;, uv_err_name(nread));</span></span><br><span class="line"><span class="comment">//        uv_close((uv_handle_t*) req, NULL);</span></span><br><span class="line"><span class="comment">//        free(buf-&gt;base);</span></span><br><span class="line"><span class="comment">//        return;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    char sender[17] = &#123; 0 &#125;;</span></span><br><span class="line"><span class="comment">//    uv_ip4_name((const struct sockaddr_in*) addr, sender, 16);</span></span><br><span class="line"><span class="comment">//    //    fprintf(stderr, &quot;Recv from %s\n&quot;, sender);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    // ... DHCP specific code</span></span><br><span class="line"><span class="comment">//    unsigned int *as_integer = (unsigned int*)buf-&gt;base;</span></span><br><span class="line"><span class="comment">//    unsigned int ipbin = ntohl(as_integer[4]);</span></span><br><span class="line"><span class="comment">//    unsigned char ip[4] = &#123;0&#125;;</span></span><br><span class="line"><span class="comment">//    int i;</span></span><br><span class="line"><span class="comment">//    for (i = 0; i &lt; 4; i++)</span></span><br><span class="line"><span class="comment">//        ip[i] = (ipbin &gt;&gt; i*8) &amp; 0xff;</span></span><br><span class="line"><span class="comment">//    //    fprintf(stderr, &quot;Offered IP %d.%d.%d.%d\n&quot;, ip[3], ip[2], ip[1], ip[0]);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    //    free(buf-&gt;base);</span></span><br><span class="line"><span class="comment">//    //    uv_udp_recv_stop(req);</span></span><br><span class="line"><span class="comment">//    &#125;);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uv_buf_t</span> <span class="title function_">thread_uv_receive::make_discover_msg</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">uv_buf_t</span> buffer;</span><br><span class="line"></span><br><span class="line">    alloc_buffer(<span class="literal">NULL</span>, <span class="number">9</span>*<span class="number">1024</span>*<span class="number">7</span>, &amp;buffer);   <span class="comment">//设置发送缓存区（最大设置为64K，超过则会发送失败）</span></span><br><span class="line">    <span class="built_in">memset</span>(buffer.base, <span class="number">0</span>, buffer.len); <span class="comment">//初始化缓存区，全部设置为0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// BOOTREQUEST</span></span><br><span class="line">    buffer.base[<span class="number">0</span>] = <span class="number">0x1</span>;</span><br><span class="line">    <span class="comment">// HTYPE ethernet</span></span><br><span class="line">    buffer.base[<span class="number">1</span>] = <span class="number">0x1</span>;</span><br><span class="line">    <span class="comment">// HLEN</span></span><br><span class="line">    buffer.base[<span class="number">2</span>] = <span class="number">0x6</span>;</span><br><span class="line">    <span class="comment">// HOPS</span></span><br><span class="line">    buffer.base[<span class="number">3</span>] = <span class="number">0x0</span>;</span><br><span class="line">    <span class="comment">// XID 4 bytes</span></span><br><span class="line">    <span class="keyword">if</span> (uv_random(<span class="literal">NULL</span>, <span class="literal">NULL</span>, &amp;buffer.base[<span class="number">4</span>], <span class="number">4</span>, <span class="number">0</span>, <span class="literal">NULL</span>))</span><br><span class="line">        <span class="built_in">abort</span>();</span><br><span class="line">    <span class="comment">// SECS</span></span><br><span class="line">    buffer.base[<span class="number">8</span>] = <span class="number">0x0</span>;</span><br><span class="line">    <span class="comment">// FLAGS</span></span><br><span class="line">    buffer.base[<span class="number">10</span>] = <span class="number">0x80</span>;</span><br><span class="line">    <span class="comment">// CIADDR 12-15 is all zeros</span></span><br><span class="line">    <span class="comment">// YIADDR 16-19 is all zeros</span></span><br><span class="line">    <span class="comment">// SIADDR 20-23 is all zeros</span></span><br><span class="line">    <span class="comment">// GIADDR 24-27 is all zeros</span></span><br><span class="line">    <span class="comment">// CHADDR 28-43 is the MAC address, use your own</span></span><br><span class="line">    buffer.base[<span class="number">28</span>] = <span class="number">0xe4</span>;</span><br><span class="line">    buffer.base[<span class="number">29</span>] = <span class="number">0xce</span>;</span><br><span class="line">    buffer.base[<span class="number">30</span>] = <span class="number">0x8f</span>;</span><br><span class="line">    buffer.base[<span class="number">31</span>] = <span class="number">0x13</span>;</span><br><span class="line">    buffer.base[<span class="number">32</span>] = <span class="number">0xf6</span>;</span><br><span class="line">    buffer.base[<span class="number">33</span>] = <span class="number">0xd4</span>;</span><br><span class="line">    <span class="comment">// SNAME 64 bytes zero</span></span><br><span class="line">    <span class="comment">// FILE 128 bytes zero</span></span><br><span class="line">    <span class="comment">// OPTIONS</span></span><br><span class="line">    <span class="comment">// - magic cookie</span></span><br><span class="line">    buffer.base[<span class="number">236</span>] = <span class="number">99</span>;</span><br><span class="line">    buffer.base[<span class="number">237</span>] = <span class="number">130</span>;</span><br><span class="line">    buffer.base[<span class="number">238</span>] = <span class="number">83</span>;</span><br><span class="line">    buffer.base[<span class="number">239</span>] = <span class="number">99</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// DHCP Message type</span></span><br><span class="line">    buffer.base[<span class="number">240</span>] = <span class="number">53</span>;</span><br><span class="line">    buffer.base[<span class="number">241</span>] = <span class="number">1</span>;</span><br><span class="line">    buffer.base[<span class="number">242</span>] = <span class="number">1</span>; <span class="comment">// DHCPDISCOVER</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// DHCP Parameter request list</span></span><br><span class="line">    buffer.base[<span class="number">243</span>] = <span class="number">55</span>;</span><br><span class="line">    buffer.base[<span class="number">244</span>] = <span class="number">4</span>;</span><br><span class="line">    buffer.base[<span class="number">245</span>] = <span class="number">1</span>;</span><br><span class="line">    buffer.base[<span class="number">246</span>] = <span class="number">3</span>;</span><br><span class="line">    buffer.base[<span class="number">247</span>] = <span class="number">15</span>;</span><br><span class="line">    buffer.base[<span class="number">248</span>] = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> buffer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">on_send</span><span class="params">(<span class="type">uv_udp_send_t</span> *req, <span class="type">int</span> status)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (status) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Send error %s\n&quot;</span>, uv_strerror(status));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">thread_uv_receive::set_uv_receive</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> udp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> udp </tag>
            
            <tag> 测试 </tag>
            
            <tag> libuv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>libudt</title>
      <link href="/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libudt/"/>
      <url>/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libudt/</url>
      
        <content type="html"><![CDATA[<h1 id="libudt"><a href="#libudt" class="headerlink" title="libudt"></a>libudt</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>UDT 是一种可靠的基于 UDP 的应用程序级数据传输协议，用于 广域高速网络上的分布式数据密集型应用。 UDT 使用 UDP 传输批量数据，并具有自己的可靠性控制和 拥塞控制机制。新协议可以以 速度比TCP高。UDT 也是一个高度可配置的框架， 可以适应各种拥塞控制算法。</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>必须为两台主机之间建立 UDT 连接，然后才能使用 UDT 进行数据传输。</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> udp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> udp </tag>
            
            <tag> 测试 </tag>
            
            <tag> libudt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>libpcap</title>
      <link href="/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libpcap/"/>
      <url>/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libpcap/</url>
      
        <content type="html"><![CDATA[<h1 id="libpcap"><a href="#libpcap" class="headerlink" title="libpcap"></a>libpcap</h1><h2 id="操作步骤："><a href="#操作步骤：" class="headerlink" title="操作步骤："></a>操作步骤：</h2><ol><li>获取网络设备名称pcap_lookupdev(err)返回值：char *设备名称</li><li>打开设备 pcap_dev_live(dev,1024,1,0,err)        参数1：设备名称，参数2：数据包长度，参数3：混杂模式（0为非混杂），参数4：0不等待，参数5：错误信息   返回值：句柄 pcap_t  pcap</li><li>获取网段，子网掩码pcap_lookupnet（dev,）</li><li>捕获一次数据包 pcap_next()</li><li>循环捕获数据包 pcap_loop()配合回调函数 : void callback (unsigned * )</li><li>pcap_close()关闭 释放内存</li></ol><h2 id="过滤规则："><a href="#过滤规则：" class="headerlink" title="过滤规则："></a>过滤规则：</h2><ol><li>pcap_compile(pcap_t *p,struct bpf_pro)只获取部分数据（否则将获取全部数据包数据）</li><li>pcap_setfilter()设置过滤规则，可以设置只获取udp</li></ol><h2 id="测试结论："><a href="#测试结论：" class="headerlink" title="测试结论："></a>测试结论：</h2><pre><code>仅linux可以使用，windows会报系统不支持错误。</code></pre>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> udp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> udp </tag>
            
            <tag> 测试 </tag>
            
            <tag> libpcap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HIK</title>
      <link href="/2023/11/16/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/HIK/"/>
      <url>/2023/11/16/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/HIK/</url>
      
        <content type="html"><![CDATA[<h1 id="HIK"><a href="#HIK" class="headerlink" title="HIK"></a>HIK</h1><h2 id="2K线扫-MV-CL024-91GM"><a href="#2K线扫-MV-CL024-91GM" class="headerlink" title="2K线扫(MV-CL024-91GM)"></a>2K线扫(MV-CL024-91GM)</h2><p><a href="https://www.hikrobotics.com/cn/machinevision/service/download?module=0">MVS下载地址</a></p><h3 id="接口定义"><a href="#接口定义" class="headerlink" title="接口定义"></a>接口定义</h3><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615363753-1691723886693.png" alt="image"></p><h3 id="引脚定义"><a href="#引脚定义" class="headerlink" title="引脚定义"></a>引脚定义</h3><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615353379-1691723906436.png" alt="image"></p><h3 id="倍频设置"><a href="#倍频设置" class="headerlink" title="倍频设置"></a>倍频设置</h3><ol><li>IO Input 类别下</li><li>Trigger Selector 设置 Line Start</li><li>Trigger Mode 设置 On</li><li>Trigger Source 设置 Frequency Conveter</li><li>Frequency Converter Contol 类别下</li><li>Input Source 选择 Line0（用哪个选哪个）</li><li>Multiplier 设置 倍频系数 （最大32倍频）</li></ol><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615365774-1691724214518.png" alt="image"></p><h3 id="编码器模式-部分验证"><a href="#编码器模式-部分验证" class="headerlink" title="编码器模式  (部分验证)"></a>编码器模式  (部分验证)</h3><p><strong>简述</strong>：正反转功能支持42亿，按300周长，每圈1000脉冲计算，可倒转1288490.1882米（一百二十万米） ，  与Basler相同（开启两相输入相当于4倍频，一相输入则相当于2倍频）</p><ol><li>IO Input 类别下</li><li>Trigger Selector 设置 Line Start</li><li>Trigger Mode 设置 On</li><li>Trigger Source 设置 Encoder Module Out</li><li>Encoder Control 类别下</li><li>Encoder Selector 选择 Encoder0</li><li>Encoder Source A 选择 Line0（用哪个选哪个）</li><li>Encoder Source B 选择 Line1</li><li>Encoder Trigger Mode 选择Any Direction（任意方向）还有仅正向或仅反向可选择</li><li>Encoder Counter Mode 选择 Follow Direction&#x2F;Backward Direction（根据方向选择）</li><li>Encoder Counter Max 设置 4294967294</li><li>Encoder Max Reverse Counter 设置 4294967294</li></ol><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615371599-1691725072234.png" alt="image"><br><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615373196-1695182858207.png" alt="image"></p><h4 id="调试中遇到的问题"><a href="#调试中遇到的问题" class="headerlink" title="调试中遇到的问题"></a>调试中遇到的问题</h4><ul><li>若仅使用1路差分拍照，则Encoder Max Reverse Counter 必须设置未0，否则不出图</li></ul><h3 id="输出IO-（已验证）"><a href="#输出IO-（已验证）" class="headerlink" title="输出IO  （已验证）"></a>输出IO  （已验证）</h3><p><strong>简述</strong>： 相机相应功能触发时输出信号给外部设备</p><ol><li>Line Selector 选择 Line3（用哪个选哪个）</li><li>Line Mode 选择 Strobe    (频闪输出)</li><li>Line Source 选择 fram end Active （其它说明：曝光开始有效，会每一行曝光都输出信号）</li><li>Strobe Enable 点击开启</li><li>Strobe Line Duration(us) 设置 10000</li></ol><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615374610-1695187721608.png" alt="image"></p><p>信号输出类型如下</p><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615375788-1691726273784.png" alt="image"></p><h3 id="变帧-（动态图像高度）"><a href="#变帧-（动态图像高度）" class="headerlink" title="变帧 （动态图像高度）"></a>变帧 （动态图像高度）</h3><p><strong>简述</strong>: 相机输出图像的图像高度可变。最高为设定的图像高度。触发行数不足图像高度则根据Partial Image Output Mode 的设置输出图像，若触发行数超过图像高度，则立即输图像高度行数的图像，并继续触发行。</p><ol><li><p>接线</p><ul><li>行信号输入： Line0</li><li>帧信号输入： Line3</li></ul></li><li><p>设置</p><ul><li><p>触发选择器：行开始</p></li><li><p>触发模式：开启</p></li><li><p>触发源：线路0</p></li><li><p>触发极性：上升沿</p></li><li><p>触发选择器：帧开始</p></li><li><p>触发模式：开启</p></li><li><p>触发源：线路3</p></li><li><p>触发极性：低电平</p></li><li><p>Partial Image Output Mode:PartialImageOutput  &#x2F;&#x2F; 部分图像输出模式</p></li><li><p>行触发设置<img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615381922-1695015346188.png" alt="image"></p></li><li><p>帧触发设置<img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615383255-1695015333108.png" alt="image"></p></li></ul></li><li><p>Partial Image Output Mode 其它模式说明：</p></li></ol><p><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615385540-1695015282443.png" alt="image"></p><h3 id="帧-行触发缓存"><a href="#帧-行触发缓存" class="headerlink" title="帧&#x2F;行触发缓存"></a>帧&#x2F;行触发缓存</h3><h4 id="帧触发缓存"><a href="#帧触发缓存" class="headerlink" title="帧触发缓存"></a>帧触发缓存</h4><p><strong>简述</strong>： 触发过程若接收到新的触发信号，可将该信号保留并进行处理。在处理当前信号时，触发缓存使能最多能保留 3 个触发信号等待处理。</p><ol><li>设置<ul><li>帧触发缓存使能通过 Acquisition Control 属性下的 Trigger Cache Enable 参数进行控制（说明：必须开启帧触发才可以适用该功能）</li><li><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615391295-1695176925059.png" alt="image"></li><li>不开启该功能，则触发图像过程中接收到帧信号，则忽略帧信号</li><li>若开启该功能，则触发图像过程中接收到帧信号，则保留帧信号，直到当前图像完成后，立即继续开始第二个帧信号的图像触发，保留的帧信号数量最多可以达到3个。</li><li><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615392591-1695177529533.png" alt="image"></li></ul></li></ol><h4 id="行触发缓存"><a href="#行触发缓存" class="headerlink" title="行触发缓存"></a>行触发缓存</h4><p><strong>简述</strong>： 实际测试中，开启行触发缓存与关闭行触发缓存似乎并无区别。</p><ol><li>设置<ul><li><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111615394099-1695177604360.png" alt="image"></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> 相机 </category>
          
          <category> HIK </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 相机 </tag>
            
            <tag> 海康 </tag>
            
            <tag> HIK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>部署博客</title>
      <link href="/2023/11/15/%E7%BB%BC%E5%90%88/%E5%8D%9A%E5%AE%A2/hexo_github_vscode_minio/"/>
      <url>/2023/11/15/%E7%BB%BC%E5%90%88/%E5%8D%9A%E5%AE%A2/hexo_github_vscode_minio/</url>
      
        <content type="html"><![CDATA[<h1 id="本地部署博客"><a href="#本地部署博客" class="headerlink" title="本地部署博客"></a>本地部署博客</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>以下方法实现了，同一台主机，部署多个服务，不同域名访问不同服务，同一域名访问不同服务。局域网访问图床图片。的良好体验。</p><h2 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h2><ol><li>安装node.js <a href="https://nodejs.org/en/download/">下载安装包</a></li><li>安装Git</li><li>安装hexo <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure></li><li>初始化<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo init blog</span><br><span class="line">cd blog</span><br><span class="line">npm install</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>安装hexo-deployer-git<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></li><li>在_config.yml中配置<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https://github.com/fengjie1223/fengjie1223.github.io</span><br><span class="line">  branch: main</span><br><span class="line">  token:    //从github设置中获取</span><br></pre></td></tr></table></figure></li><li>生产网页并上传<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d  //三个指令分别为清除，构建，上传</span><br></pre></td></tr></table></figure></li></ol><h2 id="github"><a href="#github" class="headerlink" title="github"></a>github</h2><ol><li>建立名为 &lt;你的 GitHub 用户名&gt;.github.io 的储存库，设置为public</li><li>仓库设置General-&gt;Default branch为main</li><li>仓库设置Pages Build and deployment -&gt; Source-&gt;Github Actions</li><li>Token ：</li></ol><h2 id="minio"><a href="#minio" class="headerlink" title="minio"></a>minio</h2><ol><li>安装minio    <a href="https://min.io/">下载安装包</a></li><li>部署minio    将下载好的exe文件放到准备作为图床文件夹下</li><li>启动minio     用cmd启动，或配置bat文件启动，下述代码为bat文件源码，cmd仅执行最后三行即可<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> @echo off</span><br><span class="line">if &quot;%1&quot; == &quot;h&quot; goto begin</span><br><span class="line">mshta vbscript:createobject(&quot;wscript.shell&quot;).run(&quot;&quot;&quot;%~nx0&quot;&quot; h&quot;,0)(window.close)&amp;&amp;exit</span><br><span class="line">:begin</span><br><span class="line">REM</span><br><span class="line">c:</span><br><span class="line">cd C:\MyServer\markdown_images</span><br><span class="line">setx MINIO_ROOT_USER admin                                  //设置用户名</span><br><span class="line">setx MINIO_ROOT_PASSWORD password                           //设置密码</span><br><span class="line">.\minio.exe server C:\MyServer\markdown_images --address :9000  //启动minio，并将端口号设置为9000（默认为9000）</span><br></pre></td></tr></table></figure></li><li>配置minio    打开127.0.0.1:9000，点击Create Bucket，创建名为mdimage的bucket</li><li>配置权限     点击mdimage仓库，设置Access Policy：为 public</li></ol><h2 id="vscode"><a href="#vscode" class="headerlink" title="vscode"></a>vscode</h2><ol><li>安装扩展 vscode-minio-picman （设置地址路径不要带端口号，否则自动返回的地址不带端口号）</li><li>配置vscode-minio-picman  <ol><li>配置地址 <a href="http://cnbed.com:9000/">http://cnbed.com:9000</a> （这里用了域名映射，原地址为127.0.0.1）</li><li>Access Key   uG7bf1JZBf1eCqpjEZ0S</li><li>Secret Key   HAgtVMhGuFgQkGVbIgVSuo9rOKrGODH29H7PkXCy</li><li>Bucket Name  mdimage （这里填写minio创建的仓库的名字）</li><li>Directory    images&#x2F;vscode-minio-picman<br><img src="http://cnbed.com/mdimage/images/vscode-minio-picman/2023111515030310-20231115150301.png" alt="image"></li></ol></li></ol><h2 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h2><ol><li>配置多主机模式，将minio的IP地址及端口映射到cnbed.com</li><li>vscode 配置 minio 地址时填写cnbed.com:9000</li><li>返回的图片链接为cnbed.com&#x2F;***即可直接访问（无端口号）</li><li>路由器配置域名映射cnbed.com到服务器地址，内网即可访问图片</li><li>配置域名解析：C:\Windows\System32\drivers\etc下的hosts文件内最后一行填写&lt;IP地址 域名&gt;，端口号则由nginx解析</li><li>配置同一域名多个服务配置：server块中写多个location块即可，例：   <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    # root   html;</span><br><span class="line">    # index  index.<span class="property">html</span> index.<span class="property">htm</span>;</span><br><span class="line">    proxy_pass <span class="attr">http</span>:<span class="comment">//127.0.0.1:4000;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location /blog&#123;</span><br><span class="line">    proxy_pass <span class="attr">http</span>:<span class="comment">//127.0.0.1:4000/;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location /download&#123;</span><br><span class="line">    proxy_pass <span class="attr">http</span>:<span class="comment">//127.0.0.1:8000/;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>有些服务器不支持同域名多端口，则需要设置独立的域名，即写多个server块，路由器中也将独立的域名映射到服务器地址，例如：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   server&#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name cnbed.com;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:9000;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    server&#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name cnafgit.com;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:3000;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>最后将nginx 使用nssm工具，或使用bat脚本文件，添加到服务中</li></ol><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><ol><li>互联网图床 github smms qiniu等</li><li>图床工具 picgo</li><li>配合quick 脚本可以一键上传并返回链接</li><li>配合obsidian可以一键插入图片</li></ol><p>经验：<br>nginx</p><ul><li>反向代理hexo，若使用alias 指向public index.heml可以使用子域名访问，但会导致不能加载主题，解决办法为hexo使用独立的域名，alias指向改为root即可<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">//主页</span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line"></span><br><span class="line">            # root C:/Users/fengj/OneDrive/Programs/hexo_my_note/public;</span><br><span class="line">            # index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">//文件服务器</span><br><span class="line">                location /HID&#123;</span><br><span class="line"></span><br><span class="line">            autoindex on;             #开启索引功能</span><br><span class="line">            autoindex_exact_size off; # 关闭计算文件确切大小（单位bytes），只显示大概大小（单位kb、mb、gb）</span><br><span class="line">            autoindex_localtime on;   # 显示本机时间而非 GMT 时间</span><br><span class="line">#           charset utf-8; # 避免中文乱码</span><br><span class="line">            alias C:/MyServer/download/HID;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //图床</span><br><span class="line">            server&#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name cnbed.com;</span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://127.0.0.1:9000;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //论坛</span><br><span class="line">    server&#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name cnafbb.com;</span><br><span class="line">        location /&#123;</span><br><span class="line">            proxy_pass http://127.0.0.1:4567;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //同步盘</span><br><span class="line">            server&#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name cnafsyncthing.com;</span><br><span class="line">        location /&#123;</span><br><span class="line">            proxy_pass http://127.0.0.1:8384;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">//博客</span><br><span class="line">    server&#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name cnafblog.com;</span><br><span class="line">        location /&#123;</span><br><span class="line">            root C:/Users/fengj/OneDrive/Programs/hexo_my_note/public;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><p>syncthing</p><ul><li>下载syncthing</li><li>nssm安装服务</li><li>打开网页127.0.0.1:8384</li><li>若同一网络已经有syncthing则会发现设备ID</li><li>打开syncthing-gtk，点击“添加设备”</li><li>输入设备ID，点击“添加”</li><li>同步即可</li><li>评价：简单好用的文件同步软件（同步盘）</li></ul><p>hexo </p><ul><li>不要开启服务器运行（会导致一些问题，例如部分文件不能删除等），使用hexo d -g 生成静态文件，然后使用nginx反向代理即可</li></ul><p>nodebb</p><ul><li>参考<a href="https://docs.nodebb.org/installing/os/windows/">文档</a> </li><li>下载nodebb <a href="https://github.com/NodeBB/NodeBB">地址</a></li><li>检查环境 node -v  npm -v  ,若没有，则下载nodejs并安装</li><li>安装Mongodb 注意事项，只安装服务，不要安装gui（安装太慢），再根据参考文档设置，需要注意：use admin之后的指令，需要设置密码，拷贝指令的时候自己修改 <strong>pwd:</strong> 的密码</li><li>创建nodebb，密码也使用nodebb</li><li>在nodebb文件夹下执行 <code>nodebb setup</code></li><li>等待安装，时间会比较长（似乎不需要外网）</li><li>完成后会提示一些内容，按回车确认，注意：提示输入monogdb用户以及密码的时候 ， 输入之前自己设定的用户名nodebb，密码nodebb，另外提示输入管理用户名的时候，输入admin（或自定义），密码admin（或自定义），记住即可。</li><li>启动nodebb <code>nodebb start</code></li><li>访问127.0.0.1:4567</li><li>使用管理用户登录</li><li>管理设置-&gt;全局常规-&gt;修改标头-&gt;修改语言为中文</li><li>界面主题不要改，若改了之后，出现主题样式丢失，改回默认重新构建重启即可</li><li>nodebb所有信息存储在mongodb中，自己设定的nodebb表中，可以重置mongodb，然后删除nodebb文件夹，重新创建。重置mongodb指令如下：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use your_database_name</span><br><span class="line">db.dropDatabase() </span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
            <tag> hexo </tag>
            
            <tag> github </tag>
            
            <tag> minio </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dalsa</title>
      <link href="/2023/11/14/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/Dalsa/"/>
      <url>/2023/11/14/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/Dalsa/</url>
      
        <content type="html"><![CDATA[<h2 id="下载SDK"><a href="#下载SDK" class="headerlink" title="下载SDK"></a>下载SDK</h2><p><a href="http://teledynedalsa.com/sapera-lt-dl/?dl=1&pkg=SDKWOW64&key=BezZNB87ZcwFO7mZ1Neb1g==">Sapera LT 8.73 SDK (WoW64)</a></p><p><a href="http://teledynedalsa.com/sapera-lt-dl/?dl=1&pkg=SDK&key=BezZNB87ZcwFO7mZ1Neb1g==">Sapera LT 8.73 SDK For Developers</a></p><h2 id="8K线扫-LA-GM-08K08A-00-R-Linea-M8192-7um-1"><a href="#8K线扫-LA-GM-08K08A-00-R-Linea-M8192-7um-1" class="headerlink" title="8K线扫(LA-GM-08K08A-00-R&#x2F;Linea_M8192-7um_1)"></a>8K线扫(LA-GM-08K08A-00-R&#x2F;Linea_M8192-7um_1)</h2><h3 id="接口-引脚定义"><a href="#接口-引脚定义" class="headerlink" title="接口&#x2F;引脚定义"></a>接口&#x2F;引脚定义</h3><p><img src="/image/Dalsa/1699844368847.png" alt="1699844368847"></p><h3 id="倍频设置（编码器型号500，设置2000）"><a href="#倍频设置（编码器型号500，设置2000）" class="headerlink" title="倍频设置（编码器型号500，设置2000）"></a>倍频设置（编码器型号500，设置2000）</h3><ol><li>点击show more<img src="/image/Dalsa/1699845828795.png" alt="1699845828795"></li><li>Trigger Selector 选择 Single Line Trigger（Start）</li><li>Trigger Mode 选择 On</li><li>Trigger Source 选择 Rotary Encoder   （触发源选择编码器模式）</li><li>Trigger Overlap 选择 Readout</li><li>Rotary Encoder Output Mode 选择 Motion   （编码器方向：忽略方向）</li><li>Rotary Encoder Input A Source 选择 Line1 （编码器A）</li><li>Rotary Encoder Input B Source 选择 Line2 （编码器B）</li><li>Rotary Encoder Source Activation 选择 Any Edge   （边沿触发）</li><li>Rotary Encoder Multiplier 选择 1    （倍频）</li><li>Rotary Encoder Divider 选择 1   （分频）</li><li>Line Selector 选择 Line1    （设置Line1滤波）</li><li>Input Line Debouncing Period（in us）设置5  （滤波设置5us）</li><li>Line Selector 选择 Line2    （设置Line2滤波）</li><li>Input Line Debouncing Period（in us）设置5  （滤波设置5us）</li></ol><p><img src="/image/Dalsa/1699846663334.png" alt="1699846663334"></p>]]></content>
      
      
      <categories>
          
          <category> 相机 </category>
          
          <category> Dalsa </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Basler</title>
      <link href="/2023/11/14/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/Basler/"/>
      <url>/2023/11/14/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/Basler/</url>
      
        <content type="html"><![CDATA[<h2 id="下载SDK"><a href="#下载SDK" class="headerlink" title="下载SDK"></a>下载SDK</h2><p><a href="https://www.baslerweb.com/cn/downloads/software-downloads/#type=pylonsoftware;os=windows;version=all">Basler Pylon 下载链接</a></p><h2 id="2K线扫（ral2048-48gm）"><a href="#2K线扫（ral2048-48gm）" class="headerlink" title="2K线扫（ral2048_48gm）"></a>2K线扫（ral2048_48gm）</h2><h3 id="接口定义"><a href="#接口定义" class="headerlink" title="接口定义"></a>接口定义</h3><p><img src="/image/Basler/1691373077846.png" alt="1691373077846"></p><h3 id="引脚定义"><a href="#引脚定义" class="headerlink" title="引脚定义"></a>引脚定义</h3><p><img src="/image/Basler/1691373104156.png" alt="1691373104156"></p><p><img src="/image/Basler/1691373121526.png" alt="1691373121526"></p><h3 id="倍频设置-已验证成功"><a href="#倍频设置-已验证成功" class="headerlink" title="倍频设置    (已验证成功)"></a>倍频设置    (已验证成功)</h3><p><strong>简述</strong>：倍频模式只需要编码器一相输入即可，不需要AB两相。</p><ol><li>Trigger Selector选择Line Start</li><li>Trigger Mode 选择On</li><li>Trigger Source选择Frequency Converter</li><li>类别Digital I&#x2F;O Controls下Line Selector选择Line1（用哪个选哪个）</li><li>Line Debouncer Time Abs[us] 输入10，滤波10us</li><li>类别-&gt;Frequency Converter下Input Source选择Line 1（用哪个选哪个）</li><li>Signal Alignment选择Rising Edge</li><li>Multiplier输入需要倍频的系数</li><li>Prevent Overtrigger 打上对勾</li></ol><p><img src="/image/Basler/1691651655789.png" alt="1691651655789"></p><p><img src="/image/Basler/1691651686013.png" alt="1691651686013"></p><p><img src="/image/Basler/1691651821475.png" alt="1691651821475"></p><h4 id="调试过程中遇到的问题"><a href="#调试过程中遇到的问题" class="headerlink" title="调试过程中遇到的问题"></a>调试过程中遇到的问题</h4><ul><li>连接相机后立即且一直出图。<br>  解决办法：Line Debouncer Time Abs设置滤波解决</li></ul><h3 id="编码器模式-已验证成功"><a href="#编码器模式-已验证成功" class="headerlink" title="编码器模式  (已验证成功)"></a>编码器模式  (已验证成功)</h3><p><strong>简述</strong>：编码器模式正向拍照，反向不拍照且计数，恢复正向后到开始反向的位置则继续拍照。(相当于直接4倍频)</p><ol><li>Trigger Selector选择Line Start</li><li>Trigger Mode 选择On</li><li>Trigger Source选择Shaft Encoder Module Out</li><li>类别Digital I&#x2F;O Controls下Line Selector选择Line1（用哪个选哪个）</li><li>Line Debouncer Time Abs[us] 输入10，滤波10us</li><li>类别-&gt;Shaft Encoder Module Out下Shaft Encoder Module Line Selector选择Phase A</li><li>Shaft Encoder Module Line选择Line1(接线哪个选哪个)</li><li>Shaft Encoder Module Out下Shaft Encoder Module Line Selector选择Phase B</li><li>Shaft Encoder Module Line选择Line3(接线哪个选哪个)</li><li>Shaft Encoder Module Trigger Mode Any Direction 开启任意方向滴答计数</li><li>Shaft Encoder Module Counter Mode 选择Follow Direction 开启反转负计数</li><li>Shaft Encoder Module Max Reverse Counter 负计数最大值，设置为32767</li><li><strong>注意</strong>：两个计数，最大值是32767，最小值是0，若向上超过最大值则变成0开始计数，向下超过0，则变成32767</li></ol><p><img src="/image/Basler/1691655242058.png" alt="1691655242058"></p><p>思考：若使用到检测停机中，配合采集触发就绪功能，则可以解决干扰以及正反转的问题</p><h3 id="输出IO-采集就绪输出信号，未验证"><a href="#输出IO-采集就绪输出信号，未验证" class="headerlink" title="输出IO (采集就绪输出信号，未验证)"></a>输出IO (采集就绪输出信号，未验证)</h3><p><strong>简述</strong>：可以作为图像结束信号，对齐图像工位，避免受到干扰造成的影响（手册中，在线文档中都没有该功能的描述，因为要代码设置参数，且需要写下位机程序验证，需要花费较长的时间，故此没有验证，此处仅简单记录）</p><p>部分功能验证，输出IO有效</p><ol><li>类别Diagital I&#x2F;O Controls 下 Line Selector 选择 Output Line 1</li><li>Line Source 选择 Acquisition Trigger Ready</li><li>Line Output Pulse Min.Width[us] 设置为100us（似乎是最大值）</li></ol><p><img src="/image/Basler/1691720510840.png" alt="1691720510840"></p><p>备注：Line Source 只能通过代码设置选择 Acquisition Trigger Ready，相机驱动中没有提供该功能的选项</p>]]></content>
      
      
      <categories>
          
          <category> 相机 </category>
          
          <category> Basler </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
