<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/2024/12/20/%E7%BB%BC%E5%90%88/git%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/12/20/%E7%BB%BC%E5%90%88/git%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="Git笔记"><a href="#Git笔记" class="headerlink" title="Git笔记"></a>Git笔记</h1><h2 id="合并本次提交到上一次提交"><a href="#合并本次提交到上一次提交" class="headerlink" title="合并本次提交到上一次提交"></a>合并本次提交到上一次提交</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#如果一个功能或者版本开发完了 已经提交了commit ，然后又更改了几个小地方或者</span><br><span class="line">#小bug，而不想生成新的提交信息，可以使用以下命令</span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line">git commit --amend --no-edit</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/12/19/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/UDP_%E4%BC%A0%E5%9B%BE%E8%AE%B0%E5%BD%95Demo-FenJE/"/>
      <url>/2024/12/19/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/UDP_%E4%BC%A0%E5%9B%BE%E8%AE%B0%E5%BD%95Demo-FenJE/</url>
      
        <content type="html"><![CDATA[<h1 id="UDP传图记录"><a href="#UDP传图记录" class="headerlink" title="UDP传图记录"></a>UDP传图记录</h1><h2 id="发送"><a href="#发送" class="headerlink" title="发送"></a>发送</h2><h3 id="编程"><a href="#编程" class="headerlink" title="编程"></a>编程</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QUdpSocket&gt;</span></span></span><br><span class="line">QUdpSocket *udpSocket;</span><br><span class="line"><span class="type">char</span> *read_image_data;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::send_image</span><span class="params">()</span><span class="comment">//发送图像</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::init_udp</span><span class="params">()</span></span>&#123;<span class="comment">//初始化udp</span></span><br><span class="line">udpSocket = <span class="keyword">new</span> <span class="built_in">QUdpSocket</span>(<span class="keyword">this</span>);</span><br><span class="line">udpSocket-&gt;<span class="built_in">bind</span>(QHostAddress::AnyIPv4, <span class="number">12345</span>);<span class="comment">//  //绑定IP地址和端口</span></span><br><span class="line">read_image_data = <span class="keyword">new</span> <span class="type">char</span>[<span class="number">9</span>*<span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line"><span class="built_in">connect</span>(udpSocket, &amp;QUdpSocket::readyRead, <span class="keyword">this</span>, &amp;MainWindow::read_image);</span><br><span class="line">    udpSocket-&gt;<span class="built_in">setReadBufferSize</span>(<span class="number">9</span>*<span class="number">1024</span>*<span class="number">1024</span>);<span class="comment">//UDP通信设置这个参数无效。默认使用系统参数</span></span><br><span class="line">    udpSocket-&gt;<span class="built_in">setSocketOption</span>(QAbstractSocket::ReceiveBufferSizeSocketOption,<span class="number">9</span>*<span class="number">1024</span>*<span class="number">1024</span>);</span><br><span class="line"></span><br><span class="line">    QSettings *configIni = <span class="keyword">new</span> <span class="built_in">QSettings</span>(fileName, QSettings::IniFormat);</span><br><span class="line"></span><br><span class="line">    pack_fail_cache=configIni-&gt;<span class="built_in">value</span>(<span class="string">&quot;pack_cach&quot;</span>).<span class="built_in">toString</span>()==<span class="string">&quot;&quot;</span>?<span class="number">10</span>:configIni-&gt;<span class="built_in">value</span>(<span class="string">&quot;pack_cach&quot;</span>).<span class="built_in">toUInt</span>();</span><br><span class="line"><span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;pack_fail_cache&quot;</span>&lt;&lt;pack_fail_cache;</span><br><span class="line">    configIni-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//发送图像</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::send_image</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Mat send_image;</span><br><span class="line"></span><br><span class="line">    String str = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>, <span class="built_in">tr</span>(<span class="string">&quot;选择图片&quot;</span>),</span><br><span class="line">                                              <span class="string">&quot;C:\\Users\\fengj\\OneDrive\\Samples&quot;</span>,</span><br><span class="line">                                              <span class="built_in">tr</span>(<span class="string">&quot;图片文件 (*.png *.jpg *.jpeg *.bmp)&quot;</span>)).<span class="built_in">toStdString</span>();</span><br><span class="line">    <span class="keyword">if</span> (str == <span class="string">&quot;&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line">    send_image = <span class="built_in">imread</span>(str, CV_8UC1);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取图像大小</span></span><br><span class="line">    <span class="type">int32_t</span> i32_image_size = send_image.rows * send_image.cols;</span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;图像大小:&quot;</span>&lt;&lt;i32_image_size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置数据包大小</span></span><br><span class="line">    <span class="type">int</span> packetSize=ui-&gt;spb_data_pack_size-&gt;<span class="built_in">value</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//计算需要分割的数据包数量</span></span><br><span class="line">    <span class="type">int</span> numPackets =i32_image_size / packetSize;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  numPackets+=1;</span></span><br><span class="line">    <span class="keyword">if</span>(i32_image_size%packetSize&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        numPackets+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//分割图像数据并发送数据包</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= numPackets; i++) &#123;</span><br><span class="line">        <span class="type">int</span> offset = i * packetSize;</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">first_packet</span>(send_image.cols,send_image.rows,<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(send_image.data+offset),packetSize);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i&lt;numPackets)&#123;</span><br><span class="line">            <span class="built_in">data_packet</span>(i,<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(send_image.data+offset),packetSize);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i==numPackets)&#123;</span><br><span class="line">            <span class="built_in">tail_packet</span>(i,<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(send_image.data+offset),i32_image_size%packetSize==<span class="number">0</span>?packetSize:i32_image_size%packetSize);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//发送首包</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::first_packet</span><span class="params">(<span class="type">uint16_t</span> x,<span class="type">uint16_t</span> y,<span class="type">char</span> *data,<span class="type">int</span> data_len,<span class="type">int</span> board_num,<span class="type">int</span> camera_num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QByteArray pack_data;</span><br><span class="line">    pack_data.<span class="built_in">clear</span>();</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0x78</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0x90</span>+board_num);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0xBA</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(camera_num*<span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">    pack_data.<span class="built_in">append</span>((x&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((x&gt;&gt;<span class="number">0</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((y&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((y&gt;&gt;<span class="number">0</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">        pack_data.<span class="built_in">append</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    pack_data.<span class="built_in">append</span>(data,data_len);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    qint64 bytesSent=udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">16</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line">    <span class="keyword">if</span>(bytesSent==<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送失败&quot;</span>&lt;&lt;<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;pack_fail_cache;i++)&#123;<span class="built_in">qDebug</span>()&lt;&lt;__LINE__;&#125;</span><br><span class="line">        bytesSent=udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">16</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line">        <span class="keyword">if</span>(bytesSent==<span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送失败&quot;</span>&lt;&lt;<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(udpSocket-&gt;<span class="built_in">bytesToWrite</span>()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//阻塞等待直到数据完全发送</span></span><br><span class="line">        <span class="keyword">if</span>(!udpSocket-&gt;<span class="built_in">waitForBytesWritten</span>(<span class="number">3000</span>))&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送超时&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//中间包</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::data_packet</span><span class="params">(<span class="type">int</span> pack_num,<span class="type">char</span> *data,<span class="type">int</span> data_len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QByteArray pack_data;</span><br><span class="line">    pack_data.<span class="built_in">clear</span>();</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((pack_num&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((pack_num&gt;&gt;<span class="number">0</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line"></span><br><span class="line">    pack_data.<span class="built_in">append</span>(data,data_len);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    qint64 bytesSent=udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">4</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line">    <span class="keyword">if</span>(bytesSent==<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送失败&quot;</span>&lt;&lt;pack_num;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;pack_fail_cache;i++)&#123;<span class="built_in">qDebug</span>()&lt;&lt;__LINE__;&#125;</span><br><span class="line">        bytesSent=udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">4</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line">        <span class="keyword">if</span>(bytesSent==<span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送失败&quot;</span>&lt;&lt;<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(udpSocket-&gt;<span class="built_in">bytesToWrite</span>()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//阻塞等待直到数据完全发送</span></span><br><span class="line">        <span class="keyword">if</span>(!udpSocket-&gt;<span class="built_in">waitForBytesWritten</span>(<span class="number">30000</span>))&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送超时&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//尾包</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::tail_packet</span><span class="params">(<span class="type">int</span> pack_num,<span class="type">char</span> *data,<span class="type">int</span> data_len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//    qDebug()&lt;&lt;&quot;尾包长度:&quot;&lt;&lt;data_len;</span></span><br><span class="line">    QByteArray pack_data;</span><br><span class="line">    pack_data.<span class="built_in">clear</span>();</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((pack_num&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((pack_num&gt;&gt;<span class="number">0</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line"></span><br><span class="line">    pack_data.<span class="built_in">append</span>(data,data_len);</span><br><span class="line"></span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0xee</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0xee</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0xdd</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0xdd</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    qint64 bytesSent=udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">4</span>+<span class="number">4</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(bytesSent==<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送失败&quot;</span>&lt;&lt;pack_num;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;pack_fail_cache;i++)&#123;<span class="built_in">qDebug</span>()&lt;&lt;__LINE__;&#125;</span><br><span class="line">        udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">4</span>+<span class="number">4</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(udpSocket-&gt;<span class="built_in">bytesToWrite</span>()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//阻塞等待直到数据完全发送</span></span><br><span class="line">        <span class="keyword">if</span>(!udpSocket-&gt;<span class="built_in">waitForBytesWritten</span>(<span class="number">3000</span>))&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送超时&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="接收"><a href="#接收" class="headerlink" title="接收"></a>接收</h2><h3 id="接收编程"><a href="#接收编程" class="headerlink" title="接收编程"></a>接收编程</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h3 id="网卡配置接收"><a href="#网卡配置接收" class="headerlink" title="网卡配置接收"></a>网卡配置接收</h3><ol><li>网卡设置巨帧9K</li><li>发送缓存区设置最大2048</li><li>接收缓存区设置最大2048</li><li>关闭节能</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/12/19/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/UDP_%E4%BC%A0%E5%9B%BE%E8%AE%B0%E5%BD%95Demo/"/>
      <url>/2024/12/19/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/UDP_%E4%BC%A0%E5%9B%BE%E8%AE%B0%E5%BD%95Demo/</url>
      
        <content type="html"><![CDATA[<h1 id="UDP传图记录"><a href="#UDP传图记录" class="headerlink" title="UDP传图记录"></a>UDP传图记录</h1><h2 id="发送"><a href="#发送" class="headerlink" title="发送"></a>发送</h2><h3 id="编程"><a href="#编程" class="headerlink" title="编程"></a>编程</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QUdpSocket&gt;</span></span></span><br><span class="line">QUdpSocket *udpSocket;</span><br><span class="line"><span class="type">char</span> *read_image_data;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::send_image</span><span class="params">()</span><span class="comment">//发送图像</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::init_udp</span><span class="params">()</span></span>&#123;<span class="comment">//初始化udp</span></span><br><span class="line">udpSocket = <span class="keyword">new</span> <span class="built_in">QUdpSocket</span>(<span class="keyword">this</span>);</span><br><span class="line">udpSocket-&gt;<span class="built_in">bind</span>(QHostAddress::AnyIPv4, <span class="number">12345</span>);<span class="comment">//  //绑定IP地址和端口</span></span><br><span class="line">read_image_data = <span class="keyword">new</span> <span class="type">char</span>[<span class="number">9</span>*<span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line"><span class="built_in">connect</span>(udpSocket, &amp;QUdpSocket::readyRead, <span class="keyword">this</span>, &amp;MainWindow::read_image);</span><br><span class="line">    udpSocket-&gt;<span class="built_in">setReadBufferSize</span>(<span class="number">9</span>*<span class="number">1024</span>*<span class="number">1024</span>);<span class="comment">//UDP通信设置这个参数无效。默认使用系统参数</span></span><br><span class="line">    udpSocket-&gt;<span class="built_in">setSocketOption</span>(QAbstractSocket::ReceiveBufferSizeSocketOption,<span class="number">9</span>*<span class="number">1024</span>*<span class="number">1024</span>);</span><br><span class="line"></span><br><span class="line">    QSettings *configIni = <span class="keyword">new</span> <span class="built_in">QSettings</span>(fileName, QSettings::IniFormat);</span><br><span class="line"></span><br><span class="line">    pack_fail_cache=configIni-&gt;<span class="built_in">value</span>(<span class="string">&quot;pack_cach&quot;</span>).<span class="built_in">toString</span>()==<span class="string">&quot;&quot;</span>?<span class="number">10</span>:configIni-&gt;<span class="built_in">value</span>(<span class="string">&quot;pack_cach&quot;</span>).<span class="built_in">toUInt</span>();</span><br><span class="line"><span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;pack_fail_cache&quot;</span>&lt;&lt;pack_fail_cache;</span><br><span class="line">    configIni-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//发送图像</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::send_image</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Mat send_image;</span><br><span class="line"></span><br><span class="line">    String str = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>, <span class="built_in">tr</span>(<span class="string">&quot;选择图片&quot;</span>),</span><br><span class="line">                                              <span class="string">&quot;C:\\Users\\fengj\\OneDrive\\Samples&quot;</span>,</span><br><span class="line">                                              <span class="built_in">tr</span>(<span class="string">&quot;图片文件 (*.png *.jpg *.jpeg *.bmp)&quot;</span>)).<span class="built_in">toStdString</span>();</span><br><span class="line">    <span class="keyword">if</span> (str == <span class="string">&quot;&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line">    send_image = <span class="built_in">imread</span>(str, CV_8UC1);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取图像大小</span></span><br><span class="line">    <span class="type">int32_t</span> i32_image_size = send_image.rows * send_image.cols;</span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;图像大小:&quot;</span>&lt;&lt;i32_image_size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置数据包大小</span></span><br><span class="line">    <span class="type">int</span> packetSize=ui-&gt;spb_data_pack_size-&gt;<span class="built_in">value</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//计算需要分割的数据包数量</span></span><br><span class="line">    <span class="type">int</span> numPackets =i32_image_size / packetSize;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  numPackets+=1;</span></span><br><span class="line">    <span class="keyword">if</span>(i32_image_size%packetSize&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        numPackets+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//分割图像数据并发送数据包</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= numPackets; i++) &#123;</span><br><span class="line">        <span class="type">int</span> offset = i * packetSize;</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">first_packet</span>(send_image.cols,send_image.rows,<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(send_image.data+offset),packetSize);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i&lt;numPackets)&#123;</span><br><span class="line">            <span class="built_in">data_packet</span>(i,<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(send_image.data+offset),packetSize);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i==numPackets)&#123;</span><br><span class="line">            <span class="built_in">tail_packet</span>(i,<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(send_image.data+offset),i32_image_size%packetSize==<span class="number">0</span>?packetSize:i32_image_size%packetSize);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//发送首包</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::first_packet</span><span class="params">(<span class="type">uint16_t</span> x,<span class="type">uint16_t</span> y,<span class="type">char</span> *data,<span class="type">int</span> data_len,<span class="type">int</span> board_num,<span class="type">int</span> camera_num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QByteArray pack_data;</span><br><span class="line">    pack_data.<span class="built_in">clear</span>();</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0x78</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0x90</span>+board_num);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0xBA</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(camera_num*<span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">    pack_data.<span class="built_in">append</span>((x&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((x&gt;&gt;<span class="number">0</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((y&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((y&gt;&gt;<span class="number">0</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">        pack_data.<span class="built_in">append</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    pack_data.<span class="built_in">append</span>(data,data_len);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    qint64 bytesSent=udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">16</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line">    <span class="keyword">if</span>(bytesSent==<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送失败&quot;</span>&lt;&lt;<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;pack_fail_cache;i++)&#123;<span class="built_in">qDebug</span>()&lt;&lt;__LINE__;&#125;</span><br><span class="line">        bytesSent=udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">16</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line">        <span class="keyword">if</span>(bytesSent==<span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送失败&quot;</span>&lt;&lt;<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(udpSocket-&gt;<span class="built_in">bytesToWrite</span>()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//阻塞等待直到数据完全发送</span></span><br><span class="line">        <span class="keyword">if</span>(!udpSocket-&gt;<span class="built_in">waitForBytesWritten</span>(<span class="number">3000</span>))&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送超时&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//中间包</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::data_packet</span><span class="params">(<span class="type">int</span> pack_num,<span class="type">char</span> *data,<span class="type">int</span> data_len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QByteArray pack_data;</span><br><span class="line">    pack_data.<span class="built_in">clear</span>();</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((pack_num&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((pack_num&gt;&gt;<span class="number">0</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line"></span><br><span class="line">    pack_data.<span class="built_in">append</span>(data,data_len);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    qint64 bytesSent=udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">4</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line">    <span class="keyword">if</span>(bytesSent==<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送失败&quot;</span>&lt;&lt;pack_num;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;pack_fail_cache;i++)&#123;<span class="built_in">qDebug</span>()&lt;&lt;__LINE__;&#125;</span><br><span class="line">        bytesSent=udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">4</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line">        <span class="keyword">if</span>(bytesSent==<span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送失败&quot;</span>&lt;&lt;<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(udpSocket-&gt;<span class="built_in">bytesToWrite</span>()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//阻塞等待直到数据完全发送</span></span><br><span class="line">        <span class="keyword">if</span>(!udpSocket-&gt;<span class="built_in">waitForBytesWritten</span>(<span class="number">30000</span>))&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送超时&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//尾包</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::tail_packet</span><span class="params">(<span class="type">int</span> pack_num,<span class="type">char</span> *data,<span class="type">int</span> data_len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//    qDebug()&lt;&lt;&quot;尾包长度:&quot;&lt;&lt;data_len;</span></span><br><span class="line">    QByteArray pack_data;</span><br><span class="line">    pack_data.<span class="built_in">clear</span>();</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((pack_num&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>((pack_num&gt;&gt;<span class="number">0</span>)&amp;<span class="number">0xff</span>);</span><br><span class="line"></span><br><span class="line">    pack_data.<span class="built_in">append</span>(data,data_len);</span><br><span class="line"></span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0xee</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0xee</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0xdd</span>);</span><br><span class="line">    pack_data.<span class="built_in">append</span>(<span class="number">0xdd</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    qint64 bytesSent=udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">4</span>+<span class="number">4</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(bytesSent==<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送失败&quot;</span>&lt;&lt;pack_num;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;pack_fail_cache;i++)&#123;<span class="built_in">qDebug</span>()&lt;&lt;__LINE__;&#125;</span><br><span class="line">        udpSocket-&gt;<span class="built_in">writeDatagram</span>(pack_data.<span class="built_in">data</span>(), data_len+<span class="number">4</span>+<span class="number">4</span>, <span class="built_in">QHostAddress</span>(ui-&gt;lie_IP-&gt;<span class="built_in">text</span>()),<span class="number">12345</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(udpSocket-&gt;<span class="built_in">bytesToWrite</span>()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//阻塞等待直到数据完全发送</span></span><br><span class="line">        <span class="keyword">if</span>(!udpSocket-&gt;<span class="built_in">waitForBytesWritten</span>(<span class="number">3000</span>))&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;发送超时&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="接收"><a href="#接收" class="headerlink" title="接收"></a>接收</h2><h3 id="接收编程"><a href="#接收编程" class="headerlink" title="接收编程"></a>接收编程</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QUdpSocket&gt;</span></span></span><br><span class="line">QUdpSocket *udpSocket;</span><br><span class="line"><span class="type">char</span> *read_image_data;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::send_image</span><span class="params">()</span><span class="comment">//发送图像</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::init_udp</span><span class="params">()</span></span>&#123;<span class="comment">//初始化udp</span></span><br><span class="line">udpSocket = <span class="keyword">new</span> <span class="built_in">QUdpSocket</span>(<span class="keyword">this</span>);</span><br><span class="line">udpSocket-&gt;<span class="built_in">bind</span>(QHostAddress::AnyIPv4, <span class="number">12345</span>);<span class="comment">//  //绑定IP地址和端口</span></span><br><span class="line">read_image_data = <span class="keyword">new</span> <span class="type">char</span>[<span class="number">9</span>*<span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line"><span class="built_in">connect</span>(udpSocket, &amp;QUdpSocket::readyRead, <span class="keyword">this</span>, &amp;MainWindow::read_image);</span><br><span class="line">    udpSocket-&gt;<span class="built_in">setReadBufferSize</span>(<span class="number">9</span>*<span class="number">1024</span>*<span class="number">1024</span>);<span class="comment">//UDP通信设置这个参数无效。默认使用系统参数</span></span><br><span class="line">    udpSocket-&gt;<span class="built_in">setSocketOption</span>(QAbstractSocket::ReceiveBufferSizeSocketOption,<span class="number">9</span>*<span class="number">1024</span>*<span class="number">1024</span>);</span><br><span class="line"></span><br><span class="line">    QSettings *configIni = <span class="keyword">new</span> <span class="built_in">QSettings</span>(fileName, QSettings::IniFormat);</span><br><span class="line"></span><br><span class="line">    pack_fail_cache=configIni-&gt;<span class="built_in">value</span>(<span class="string">&quot;pack_cach&quot;</span>).<span class="built_in">toString</span>()==<span class="string">&quot;&quot;</span>?<span class="number">10</span>:configIni-&gt;<span class="built_in">value</span>(<span class="string">&quot;pack_cach&quot;</span>).<span class="built_in">toUInt</span>();</span><br><span class="line"><span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;pack_fail_cache&quot;</span>&lt;&lt;pack_fail_cache;</span><br><span class="line">    configIni-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::read_image</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// QDateTime local1(QDateTime::currentDateTime());</span></span><br><span class="line">    <span class="comment">// QString localTime1 = local1.toString(&quot;\r\n&lt;hh:mm:ss.zzz&gt;\r\n&quot;);</span></span><br><span class="line">    <span class="comment">// qDebug()&lt;&lt;localTime1;</span></span><br><span class="line">    <span class="type">static</span> QList&lt;qint32&gt; list_pack_num;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (udpSocket-&gt;<span class="built_in">hasPendingDatagrams</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// static int rec_i=0;</span></span><br><span class="line">        <span class="comment">// qDebug()&lt;&lt;&quot;接收:&quot;&lt;&lt;rec_i;</span></span><br><span class="line">        <span class="comment">// rec_i++;</span></span><br><span class="line">        QByteArray datagram;</span><br><span class="line">        datagram.<span class="built_in">resize</span>(udpSocket-&gt;<span class="built_in">pendingDatagramSize</span>());</span><br><span class="line">        udpSocket-&gt;<span class="built_in">readDatagram</span>(datagram.<span class="built_in">data</span>(), datagram.<span class="built_in">size</span>());</span><br><span class="line">        <span class="type">static</span> <span class="type">int16_t</span> x=<span class="number">0</span>,y=<span class="number">0</span>,pack_len=<span class="number">0</span>,datapack_num=<span class="number">0</span>,pix_format=<span class="number">0</span>,isEnd=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//分辨首包,中间包,尾包,并提取图像数据</span></span><br><span class="line">        <span class="type">char</span> *pdata=<span class="built_in">dataReconfig</span>(datagram,x,y,pack_len,datapack_num,isEnd,pix_format);</span><br><span class="line">        list_pack_num.<span class="built_in">append</span>(datapack_num);</span><br><span class="line">        <span class="comment">//将图像数据拷贝到图像内存中</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(isEnd!=<span class="number">0</span>)</span><br><span class="line">        <span class="built_in">memcpy</span>(read_image_data+datapack_num*pack_len,pdata,pack_len);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// qDebug()&lt;&lt;&quot;isEnd:&quot;&lt;&lt;isEnd;</span></span><br><span class="line">        <span class="keyword">if</span>(isEnd==<span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(isEnd==<span class="number">3</span>)&#123;</span><br><span class="line">            isEnd=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            ui-&gt;lb_rec_fail_pack_num-&gt;<span class="built_in">setText</span>(QString::<span class="built_in">number</span>(list_pack_num.<span class="built_in">size</span>()<span class="number">-1</span>-datapack_num));</span><br><span class="line">            list_pack_num.<span class="built_in">clear</span>();</span><br><span class="line">            cv::Mat img = Mat::<span class="built_in">zeros</span>(y, x, CV_8UC1);   <span class="comment">//1467</span></span><br><span class="line">            img.<span class="built_in">setTo</span>(cv::<span class="built_in">Scalar</span>(<span class="number">0</span>));</span><br><span class="line">            <span class="built_in">memcpy</span>(img.data,read_image_data,x* y);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">memset</span>(read_image_data, <span class="number">0</span>, x* y);</span><br><span class="line">            <span class="comment">// namedWindow( &quot;received&quot;, WINDOW_NORMAL );</span></span><br><span class="line">            <span class="comment">// cv::imshow(&quot;received&quot;,img);</span></span><br><span class="line">            <span class="comment">// cv::waitKey(1);</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">show_image_label</span>(img);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::show_image_label</span><span class="params">(Mat &amp;op_image)</span> </span>&#123;</span><br><span class="line">    QImage qImg =</span><br><span class="line">        <span class="built_in">QImage</span>((<span class="type">unsigned</span> <span class="type">char</span> *)(op_image.data), op_image.cols, op_image.rows,</span><br><span class="line">               op_image.cols * op_image.<span class="built_in">channels</span>(), QImage::Format_Grayscale8);</span><br><span class="line">    ui-&gt;lb_image_show-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(</span><br><span class="line">        qImg.<span class="built_in">scaled</span>(ui-&gt;lb_image_show-&gt;<span class="built_in">size</span>(), Qt::KeepAspectRatio)));</span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> QGraphicsScene *sence=<span class="keyword">new</span> QGraphicsScene;</span><br><span class="line"></span><br><span class="line">    ui-&gt;gV_image-&gt;<span class="built_in">setScene</span>(sence);</span><br><span class="line">    sence-&gt;<span class="built_in">clear</span>();</span><br><span class="line">    sence-&gt;<span class="built_in">addPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(qImg));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sence-&gt;deleteLater();</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">char</span> *<span class="title">MainWindow::dataReconfig</span><span class="params">(QByteArray&amp; data,<span class="type">int16_t</span> &amp;x,<span class="type">int16_t</span> &amp;y,<span class="type">int16_t</span> &amp;pack_len,<span class="type">int16_t</span> &amp;datapack_num,<span class="type">int16_t</span> &amp;isEnd,<span class="type">int16_t</span> &amp;pix_format)</span></span>&#123;</span><br><span class="line">    <span class="type">static</span> quint32 first_pack_time=<span class="number">0</span>;</span><br><span class="line">    <span class="type">static</span> quint32 end_pack_time=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(data.<span class="built_in">at</span>(<span class="number">0</span>)==<span class="number">0x78</span>&amp;&amp;(uchar)(data.<span class="built_in">at</span>(<span class="number">2</span>))==<span class="number">0xBA</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(data.<span class="built_in">size</span>()&lt;<span class="number">16</span>)&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;数据长度不足,无法提取x和y&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function">QDateTime <span class="title">local1</span><span class="params">(QDateTime::currentDateTime())</span></span>;</span><br><span class="line">        first_pack_time=local1.<span class="built_in">time</span>().<span class="built_in">msecsSinceStartOfDay</span>();;</span><br><span class="line">        x=((<span class="type">uint16_t</span>)(uchar)data[<span class="number">4</span>])&lt;&lt;<span class="number">8</span>|(<span class="type">uint16_t</span>)(uchar)data[<span class="number">5</span>];</span><br><span class="line">        y=(<span class="type">uint16_t</span>)(uchar)data[<span class="number">6</span>]&lt;&lt;<span class="number">8</span>|(<span class="type">uint16_t</span>)(uchar)data[<span class="number">7</span>];</span><br><span class="line"></span><br><span class="line">        pack_len=data.<span class="built_in">size</span>()<span class="number">-16</span>;</span><br><span class="line"></span><br><span class="line">        datapack_num=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// qDebug()&lt;&lt;&quot;首包&quot;;</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;X:&quot;</span>&lt;&lt;x;</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;y:&quot;</span>&lt;&lt;y;</span><br><span class="line">        <span class="comment">// qDebug()&lt;&lt;&quot;pack_len:&quot;&lt;&lt;pack_len;</span></span><br><span class="line">        <span class="comment">// qDebug()&lt;&lt;&quot;datapack_num:&quot;&lt;&lt;datapack_num;</span></span><br><span class="line"></span><br><span class="line">        isEnd=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> data.<span class="built_in">data</span>()+<span class="number">16</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(   (uchar)data.<span class="built_in">at</span>(data.<span class="built_in">size</span>()<span class="number">-4</span>)!=<span class="number">0xee</span>||</span><br><span class="line">               (uchar)data.<span class="built_in">at</span>(data.<span class="built_in">size</span>()<span class="number">-3</span>)!=<span class="number">0xee</span>||</span><br><span class="line">               (uchar)data.<span class="built_in">at</span>(data.<span class="built_in">size</span>()<span class="number">-2</span>)!=<span class="number">0xdd</span>||</span><br><span class="line">               (uchar)data.<span class="built_in">at</span>(data.<span class="built_in">size</span>()<span class="number">-1</span>)!=<span class="number">0xdd</span>)&#123;</span><br><span class="line"></span><br><span class="line">        datapack_num=((<span class="type">uint16_t</span>)(uchar)data.<span class="built_in">at</span>(<span class="number">2</span>))&lt;&lt;<span class="number">8</span>|(<span class="type">uint16_t</span>)(uchar)data.<span class="built_in">at</span>(<span class="number">3</span>);</span><br><span class="line">        <span class="comment">// datapack_num=0;</span></span><br><span class="line">        <span class="comment">// datapack_num=(uchar)data.at(2);</span></span><br><span class="line">        <span class="comment">// datapack_num=datapack_num&lt;&lt;8;</span></span><br><span class="line">        <span class="comment">// datapack_num|=(uchar)data.at(3);</span></span><br><span class="line"></span><br><span class="line">        pack_len=data.<span class="built_in">size</span>()<span class="number">-4</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// qDebug()&lt;&lt;&quot;pack_len:&quot;&lt;&lt;pack_len;</span></span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;pack_num:&quot;</span>&lt;&lt;datapack_num;</span><br><span class="line"></span><br><span class="line">        isEnd=<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> data.<span class="built_in">data</span>()+<span class="number">4</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(   (uchar)data.<span class="built_in">at</span>(data.<span class="built_in">size</span>()<span class="number">-4</span>)==<span class="number">0xee</span>&amp;&amp;</span><br><span class="line">               (uchar)data.<span class="built_in">at</span>(data.<span class="built_in">size</span>()<span class="number">-3</span>)==<span class="number">0xee</span>&amp;&amp;</span><br><span class="line">               (uchar)data.<span class="built_in">at</span>(data.<span class="built_in">size</span>()<span class="number">-2</span>)==<span class="number">0xdd</span>&amp;&amp;</span><br><span class="line">               (uchar)data.<span class="built_in">at</span>(data.<span class="built_in">size</span>()<span class="number">-1</span>)==<span class="number">0xdd</span>)&#123;</span><br><span class="line"></span><br><span class="line">        QDateTime <span class="built_in">local1</span>(QDateTime::<span class="built_in">currentDateTime</span>());</span><br><span class="line">        end_pack_time=local1.<span class="built_in">time</span>().<span class="built_in">msecsSinceStartOfDay</span>();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;传图时间:&quot;</span>&lt;&lt;end_pack_time-first_pack_time;</span><br><span class="line"></span><br><span class="line">        ui-&gt;lb_rectim-&gt;<span class="built_in">setText</span>(QString::<span class="built_in">number</span>(end_pack_time-first_pack_time));</span><br><span class="line">        datapack_num=((<span class="type">uint16_t</span>)(uchar)data.<span class="built_in">at</span>(<span class="number">2</span>))&lt;&lt;<span class="number">8</span>|(<span class="type">uint16_t</span>)(uchar)data.<span class="built_in">at</span>(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// datapack_num=0;</span></span><br><span class="line">        <span class="comment">// datapack_num=(uchar)data.at(2);</span></span><br><span class="line">        <span class="comment">// datapack_num=datapack_num&lt;&lt;8;</span></span><br><span class="line">        <span class="comment">// datapack_num|=(uchar)data.at(3);</span></span><br><span class="line"></span><br><span class="line">        pack_len=data.<span class="built_in">size</span>()<span class="number">-4</span><span class="number">-4</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// qDebug()&lt;&lt;&quot;尾包&quot;;</span></span><br><span class="line">        <span class="comment">// qDebug()&lt;&lt;&quot;pack_len:&quot;&lt;&lt;pack_len;</span></span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;datapack_num:&quot;</span>&lt;&lt;datapack_num;</span><br><span class="line">        isEnd=<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">return</span> data.<span class="built_in">data</span>()+<span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    isEnd=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;未识别的包&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="网卡配置接收"><a href="#网卡配置接收" class="headerlink" title="网卡配置接收"></a>网卡配置接收</h3><ol><li>网卡设置巨帧9K</li><li>发送缓存区设置最大2048</li><li>接收缓存区设置最大2048</li><li>关闭节能</li></ol><h3 id="软件使用说明"><a href="#软件使用说明" class="headerlink" title="软件使用说明"></a>软件使用说明</h3><ol><li>启动软件,即开始接收图像数据</li></ol><h4 id="修改端口号"><a href="#修改端口号" class="headerlink" title="修改端口号"></a>修改端口号</h4><p>软件根目录下有个参数管理文件夹,找到udp_demo.ini.在里面第一行插入添加端口号.修改端口号后,重启软件生效.如下:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ip_port</span>=<span class="number">12345</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="界面说明"><a href="#界面说明" class="headerlink" title="界面说明"></a>界面说明</h4><ol><li>图像显示区域:显示接收到的图像数据</li><li>图像显示区域右上角:显示图像传输时间</li><li>标题显示当前端口号</li><li>原图全图显示切换,原图显示会自动开启全屏,按图像实际大小显示,退出原图则还原</li><li>图像显示区域右上角:显示图像传输失败的包数量</li></ol><p><img src="/.com//UDP_%E4%BC%A0%E5%9B%BE%E8%AE%B0%E5%BD%95Demo/1734595416004.png" alt="1734595416004"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/12/09/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/%E5%BA%A6%E7%94%B3/"/>
      <url>/2024/12/09/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/%E5%BA%A6%E7%94%B3/</url>
      
        <content type="html"><![CDATA[<h1 id="度申相机"><a href="#度申相机" class="headerlink" title="度申相机"></a>度申相机</h1><p>[TOC]</p><h2 id="分时频闪"><a href="#分时频闪" class="headerlink" title="分时频闪"></a>分时频闪</h2><h3 id="一-功能简介"><a href="#一-功能简介" class="headerlink" title="一.功能简介"></a>一.功能简介</h3><pre><code>该功能用于线扫相机,每个行触发有效,执行一次分时曝光,每个分时曝光可以设置不同的曝光时间,独立的光源触发,以此获得一台相机拍出不同光源角度的图像.</code></pre><h3 id="二-分时曝光时序图"><a href="#二-分时曝光时序图" class="headerlink" title="二.分时曝光时序图"></a>二.分时曝光时序图</h3><p><img src="/.com//%E5%BA%A6%E7%94%B3/1733728604852.png" alt="1733728604852"></p><h3 id="三-行序列分离"><a href="#三-行序列分离" class="headerlink" title="三.行序列分离"></a>三.行序列分离</h3><p><img src="/.com//%E5%BA%A6%E7%94%B3/1733727397629.png" alt="1733727397629"></p><h3 id="四-分时拍照原图为按照分时曝光顺序拍出的图像"><a href="#四-分时拍照原图为按照分时曝光顺序拍出的图像" class="headerlink" title="四.分时拍照原图为按照分时曝光顺序拍出的图像"></a>四.分时拍照原图为按照分时曝光顺序拍出的图像</h3><p><img src="/.com//%E5%BA%A6%E7%94%B3/1733727480883.png" alt="1733727480883"></p><h3 id="五-开启行序列分离功能-则会将分时拍出的图像按顺序排列组合"><a href="#五-开启行序列分离功能-则会将分时拍出的图像按顺序排列组合" class="headerlink" title="五.开启行序列分离功能,则会将分时拍出的图像按顺序排列组合"></a>五.开启行序列分离功能,则会将分时拍出的图像按顺序排列组合</h3><p><img src="/.com//%E5%BA%A6%E7%94%B3/1733727552771.png" alt="1733727552771"></p><h3 id="六-设置分时曝光次数"><a href="#六-设置分时曝光次数" class="headerlink" title="六.设置分时曝光次数"></a>六.设置分时曝光次数</h3><ul><li>Disable为关闭多次曝光,MultiExp1为1次曝光,MultiExp2为2次曝光,MultiExp3为3次曝光,MultiExp4为4次曝光.这里我们选MultiExp2,即2次曝光.</li></ul><p><img src="/.com//%E5%BA%A6%E7%94%B3/1733728805286.png" alt="1733728805286"></p><h3 id="七-分时曝光控制光源设置"><a href="#七-分时曝光控制光源设置" class="headerlink" title="七.分时曝光控制光源设置"></a>七.分时曝光控制光源设置</h3><ul><li>数字IO控制器,IO线路选择输出IO,Line4,选择IO线路信号源SequenceStrobe1,为触发第一次分时曝光的光源控制引脚.</li><li>数字IO控制器,IO线路选择输出IO,Line5,选择IO线路信号源SequenceStrobe2,为触发第二次分时曝光的光源控制引脚.</li></ul><p><img src="/.com//%E5%BA%A6%E7%94%B3/1733729248402.png" alt="1733729248402"><br><img src="/.com//%E5%BA%A6%E7%94%B3/1733729219706.png" alt="1733729219706"></p><h3 id="八-案例"><a href="#八-案例" class="headerlink" title="八.案例"></a>八.案例</h3><p><strong>举例:<br>    1000编码器<br>    992图像高度<br>    2分时</strong></p><ul><li>设置图像高度为1984,获得一张高度为1984的图像,其中0-991为1分时拍出的照片,992-1983为2分时拍出的照片.如下图所示:<br><img src="/.com//%E5%BA%A6%E7%94%B3/1733728075105.png" alt="1733728075105"><br><img src="/.com//%E5%BA%A6%E7%94%B3/1733727230564.png" alt="1733727230564"></li><li>若设置的图像高度为992,则只会拍出产品的一半.即0-495为1分时拍出的照片,496-991为2分时拍出的照片.如下图所示:<br><img src="/.com//%E5%BA%A6%E7%94%B3/1733728100320.png" alt="1733728100320"><br><img src="/.com//%E5%BA%A6%E7%94%B3/1733727194355.png" alt="1733727194355"></li></ul><h3 id="九-其它"><a href="#九-其它" class="headerlink" title="九.其它"></a>九.其它</h3><ul><li>分时1控制的光源如果熄灭速度不够快,则可能会影响到分时2的曝光拍照.可以增加分时2的曝光延时时间,以待分时1控制的光源完全熄灭.<br><img src="/.com//%E5%BA%A6%E7%94%B3/1733727761430.png" alt="1733727761430"></li><li>关于频闪节拍:可以使用相机多次曝光闪光灯自动跟随功能(即闪灯时长随曝光时间变化),也可以自己设置频闪节拍</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/12/04/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/GiGE/"/>
      <url>/2024/12/04/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/GiGE/</url>
      
        <content type="html"><![CDATA[<h1 id="GigE-Vision协议解析和实现"><a href="#GigE-Vision协议解析和实现" class="headerlink" title="GigE Vision协议解析和实现"></a>GigE Vision协议解析和实现</h1><h2 id="一、-GigE-Vision-协议概要"><a href="#一、-GigE-Vision-协议概要" class="headerlink" title="一、 GigE Vision 协议概要"></a>一、 GigE Vision 协议概要</h2><pre><code>GigE Vision协议，主要用于相机的控制和传输。它基于以太网[UDP](https://so.csdn.net/so/search?q=UDP&amp;spm=1001.2101.3001.7020)协议，提供了一种统一的控制和传输图像的方式。GigE Vision的手册可以从官网或以下网址获取：http://heng.com:3030/Download/norm/GigE-Vision-Specification_2-2-00.pdf</code></pre><h2 id="二、GigE-Vision协议的核心协议解析"><a href="#二、GigE-Vision协议的核心协议解析" class="headerlink" title="二、GigE Vision协议的核心协议解析"></a>二、GigE Vision协议的核心协议解析</h2><pre><code>本文仅参考GigE Vision协议的核心部分协议，包括发现设备、GVCP寄存器配置、GVSP流解析。设备的GVCP端口固定为3956.主机GVSP端口号由主机通过GVCP下发给设备.</code></pre><p>2.1发现设备<br>        在指令发现设备之前，要求PC机和设备处于同一个IP网段下。更改PC机IP地址，与设备IP地址一致。</p><p>2.1.1 发现设备命令<br>        在设备与主机处于同一网段的基础上，当设备与主机连接后，主机会发送设备发现指令（存在于UDP协议的有效数据字段中，后续所有的GVCP或者GVSP数据均存在于UDP协议的有效字段中）</p><p>例:42 11 00 02 00 00 00 01</p><table><thead><tr><th>名称</th><th>长度</th><th>数值</th><th>备注</th></tr></thead><tbody><tr><td>帧头</td><td>1字节</td><td>0x42</td><td>固定值</td></tr><tr><td>Flag</td><td>1字节</td><td>0x11</td><td>表示广播应答</td></tr><tr><td>COMMAND</td><td>2字节</td><td>0x0002</td><td>发现设备命令</td></tr><tr><td>LENGTH</td><td>2字节</td><td>0x0000</td><td>req_id后无数据，因此数值为0</td></tr><tr><td>req_id</td><td>2字节</td><td>&#x2F;</td><td>每发送一包命令，该数值加1。取值不能为0</td></tr></tbody></table><h3 id="2-1-2发现设备应答"><a href="#2-1-2发现设备应答" class="headerlink" title="2.1.2发现设备应答"></a>2.1.2发现设备应答</h3><p>设备解析到设备发现指令，则会返回设备发现应答。(demo只需回复前8个字节内容即可))协议格式如下：</p><table><thead><tr><th>名称</th><th>长度</th><th>数值</th><th>备注</th></tr></thead><tbody><tr><td>status</td><td>2字节</td><td>0x0000</td><td>0x0000表示命令指令成功，其他数值表示存在错误</td></tr><tr><td>ack</td><td>2字节</td><td>0x0003</td><td>发现设备的应答指示字</td></tr><tr><td>length</td><td>2字节</td><td>&#x2F;</td><td>返回的数据长度</td></tr><tr><td>ack_id</td><td>2字节</td><td>&#x2F;</td><td>与对应的req_id取值相同，表示为哪一个命令的应答</td></tr><tr><td>Spec_version_major</td><td>2字节</td><td>&#x2F;</td><td>设备支持的规范版本，大版本号</td></tr><tr><td>Spec_version_minor</td><td>2字节</td><td>&#x2F;</td><td>设备支持的规范版本，小版本号</td></tr><tr><td>Device_mode</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>Reserved</td><td>2字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>MAC地址</td><td>2字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>MAC地址</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>IP_config_options</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>IP_config_current</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>Reserved</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>Reserved</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>Reserved</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>设备当前IP地址</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>Reserved</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>Reserved</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>Reserved</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>设备当前子网掩码</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>Reserved</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>Reserved</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>Reserved</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>设备默认网关</td><td>4字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>制造商名称</td><td>32字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>模型名称</td><td>32字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>设备版本</td><td>32字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>制造商特定信息</td><td>48字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>串号</td><td>16字节</td><td>&#x2F;</td><td>&#x2F;</td></tr><tr><td>用户定义名称</td><td>16字节</td><td>&#x2F;</td><td>&#x2F;</td></tr></tbody></table><p>设备发现应答中，主要是提供了设备当前的一些状态，主机应用可以根据需要选取信息进行使用。一般判断前8个字节，即可判断设备发现是否成功。</p><p>2.2  GVCP寄存器配置<br>2.2.1 心跳计数清零<br>        主机应用需要定时清零设备的心跳计数器，用以保持主机应用与设备的连接。一般使用READREG命令读取CCP寄存器来实现此功能。</p><pre><code>主机应用定时发送READREG命令读取CCP寄存器，设备接收到此命令后，会清零心跳计数器，保持设备与主机应用的连接。同时设备会返回应答，以此通知主机应用目前连接处于保持状态。读CCP寄存器的命令格式如下：</code></pre><table><thead><tr><th>名称</th><th>长度</th><th>数值</th><th>备注</th></tr></thead><tbody><tr><td>帧头</td><td>1字节</td><td>0x42</td><td>固定值</td></tr><tr><td>Flag</td><td>1字节</td><td>0x01</td><td>表示设备需要返回应答</td></tr><tr><td>COMMAND</td><td>2字节</td><td>0x0080</td><td>READREG命令</td></tr><tr><td>LENGTH</td><td>2字节</td><td>0x0004</td><td>地址字段的字节长度</td></tr><tr><td>req_id</td><td>2字节</td><td>&#x2F;</td><td>每发送一包命令，该数值加1。取值不能为0</td></tr><tr><td>第一个地址</td><td>4字节</td><td>0x0000_0A00</td><td>CCP寄存器的地址</td></tr></tbody></table><p>设备返回正常的应答格式如下：</p><table><thead><tr><th>名称</th><th>长度</th><th>数值</th><th>备注</th></tr></thead><tbody><tr><td>status</td><td>2字节</td><td>0x0000</td><td>正常应答</td></tr><tr><td>ack</td><td>2字节</td><td>0x0081</td><td>READREG_ACK</td></tr><tr><td>LENGTH</td><td>2字节</td><td>0x0004</td><td>地址字段的字节长度</td></tr><tr><td>ack_id</td><td>2字节</td><td>&#x2F;</td><td>与req_id相同</td></tr><tr><td>第一个寄存器的数据</td><td>4字节</td><td>&#x2F;</td><td>读取的CCP寄存器的数据</td></tr></tbody></table><p>当需要读取其他寄存器是，也是按照此协议格式读取即可。</p><h4 id="2-2-2-正常的寄存器配置WRITEREG"><a href="#2-2-2-正常的寄存器配置WRITEREG" class="headerlink" title="2.2.2 正常的寄存器配置WRITEREG"></a>2.2.2 正常的寄存器配置WRITEREG</h4><pre><code>主机应用配置设备的寄存器，使用WRITEREG命令，先描述一下WRITEREG命令的解析。以下以GVCPconfiguration寄存器的配置为例（其他寄存器的地址和数值，请参考GigE的协议手册）。</code></pre><table><thead><tr><th>名称</th><th>长度</th><th>数值</th><th>备注</th></tr></thead><tbody><tr><td>帧头</td><td>1字节</td><td>0x42</td><td>固定值</td></tr><tr><td>Flag</td><td>1字节</td><td>0x01</td><td>表示设备需要返回应答</td></tr><tr><td>COMMAND</td><td>2字节</td><td>0x0082</td><td>WRITEREG命令</td></tr><tr><td>LENGTH</td><td>2字节</td><td>0x0008</td><td>地址字段和数据字段的字节长度</td></tr><tr><td>req_id</td><td>2字节</td><td>&#x2F;</td><td>每发送一包命令，该数值加1。取值不能为0</td></tr><tr><td>第一个地址</td><td>4字节</td><td>0x0000_0A00</td><td>GVCP configuration寄存器的地址</td></tr><tr><td>第一个数据</td><td>4字节</td><td>0x0004_0006</td><td>使能扩展码状态，使能pending_ACK</td></tr></tbody></table><p>设备收到此配置信息后，需要返回给主机应用一个应答包。格式如下：</p><table><thead><tr><th>名称</th><th>长度</th><th>数值</th><th>备注</th></tr></thead><tbody><tr><td>status</td><td>2字节</td><td>0x0000</td><td>正常应答</td></tr><tr><td>ack</td><td>2字节</td><td>0x0083</td><td>WRITEREG_ACK</td></tr><tr><td>LENGTH</td><td>2字节</td><td>0x0004</td><td>地址字段的字节长度</td></tr><tr><td>ack_id</td><td>2字节</td><td>&#x2F;</td><td>与req_id相同</td></tr><tr><td>reserved</td><td>2字节</td><td>0x0000</td><td>&#x2F;</td></tr><tr><td>index</td><td>2字节</td><td>0x0001</td><td>返回正确配置的寄存器的数量</td></tr></tbody></table><h4 id="2-2-3-设备连接"><a href="#2-2-3-设备连接" class="headerlink" title="2.2.3 设备连接"></a>2.2.3 设备连接</h4><pre><code>主机连接设备，按照如下的顺序配置相关寄存器。根据不同应用，可以进行不同的配置顺序和寄存器数值。这里需要注意的是，设备的GVCP端口固定为3956，主机访问端口3956实现对GVCP寄存器的配置。</code></pre><table><thead><tr><th>执行序号</th><th>寄存器名称</th><th>寄存器地址</th><th>寄存器数值</th><th>描述</th></tr></thead><tbody><tr><td>1</td><td>CCP寄存器</td><td>0x0000_0A00</td><td>0x0000_0002</td><td>配置设备为控制访问模式，秘钥为0</td></tr><tr><td>2</td><td>GVCP_CONFIG</td><td>0x0000_0954</td><td>0x0004_0006</td><td>使能扩展状态码，使能PENDING_ACK</td></tr><tr><td>3</td><td>GVSP_CONFIG</td><td>0x0000_0960</td><td>0x4000_0000</td><td>使能GVSP block_id64</td></tr><tr><td>4</td><td>SCCFG0</td><td>0x00000D24</td><td>0x00000020</td><td>禁能multi-part，使能GVSP包大小由SCPSx决定</td></tr><tr><td>5</td><td>SCDA0</td><td>0x00000D18</td><td>0xC0A80180</td><td>配置相机的目标IP地址为192.168.1.128</td></tr><tr><td>6</td><td>SCP0</td><td>0x0000_0D00</td><td>0x0000_C350</td><td>GVSP数据流的目标端口50000</td></tr><tr><td>7</td><td>SCPS0</td><td>0x00000D04</td><td>0x40001030</td><td>数据包是4144字节，不分片，禁能test_packet</td></tr><tr><td>8</td><td>其他可能需要配置的寄存器</td><td>&#x2F;</td><td>&#x2F;</td><td>&#x2F;</td></tr></tbody></table><p>2.2.4 启动相机采集<br>        相机启动采集命令，需要配置3个寄存器。其中配置SCDA0和SCP0的目的是，打开流通道。</p><table><thead><tr><th>配置顺序</th><th>寄存器名称</th><th>获取方式</th><th>寄存器地址</th><th>寄存器数值</th><th>描述</th></tr></thead><tbody><tr><td>1</td><td>SCDA0</td><td>GigE定义</td><td>0x00000D18</td><td>0xC0A80180</td><td>配置相机的目标IP地址为192.168.1.128</td></tr><tr><td>2</td><td>SCP0</td><td>GigE定义</td><td>0x0000_0D00</td><td>0x0000_C350</td><td>GVSP数据流的目标端口50000</td></tr><tr><td>3</td><td>启动采集寄存器</td><td></td><td>&#x2F;</td><td>&#x2F;</td><td>获取具体的寄存器地址和数值，启动图像采集</td></tr></tbody></table><h4 id="2-2-5停止相机采集"><a href="#2-2-5停止相机采集" class="headerlink" title="2.2.5停止相机采集"></a>2.2.5停止相机采集</h4><pre><code>相机停止采集指令，同样需要配置3个寄存器。其中配置SCDA0和SCP0的目的是，关闭流通道。</code></pre><table><thead><tr><th><strong>配置顺序</strong></th><th><strong>寄存器名称</strong></th><th><strong>获取方式</strong></th><th><strong>寄存器地址</strong></th><th><strong>寄存器数值</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>1</td><td>SCDA0</td><td>GigE定义</td><td>0x00000D18</td><td>0x00000000</td><td>配置相机的目标IP地址为0.0.0.0</td></tr><tr><td>2</td><td>SCP0</td><td>GigE定义</td><td>0x0000_0D00</td><td>0x0000_C350</td><td>GVSP数据流的目标端口0</td></tr><tr><td>3</td><td>启动采集寄存器</td><td></td><td>&#x2F;</td><td>&#x2F;</td><td>获取具体的寄存器地址和数值，停止图像采集</td></tr></tbody></table><h3 id="2-3-GVSP数据流的解析"><a href="#2-3-GVSP数据流的解析" class="headerlink" title="2.3 GVSP数据流的解析"></a>2.3 GVSP数据流的解析</h3><pre><code>在启动相机发送图像后，相机设备需要发送GVSP数据流，上位机[软件](https://marketing.csdn.net/p/3127db09a98e0723b83b2914d9256174?pId=2782&amp;utm_source=glcblog&amp;spm=1001.2101.3001.7020)需要对GVSP数据流进行接收和解析。GVSP数据流，有三种类型的数据：leader包，**payload**包和尾包。</code></pre><h4 id="2-3-1-leader包"><a href="#2-3-1-leader包" class="headerlink" title="2.3.1 leader包"></a>2.3.1 leader包</h4><table><thead><tr><th><strong>名称</strong></th><th><strong>长度</strong></th><th><strong>数值</strong></th><th><strong>备注</strong></th></tr></thead><tbody><tr><td>status</td><td>2字节</td><td>&#x2F;</td><td>正常时，数值为0x0000</td></tr><tr><td>block_id&#x2F;flag</td><td>2字节</td><td>&#x2F;</td><td>根据GVCP控制，来确认此时是block_id还是flag。</td></tr><tr><td>EI &amp; reserved &amp; packet_format</td><td>1字节</td><td>0x81</td><td>block_id64数据包。前导包。</td></tr><tr><td>Packet_id&#x2F;reserved</td><td>3字节</td><td>&#x2F;</td><td>根据GVCP控制，来确认此时是Packet_id还是reserved</td></tr><tr><td>Block_id64 highpart</td><td>4字节</td><td>累加</td><td>块ID，不能为0（0位测试数据），每发送一帧图像，累加1。</td></tr><tr><td>Block_id64 lowpart</td><td>4字节</td><td>累加</td><td>块ID，不能为0（0位测试数据），每发送一帧图像，累加1。</td></tr><tr><td>Packet_id32</td><td>4字节</td><td>累加</td><td>包ID，从0开始累加，前导包为0</td></tr><tr><td>field_id</td><td>0.5字节</td><td>&#x2F;</td><td>用于隔行扫描模式。逐行扫描，永远为0</td></tr><tr><td>field_count</td><td>0.5字节</td><td>&#x2F;</td><td>用于隔行扫描模式。逐行扫描，永远为0</td></tr><tr><td>reserved</td><td>1字节</td><td>0x00</td><td></td></tr><tr><td>payload_type</td><td>2字节</td><td>&#x2F;</td><td>表明payload包的类型：0x0001表示未压缩的图像数据</td></tr><tr><td>时间戳 highpart</td><td>4字节</td><td>&#x2F;</td><td></td></tr><tr><td>时间戳 lowpart</td><td>4字节</td><td>&#x2F;</td><td></td></tr><tr><td>像素格式</td><td>4字节</td><td>&#x2F;</td><td>指示像素的位宽和元素数目。0x01080001表示8UC1</td></tr><tr><td>size_x</td><td>4字节</td><td>&#x2F;</td><td>payload中传输图像的宽度</td></tr><tr><td>size_y</td><td>4字节</td><td>&#x2F;</td><td>payload中传输图像的高度</td></tr><tr><td>offeset_x</td><td>4字节</td><td>&#x2F;</td><td>ROI区域X方向的偏移</td></tr><tr><td>offeset_y</td><td>4字节</td><td>&#x2F;</td><td>ROI区域Y方向的偏移</td></tr><tr><td>padding_x</td><td>2字节</td><td>&#x2F;</td><td>每行末尾的字节填充数，用于图像对齐。类似于水平消隐</td></tr><tr><td>padding_y</td><td>2字节</td><td>&#x2F;</td><td>图像末尾的字节填充数，用于图像对齐。类似于垂直消隐。</td></tr></tbody></table><p>上表中，注意的是，如果上位机通过GVCP将数据传输方式配置为Block_id和packet_id的模式，那么block_id64和packet_id32应该为0。反之，如果GVCP将数据传输方式配置为Block_id64和packet_id32的模式，那么block_id和packet_id应该为0。</p><h4 id="2-3-2-payload包"><a href="#2-3-2-payload包" class="headerlink" title="2.3.2 payload包"></a>2.3.2 payload包</h4><pre><code>相机发送完leader包后，紧接着应该发送payload包，payload包的数据格式 如下：</code></pre><table><thead><tr><th><strong>名称</strong></th><th><strong>长度</strong></th><th><strong>数值</strong></th><th><strong>备注</strong></th></tr></thead><tbody><tr><td>status</td><td>2字节</td><td>&#x2F;</td><td>正常时，数值为0x0000</td></tr><tr><td>block_id&#x2F;flag</td><td>2字节</td><td>&#x2F;</td><td>此处应为flag，正常情况下为0x0000。</td></tr><tr><td>EI &amp; reserved &amp; packet_format</td><td>1字节</td><td>0x83</td><td>block_id64数据包。通用数据负载格式。</td></tr><tr><td>Packet_id&#x2F;reserved</td><td>3字节</td><td>&#x2F;</td><td>包ID，因采用block_id64，此处为保留位</td></tr><tr><td>Block_id64 highpart</td><td>4字节</td><td>累加</td><td>块ID，不能为0（0位测试数据），每发送一帧图像，累加1。</td></tr><tr><td>Block_id64 lowpart</td><td>4字节</td><td>累加</td><td>块ID，不能为0（0位测试数据），每发送一帧图像，累加1。</td></tr><tr><td>Packet_id32</td><td>4字节</td><td>累加</td><td>包ID，从0开始累加，前导包为0，有效数据包累加</td></tr><tr><td>data</td><td>&#x2F;</td><td>&#x2F;</td><td>GVCP中指定大小的图像数据。小端字节模式</td></tr></tbody></table><p>假设GVCP协议配置中，配置一包payload包中发送A字节的数据。则为了发送完整幅图像的有效数据，则可能分成N包payload包进行发送。</p><pre><code>注意，除了最后一包之外，其余所有的payload数据包应该为A字节数据。</code></pre><h4 id="2-3-3-trailer包"><a href="#2-3-3-trailer包" class="headerlink" title="2.3.3 trailer包"></a>2.3.3 trailer包</h4><pre><code>发送完所有的payload数据包后，将发送trailer数据包，完成一整幅图像的发送。trailer包的格式如下：</code></pre><table><thead><tr><th>名称</th><th>长度</th><th>数值</th><th>备注</th></tr></thead><tbody><tr><td>status</td><td>2字节</td><td>&#x2F;</td><td>正常时，数值为0x0000</td></tr><tr><td>block_id&#x2F;flag</td><td>2字节</td><td>&#x2F;</td><td>此处应为flag，正常情况下为0x0000。</td></tr><tr><td>EI &amp; reserved &amp; packet_format</td><td>1字节</td><td>0x82</td><td>block_id64数据包。尾数据包。</td></tr><tr><td>Packet_id&#x2F;reserved</td><td>3字节</td><td>&#x2F;</td><td>包ID，因采用block_id64，此处为保留位</td></tr><tr><td>Block_id64 highpart</td><td>4字节</td><td>&#x2F;</td><td>块ID，不能为0（0为测试数据块），每发送一帧图像，累加1。</td></tr><tr><td>Block_id64 lowpart</td><td>4字节</td><td>&#x2F;</td><td>块ID，不能为0（0为测试数据块），每发送一帧图像，累加1。</td></tr><tr><td>Packet_id32</td><td>4字节</td><td>&#x2F;</td><td>包ID，从0开始累加，前导包为0，有效数据包累加</td></tr><tr><td>Reserved</td><td>2字节</td><td>&#x2F;</td><td>保留</td></tr><tr><td>Payload_type</td><td>2字节</td><td>&#x2F;</td><td>表明payload包的类型：0x0001表示未压缩的图像数据</td></tr><tr><td>Size_y</td><td>4字节</td><td>&#x2F;</td><td>指示图像的实际高度，即有时候图像高度可变</td></tr></tbody></table><h2 id="三、FPGA实现"><a href="#三、FPGA实现" class="headerlink" title="三、FPGA实现"></a>三、FPGA实现</h2><pre><code>使用FPGA分别实现了gige发送器和gige接收器，实现较为粗糙。gige发送器（相机），实现了数量较少的GVCP配置，实现了未压缩图像数据的发送，gige接收器（上位机），实现了指定相机的图像数据接收（提前规定好各个功能的寄存器地址和数值，在FPGA代码中固定配置）。</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HID_EIP</title>
      <link href="/2024/11/20/%E7%BB%BC%E5%90%88/HID_EIP/"/>
      <url>/2024/11/20/%E7%BB%BC%E5%90%88/HID_EIP/</url>
      
        <content type="html"><![CDATA[<h1 id="HID-EIP"><a href="#HID-EIP" class="headerlink" title="HID_EIP"></a>HID_EIP</h1><h2 id="设计步骤"><a href="#设计步骤" class="headerlink" title="设计步骤"></a>设计步骤</h2><ol><li>创建modbusserver服务器</li><li>创建数据容器存储数据,QHash&lt;QString,QString&gt;</li><li>创建1s定时器,用于心跳反转</li><li></li></ol>]]></content>
      
      
      <categories>
          
          <category> uncategorized </category>
          
      </categories>
      
      
        <tags>
            
            <tag> untagged </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>山克UPS使用步骤</title>
      <link href="/2024/09/23/%E7%BB%BC%E5%90%88/%E5%B1%B1%E5%85%8BUPS%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4/"/>
      <url>/2024/09/23/%E7%BB%BC%E5%90%88/%E5%B1%B1%E5%85%8BUPS%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="山克UPS低电自动关机功能测试"><a href="#山克UPS低电自动关机功能测试" class="headerlink" title="山克UPS低电自动关机功能测试"></a>山克UPS低电自动关机功能测试</h1><ul><li>先设置来电自启动,再安装viewpower</li><li>确保先开UPS再开工控机</li><li>确保使用期间,不要断开232连接(否则需要重启工控机)</li></ul><h2 id="设置来电自动启动UPS"><a href="#设置来电自动启动UPS" class="headerlink" title="设置来电自动启动UPS"></a>设置来电自动启动UPS</h2><ol><li>连接232线</li><li>打开串口调试助手<img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727078851555.png" alt="1727078851555"></li><li>选择正确的串口,波特率选择2400,消息发送框输入”PEM+回车键”,点击手动发送.返回内容”(NAK”或”(ACK”,即UPS接收到参数.需等待1分钟(不可断电),自动保存参数.否则可能会参数保存失败.<br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727079175051.png" alt="1727079175051"></li></ol><h2 id="设置断电自动关闭工控机"><a href="#设置断电自动关闭工控机" class="headerlink" title="设置断电自动关闭工控机"></a>设置断电自动关闭工控机</h2><ol><li>安装ViewPower软件,双击ViewPower_win32,安装向导点击next,选择安装目录,创建图标,安装完成后会自动设置为启动项,重启工控机.<br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727080228614.png" alt="1727080228614"><br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727080391403.png" alt="1727080391403"><br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727080426939.png" alt="1727080426939"><br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727080470258.png" alt="1727080470258"><br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727080529205.png" alt="1727080529205"></li><li>启动ViewPower软件,右键单击任务栏小图标ViewPower Monitor System,点击Open Monitor<br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727080550974.png" alt="1727080550974"><br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727080589562.png" alt="1727080589562"></li><li>会弹出浏览器页面,显示UPS相关信息<br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727080652044.png" alt="1727080652044"></li><li>设置关机参数<ol><li>电量低于80%,负载关机同时UPS关机.</li><li>UPS电池供电(电池模式)至电池低电位关机,自动关闭UPS</li><li>关机方式:关机</li><li>关闭系统所需时间:5分钟</li><li>点击应用,弹出设置成功.<br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727080726173.png" alt="1727080726173"><br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727081015080.png" alt="1727081015080"><br><img src="/.com//%E5%B1%B1%E5%85%8BUPS/1727081160517.png" alt="1727081160517"></li></ol></li></ol><h2 id="关闭串口扫描"><a href="#关闭串口扫描" class="headerlink" title="关闭串口扫描"></a>关闭串口扫描</h2><ol><li>菜单栏-&gt;控制台-&gt;串口扫描(Select ViewPower configuration&gt;&gt;Com. port plug and play setting. Refer to).关闭串口扫描.输入密码.<br><img src="/.com//%E5%B1%B1%E5%85%8BUPS%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4/1729480092171.png" alt="1729480092171"></li><li>密码<ol><li>用户名:Administrator</li><li>密码administrator<br><img src="/.com//%E5%B1%B1%E5%85%8BUPS%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4/1729480157348.png" alt="1729480157348"></li></ol></li></ol><h2 id="常见问题及解决办法"><a href="#常见问题及解决办法" class="headerlink" title="常见问题及解决办法"></a>常见问题及解决办法</h2><ol><li>设置来电自动启动失败<ol><li>卸载ViewPower后重新使用串口助手发送</li><li>使用另一台电脑(没有安装ViewPower的)使用串口助手发送消息</li></ol></li><li>打开检测软件提示串口占用<ol><li>服务页面禁止串口扫描即可</li></ol></li><li>浏览器页面无法打开<ol><li>没有连接UPS,需要使用USB或者串口线连接UPS</li></ol></li></ol>]]></content>
      
      
      <categories>
          
          <category> uncategorized </category>
          
      </categories>
      
      
        <tags>
            
            <tag> untagged </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>山克UPS</title>
      <link href="/2024/09/23/%E7%BB%BC%E5%90%88/%E5%B1%B1%E5%85%8BUPS%E6%B5%8B%E8%AF%95%E8%AE%B0%E5%BD%95/"/>
      <url>/2024/09/23/%E7%BB%BC%E5%90%88/%E5%B1%B1%E5%85%8BUPS%E6%B5%8B%E8%AF%95%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="山克UPS"><a href="#山克UPS" class="headerlink" title="山克UPS"></a>山克UPS</h1><p>低于设置电量后,不连接市电,启动失败.</p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="自动关工控机"><a href="#自动关工控机" class="headerlink" title="自动关工控机"></a>自动关工控机</h3><ol><li>连接232线</li><li>先启动UPS,再启动工控机.不启动viewpower(仅自启,管理员启动要点是),测试结果:正常,工控机先关机,随后UPS关机<ol><li>会自动搜索串口,打开viewpower,可以监控到数据</li></ol></li><li>先启动工控机,再启动UPS,测试结果:不会给工控机关机<ol><li>UPS监控服务,会在后台搜索串口,要很久才会搜索到(测试中可以观察到正在搜索串口,但等了很久也没等到服务程序搜索到串口)</li></ol></li></ol><h3 id="设置来电自动启动"><a href="#设置来电自动启动" class="headerlink" title="设置来电自动启动"></a>设置来电自动启动</h3><ol><li>默认为来电自动启动</li><li>开启或关闭来电自动启动.打开串口设置工具,发送数据内容即可.串口返回”(ACK”,即发送完成.需等待1分钟,自动保存参数.否则可能会参数保存失败.</li></ol><table><thead><tr><th>编号</th><th>命令</th><th>功能</th></tr></thead><tbody><tr><td>1</td><td>PEM</td><td>开启来电自动启动</td></tr><tr><td>2</td><td>PDM</td><td>关闭来电自动启动</td></tr><tr><td>3</td><td>PEO</td><td>开启旁路模式</td></tr><tr><td>4</td><td>PDO</td><td>关闭旁路模式</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> uncategorized </category>
          
      </categories>
      
      
        <tags>
            
            <tag> untagged </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一体机设计方案</title>
      <link href="/2024/08/22/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E4%B8%80%E4%BD%93%E6%9C%BA/%E4%B8%80%E4%BD%93%E6%9C%BA%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/"/>
      <url>/2024/08/22/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E4%B8%80%E4%BD%93%E6%9C%BA/%E4%B8%80%E4%BD%93%E6%9C%BA%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h1 id="一体机设计方案"><a href="#一体机设计方案" class="headerlink" title="一体机设计方案"></a>一体机设计方案</h1><h2 id="设计与改进思路"><a href="#设计与改进思路" class="headerlink" title="设计与改进思路"></a>设计与改进思路</h2><p>一个光电,不限光电到相机的距离,不限间隔,</p><p>光电工位ID初始化为0,每个光电信号+1,光电有效后置位位置结构体内的脉冲计数</p><p>面阵 脉冲计数&#x3D;&#x3D;踢废间隔-拍照相位时进行拍照,同时将该工位ID(就是结构体数组的索引)赋值给图像结果ID.</p><p>线扫 则为脉冲计数&#x3D;&#x3D;踢废间隔-拍照相位-图像高度时将工位ID赋值给图像结果ID</p><p>若接收到缺陷消息,则在图像结果ID的结构体数组里置位踢废标记</p><p>结构体的脉冲计数递减到0时,检查是否需要踢废</p><p>光源IO,光源曝光时长,设置功能隐藏,登录后才可以看到,变帧引脚和变帧偏移<br>若面阵需要频闪,则使用触发信号,继电器隔离(光源和相机触发都过继电器隔离)</p><p>以上更改,控制器9,可以实现可以同时支持6个面阵kickid+6个线扫kickid,极限可以支持8个面阵和8个线扫</p><p>如果用变帧功能(线扫),就直接让图像高度为动态.如果(面阵),则光电距离相机大于产品长度,拍照位置组成&#x3D;基础相位+变帧(图像高度)&#x2F;2</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> 脉冲计数;   <span class="comment">//光电触发有效后,将踢废间隔赋值给该变量,脉冲递减该变量   </span></span><br><span class="line">    <span class="type">int</span> 踢废标记;   <span class="comment">//是否踢废</span></span><br><span class="line">&#125;Location_t;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    <span class="type">int</span> 触发IO;</span><br><span class="line">    <span class="type">int</span> 踢废IO;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> 踢废间隔;   <span class="comment">//光电位置到踢废口</span></span><br><span class="line">    <span class="type">int</span> 拍照相位;   <span class="comment">//光电位置到相机位置</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> 图像高度;  </span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    <span class="type">int</span> 光电工位ID;</span><br><span class="line">    <span class="type">int</span> 图像结果ID; </span><br><span class="line">    Location_t 位置记录[<span class="number">256</span>];    <span class="comment">//65即可,最大值应为65535/产片脉冲数</span></span><br><span class="line"></span><br><span class="line">&#125;KickID_t;</span><br><span class="line"></span><br><span class="line">拍照位置=踢废间隔-拍照相位;</span><br><span class="line">拍照标志=脉冲计数==拍照位置?<span class="number">1</span>:拍照标志;</span><br><span class="line"></span><br><span class="line">踢废标志=脉冲计数==<span class="number">1</span>?<span class="number">1</span>:踢废标志;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(面阵)&#123;</span><br><span class="line">    <span class="comment">//触发拍照信号,工位ID+1</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(线扫)&#123;</span><br><span class="line">    <span class="comment">//图像高度计数结束,工位ID+1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> STM32 </category>
          
          <category> 一体机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目经验 </tag>
            
            <tag> 一体机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dalsa</title>
      <link href="/2024/08/22/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/Dalsa/"/>
      <url>/2024/08/22/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/Dalsa/</url>
      
        <content type="html"><![CDATA[<h2 id="下载SDK"><a href="#下载SDK" class="headerlink" title="下载SDK"></a>下载SDK</h2><p><a href="http://teledynedalsa.com/sapera-lt-dl/?dl=1&pkg=SDKWOW64&key=BezZNB87ZcwFO7mZ1Neb1g==">Sapera LT 8.73 SDK (WoW64)</a></p><p><a href="http://teledynedalsa.com/sapera-lt-dl/?dl=1&pkg=SDK&key=BezZNB87ZcwFO7mZ1Neb1g==">Sapera LT 8.73 SDK For Developers</a></p><h2 id="8K线扫-LA-GM-08K08A-00-R-Linea-M8192-7um-1"><a href="#8K线扫-LA-GM-08K08A-00-R-Linea-M8192-7um-1" class="headerlink" title="8K线扫(LA-GM-08K08A-00-R&#x2F;Linea_M8192-7um_1)"></a>8K线扫(LA-GM-08K08A-00-R&#x2F;Linea_M8192-7um_1)</h2><h3 id="接口-引脚定义"><a href="#接口-引脚定义" class="headerlink" title="接口&#x2F;引脚定义"></a>接口&#x2F;引脚定义</h3><p><img src="/.com//Dalsa/1711533769128.png" alt="1711533769128"></p><h3 id="倍频设置（编码器型号500，设置2000）"><a href="#倍频设置（编码器型号500，设置2000）" class="headerlink" title="倍频设置（编码器型号500，设置2000）"></a>倍频设置（编码器型号500，设置2000）</h3><ol><li>点击show more<br><img src="/.com//Dalsa/1711533779034.png" alt="1711533779034"></li><li>Trigger Selector 选择 Single Line Trigger（Start）</li><li>Trigger Mode 选择 On</li><li>Trigger Source 选择 Rotary Encoder   （触发源选择编码器模式）</li><li>Trigger Overlap 选择 Readout</li><li>Rotary Encoder Output Mode 选择 Motion   （编码器方向：忽略方向）</li><li>Rotary Encoder Input A Source 选择 Line1 （编码器A）</li><li>Rotary Encoder Input B Source 选择 Line2 （编码器B）</li><li>Rotary Encoder Source Activation 选择 Any Edge   （边沿触发）</li><li>Rotary Encoder Multiplier 选择 1    （倍频）</li><li>Rotary Encoder Divider 选择 1   （分频）</li><li>Line Selector 选择 Line1    （设置Line1滤波）</li><li>Input Line Debouncing Period（in us）设置5  （滤波设置5us）</li><li>Line Selector 选择 Line2    （设置Line2滤波）</li><li>Input Line Debouncing Period（in us）设置5  （滤波设置5us）</li></ol><p><img src="/.com//Dalsa/1711533787467.png" alt="1711533787467"></p>]]></content>
      
      
      <categories>
          
          <category> 相机 </category>
          
          <category> Dalsa </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Basler</title>
      <link href="/2024/08/22/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/Basler/"/>
      <url>/2024/08/22/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/Basler/</url>
      
        <content type="html"><![CDATA[<h2 id="下载SDK"><a href="#下载SDK" class="headerlink" title="下载SDK"></a>下载SDK</h2><p><a href="https://www.baslerweb.com/cn/downloads/software-downloads/#type=pylonsoftware;os=windows;version=all">Basler Pylon 下载链接</a></p><h2 id="2K线扫（ral2048-48gm）"><a href="#2K线扫（ral2048-48gm）" class="headerlink" title="2K线扫（ral2048_48gm）"></a>2K线扫（ral2048_48gm）</h2><h3 id="接口定义"><a href="#接口定义" class="headerlink" title="接口定义"></a>接口定义</h3><p><img src="/.com//Basler/1711533696881.png" alt="1711533696881"></p><h3 id="引脚定义"><a href="#引脚定义" class="headerlink" title="引脚定义"></a>引脚定义</h3><p><img src="/.com//Basler/1711533704889.png" alt="1711533704889"></p><p><img src="/.com//Basler/1711533712878.png" alt="1711533712878"></p><h3 id="倍频设置-已验证成功"><a href="#倍频设置-已验证成功" class="headerlink" title="倍频设置    (已验证成功)"></a>倍频设置    (已验证成功)</h3><p><strong>简述</strong>：倍频模式只需要编码器一相输入即可，不需要AB两相。</p><ol><li>Trigger Selector选择Line Start</li><li>Trigger Mode 选择On</li><li>Trigger Source选择Frequency Converter</li><li>类别Digital I&#x2F;O Controls下Line Selector选择Line1（用哪个选哪个）</li><li>Line Debouncer Time Abs[us] 输入10，滤波10us</li><li>类别-&gt;Frequency Converter下Input Source选择Line 1（用哪个选哪个）</li><li>Signal Alignment选择Rising Edge</li><li>Multiplier输入需要倍频的系数</li><li>Prevent Overtrigger 打上对勾</li></ol><p><img src="/.com//Basler/1711533723238.png" alt="1711533723238"></p><p><img src="/.com//Basler/1711533730769.png" alt="1711533730769"></p><p><img src="/.com//Basler/1711533739383.png" alt="1711533739383"></p><h4 id="调试过程中遇到的问题"><a href="#调试过程中遇到的问题" class="headerlink" title="调试过程中遇到的问题"></a>调试过程中遇到的问题</h4><ul><li>连接相机后立即且一直出图。<br>  解决办法：Line Debouncer Time Abs设置滤波解决</li></ul><h3 id="编码器模式-已验证成功"><a href="#编码器模式-已验证成功" class="headerlink" title="编码器模式  (已验证成功)"></a>编码器模式  (已验证成功)</h3><p><strong>简述</strong>：编码器模式正向拍照，反向不拍照且计数，恢复正向后到开始反向的位置则继续拍照。(相当于直接4倍频)</p><ol><li>Trigger Selector选择Line Start</li><li>Trigger Mode 选择On</li><li>Trigger Source选择Shaft Encoder Module Out</li><li>类别Digital I&#x2F;O Controls下Line Selector选择Line1（用哪个选哪个）</li><li>Line Debouncer Time Abs[us] 输入10，滤波10us</li><li>类别-&gt;Shaft Encoder Module Out下Shaft Encoder Module Line Selector选择Phase A</li><li>Shaft Encoder Module Line选择Line1(接线哪个选哪个)</li><li>Shaft Encoder Module Out下Shaft Encoder Module Line Selector选择Phase B</li><li>Shaft Encoder Module Line选择Line3(接线哪个选哪个)</li><li>Shaft Encoder Module Trigger Mode Any Direction 开启任意方向滴答计数</li><li>Shaft Encoder Module Counter Mode 选择Follow Direction 开启反转负计数</li><li>Shaft Encoder Module Max Reverse Counter 负计数最大值，设置为32767</li><li><strong>注意</strong>：两个计数，最大值是32767，最小值是0，若向上超过最大值则变成0开始计数，向下超过0，则变成32767</li></ol><p><img src="/.com//Basler/1711533748800.png" alt="1711533748800"></p><p>思考：若使用到检测停机中，配合采集触发就绪功能，则可以解决干扰以及正反转的问题</p><h3 id="输出IO-采集就绪输出信号，未验证"><a href="#输出IO-采集就绪输出信号，未验证" class="headerlink" title="输出IO (采集就绪输出信号，未验证)"></a>输出IO (采集就绪输出信号，未验证)</h3><p><strong>简述</strong>：可以作为图像结束信号，对齐图像工位，避免受到干扰造成的影响（手册中，在线文档中都没有该功能的描述，因为要代码设置参数，且需要写下位机程序验证，需要花费较长的时间，故此没有验证，此处仅简单记录）</p><p>部分功能验证，输出IO有效</p><ol><li>类别Diagital I&#x2F;O Controls 下 Line Selector 选择 Output Line 1</li><li>Line Source 选择 Acquisition Trigger Ready</li><li>Line Output Pulse Min.Width[us] 设置为100us（似乎是最大值）</li></ol><p><img src="/.com//Basler/1711533759425.png" alt="1711533759425"></p><p>备注：Line Source 只能通过代码设置选择 Acquisition Trigger Ready，相机驱动中没有提供该功能的选项</p>]]></content>
      
      
      <categories>
          
          <category> 相机 </category>
          
          <category> Basler </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Artix7</title>
      <link href="/2024/08/22/FPGA/Artix7/"/>
      <url>/2024/08/22/FPGA/Artix7/</url>
      
        <content type="html"><![CDATA[<h1 id="Artix7"><a href="#Artix7" class="headerlink" title="Artix7"></a>Artix7</h1><h2 id="XC7A100T"><a href="#XC7A100T" class="headerlink" title="XC7A100T"></a>XC7A100T</h2><h3 id="vivado-代码固化"><a href="#vivado-代码固化" class="headerlink" title="vivado&#x2F;代码固化"></a>vivado&#x2F;代码固化</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><pre><code>vivado2019.2</code></pre><ol><li>双击xsetup.exe（安装包不可以放在中文路径下）</li><li>基本无脑下一步，遇到agree就勾选，遇到路径自己选</li><li>选择版次，Vivado HL System Editiom</li><li>安装时间较长耐心等待，安装完成后弹出license manger 2019.2,点击左侧load license，选择license文件。</li></ol><h3 id="verilog"><a href="#verilog" class="headerlink" title="verilog"></a>verilog</h3><h4 id="进制格式"><a href="#进制格式" class="headerlink" title="进制格式"></a>进制格式</h4><p>二进制表示：4’b0000<br>十进制表示：4’d0<br>十六进制表示：4’h0</p><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><p>寄存器类型<br>    reg [31:0] a;<br>线网类型<br>    wire [31:0] a;<br>参数类型<br>    parameter [31:0] a &#x3D; 32’d100;</p><h4 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h4><p>加减乘除取余+ - * &#x2F; %<br>位与或异或取反&amp; | ^ ~<br>小于 小于等于 大于 大于等于&lt; &lt;&#x3D; &gt; &gt;&#x3D;<br>等于 不等 &#x3D;&#x3D; !&#x3D;<br>与或非&amp;&amp; || !</p><h4 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h4><h5 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h5><p>if (a &#x3D;&#x3D; 100)<br>    b &#x3D; 1;  </p><p>if(a&#x3D;&#x3D;100)begin<br>    b &#x3D; 1;<br>    b&#x3D;2;<br>end</p><h3 id="IO-INPUT-OUTPUT"><a href="#IO-INPUT-OUTPUT" class="headerlink" title="IO&#x2F;INPUT&#x2F;OUTPUT"></a>IO&#x2F;INPUT&#x2F;OUTPUT</h3><h3 id="时钟"><a href="#时钟" class="headerlink" title="时钟"></a>时钟</h3><p>bufg 全局时钟 可以控制FPGA任何的资源</p><p>Clock Region 局域时钟 IO 逻辑资源</p><p>bufr 区域时钟 控制一个区域的时钟</p><h4 id="代码编辑相关"><a href="#代码编辑相关" class="headerlink" title="代码编辑相关"></a>代码编辑相关</h4><ol><li>verilog-format   格式化配置简单，效果一般</li><li>iStyle           格式化需要下载源码，编译出二进制文件，效果较好（推荐使用该方式）</li><li>verible-verilog-format 格式化配置简单，效果较好    （但同一文件内出现多个always语句块时则无法格式化，故此推荐使用iStyle）</li></ol><p>三者都有相应的格式化功能，只是相应的格式化规则略有不同。</p><p>vscode编辑器 插件 Verilog-HDL&#x2F;System Verilog&#x2F;*****（支持代码关键字高亮，支持多种代码格式化）</p>]]></content>
      
      
      <categories>
          
          <category> FPGA </category>
          
          <category> Artix7 </category>
          
          <category> test </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>项目-金佰利-包袋-叠袋</title>
      <link href="/2024/08/22/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E9%A1%B9%E7%9B%AE-%E9%87%91%E4%BD%B0%E5%88%A9-%E5%8C%85%E8%A2%8B-%E5%8F%A0%E8%A2%8B/"/>
      <url>/2024/08/22/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E9%A1%B9%E7%9B%AE-%E9%87%91%E4%BD%B0%E5%88%A9-%E5%8C%85%E8%A2%8B-%E5%8F%A0%E8%A2%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="金佰利-包装叠袋"><a href="#金佰利-包装叠袋" class="headerlink" title="金佰利-包装叠袋"></a>金佰利-包装叠袋</h1><h2 id="拍照方案"><a href="#拍照方案" class="headerlink" title="拍照方案"></a>拍照方案</h2><blockquote><p>需求简述<br>拍两张照片，一张曝光时间长（要拍的亮），另一张曝光时间短（相对暗一点）</p></blockquote><h3 id="1-光源频闪"><a href="#1-光源频闪" class="headerlink" title="1. 光源频闪"></a>1. 光源频闪</h3><pre><code>    - 控制光源亮灭时间，实现曝光长短    - 客户不接受光源闪烁，坏眼睛</code></pre><h3 id="2-软件修改曝光时间"><a href="#2-软件修改曝光时间" class="headerlink" title="2. 软件修改曝光时间"></a>2. 软件修改曝光时间</h3><pre><code>    - 产品到达停顿位置后，下位机给上位机拍照信号    - 上位机接收到信号后，先设置相机曝光时间，开始拍第一张照片。完成后，再设置曝光时间，再次拍第二张照片。    - 此方法，产线停顿时间仅100ms，不足以完成软件拍两次照片</code></pre><h3 id="3-光源分时"><a href="#3-光源分时" class="headerlink" title="3. 光源分时"></a>3. 光源分时</h3><pre><code>    - 光源使用PWM控制    - 拍第一张照片，占空比低，光源比较亮    - 拍第二张照片，占空比高，光源比较暗    - 此方法，效果不确定，且光源会有亮暗变化</code></pre><h3 id="4-相机分时"><a href="#4-相机分时" class="headerlink" title="4. 相机分时"></a>4. 相机分时</h3><pre><code>    - 相机触发使用高/低电平触发    - 下位机触发信号长，则拍照曝光时间长（图亮）    - 下位机触发信号短，则拍照曝光时间短（图暗）    - 此方法理论效果最好</code></pre>]]></content>
      
      
      <categories>
          
          <category> 项目经验 </category>
          
          <category> 金佰利 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目 </tag>
            
            <tag> 金佰利 </tag>
            
            <tag> 包装 </tag>
            
            <tag> 叠袋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/08/22/%E7%BB%BC%E5%90%88/%E5%8D%9A%E5%AE%A2/vcpkg%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/08/22/%E7%BB%BC%E5%90%88/%E5%8D%9A%E5%AE%A2/vcpkg%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="vcpkg随手笔记"><a href="#vcpkg随手笔记" class="headerlink" title="vcpkg随手笔记"></a>vcpkg随手笔记</h1><p>需要先准备git,vs2017&#x2F;vs2019必须安装了英文语言包的</p><h2 id="1-安装"><a href="#1-安装" class="headerlink" title="1. 安装"></a>1. 安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/Microsoft/vcpkg.git</span><br><span class="line"><span class="built_in">cd</span> vcpkg</span><br><span class="line">./bootstrap-vcpkg.sh</span><br><span class="line">./vcpkg integrate install</span><br></pre></td></tr></table></figure><p>克隆仓库后把根目录添加到系统环境变量</p><h2 id="加速"><a href="#加速" class="headerlink" title="加速"></a>加速</h2><p>设置git的代理加速,对http和https都生效.ssh无效</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy &quot;http://127.0.0.1:1080&quot;</span><br><span class="line">git config --global https.proxy &quot;https://127.0.0.1:1080&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>除了设置代理，我们还可以设置 hosts</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.30.253.112    github.com</span><br><span class="line">192.30.253.113    github.com</span><br><span class="line">151.101.185.194   github.global.ssl.fastly.net</span><br></pre></td></tr></table></figure><h2 id="梯子"><a href="#梯子" class="headerlink" title="梯子"></a>梯子</h2><p>可以使用梯子加速下载<br>开启clash verge,tun模式,git的代理指向clash verge端口7890,127.0.0.1:7890<br>或修改clash verge的端口为代理后git的端口1080<strong>修改完代理后,重启clash verge,以及git终端</strong></p><h2 id="2-添加库"><a href="#2-添加库" class="headerlink" title="2. 添加库"></a>2. 添加库</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vcpkg install &lt;package&gt;:&lt;triplet&gt;</span><br></pre></td></tr></table></figure><h2 id="添加opencv"><a href="#添加opencv" class="headerlink" title="添加opencv"></a>添加opencv</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vcpkg install opencv4[contrib,world]:x64-windows --debug --recurse</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">指定版本 --&gt;<span class="number">4.8</span><span class="number">.0</span> <span class="punctuation">,</span>使用json配置文件</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my-project&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;opencv4&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;version&gt;=&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4.8.0&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="添加Qt5"><a href="#添加Qt5" class="headerlink" title="添加Qt5"></a>添加Qt5</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vcpkg install qt5:x64-windows //完整版</span><br><span class="line"></span><br><span class="line">vcpkg install qt5-base:x64-windows --recurse  //基础版</span><br><span class="line">vcpkg install qt-tools:x64-windows //工具designer</span><br><span class="line">vcpkg install qt5-serialport:x64-windows //串口</span><br><span class="line">vcpkg install qt5-serialbus:x64-windows //can</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="添加Simpleini"><a href="#添加Simpleini" class="headerlink" title="添加Simpleini"></a>添加Simpleini</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vcpkg install simpleini</span><br><span class="line">include_directories(<span class="variable">$&#123;SIMPLEINI_INCLUDE_DIR&#125;</span>)</span><br><span class="line">target_link_libraries(main <span class="variable">$&#123;SIMPLEINI_LIBRARY&#125;</span>)</span><br></pre></td></tr></table></figure><h2 id="CMake使用vcpkg"><a href="#CMake使用vcpkg" class="headerlink" title="CMake使用vcpkg"></a>CMake使用vcpkg</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置 vcpkg 工具链路径</span></span><br><span class="line"><span class="built_in">set</span>(CMAKE_TOOLCHAIN_FILE <span class="string">&quot;path/to/vcpkg/scripts/buildsystems/vcpkg.cmake&quot;</span></span><br><span class="line">    CACHE STRING <span class="string">&quot;VCPKG toolchain file&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span>(OpenCV_ROOT <span class="string">&quot;<span class="variable">$&#123;VCPKG_INSTALLED_DIR&#125;</span>/x64-windows/share/opencv4&quot;</span>)</span><br><span class="line">    find_package(OpenCV REQUIRED)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>PyQt5</title>
      <link href="/2024/08/22/PyQt5/"/>
      <url>/2024/08/22/PyQt5/</url>
      
        <content type="html"><![CDATA[<h1 id="PyQt5"><a href="#PyQt5" class="headerlink" title="PyQt5"></a>PyQt5</h1><h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><p>PyQt5 是 Python 语言的 Qt 绑定库，它提供了 Python 语言中使用 Qt 的完整功能。</p><h2 id="2-安装"><a href="#2-安装" class="headerlink" title="2. 安装"></a>2. 安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install PyQt5 -i https://pypi.douban.com/simple</span><br><span class="line">pip install PyQt5-tools -i https://pypi.douban.com/simple</span><br></pre></td></tr></table></figure><h2 id="3-制作安装包"><a href="#3-制作安装包" class="headerlink" title="3. 制作安装包"></a>3. 制作安装包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pyinstaller</span><br><span class="line">pyinstaller -w -F test.py Ui_mainwindow.py</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4-pycharm-配置外部工具"><a href="#4-pycharm-配置外部工具" class="headerlink" title="4. pycharm 配置外部工具"></a>4. pycharm 配置外部工具</h2><p>designer路径<br>pyuic路径</p><ul><li>ui文件上右键，选择外部工具，选择转化即可</li></ul><h2 id="5-vscode-安装插件PYQT-Integration"><a href="#5-vscode-安装插件PYQT-Integration" class="headerlink" title="5. vscode 安装插件PYQT Integration"></a>5. vscode 安装插件PYQT Integration</h2><p>配置designer路径</p><ul><li>ui文件上右键，选择Compile Form 即编译UI文件为py文件</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/08/22/Qt/C++_ini%E8%AF%BB%E5%86%99-%E5%90%AB%E6%B3%A8%E9%87%8A/"/>
      <url>/2024/08/22/Qt/C++_ini%E8%AF%BB%E5%86%99-%E5%90%AB%E6%B3%A8%E9%87%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="ini读写"><a href="#ini读写" class="headerlink" title="ini读写"></a>ini读写</h1><h2 id="SimpleIni"><a href="#SimpleIni" class="headerlink" title="SimpleIni"></a>SimpleIni</h2><ul><li>相对好用的库</li><li>与opencv的ACCESS_MASK冲突<ul><li>1.不使用命名空间</li><li>2.引用头文件的时候先引用SimpleIni.h,后使用#undef ACCESS_MASK解除冲突再引用opencv.h</li></ul></li></ul><h2 id="ini读写库"><a href="#ini读写库" class="headerlink" title="ini读写库"></a>ini读写库</h2><ul><li>[inih]    可读参数且支持注释，不可写参数（需要使用c语言结构体，数据结构管理的方式）</li><li>[inicpp]  可读参数且支持注释，可写参数且支持注释，注释必须为单独的行，不可与参数在同一行  <!-- 若包含hpp文件后编译报错，则在该文件中添加头文件#include <array> --></li><li>[QSettings]   可读参数且支持注释，写参数会消除注释</li><li>[SimpleIni]   可读参数且支持注释，写参数会消除注释</li><li>[IniParser]  可读参数且支持注释，写参数会消除注释(可能对linux支持更好)</li></ul><h2 id="inicpp示例程序"><a href="#inicpp示例程序" class="headerlink" title="inicpp示例程序"></a>inicpp示例程序</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;inicpp.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* compile: g++ -I../ -std=c++11 main.cpp -o iniExample */</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// Load the INI file.</span></span><br><span class="line"> inicpp::IniManager _ini(<span class="string">&quot;config.ini&quot;</span>);      <span class="comment">//可以用指针，实例化的时候传入路径，后面读取参数用QString::fromstdstring((*ini)[&quot;rtsp&quot;][&quot;port&quot;]))</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// Check if the key exists.</span></span><br><span class="line"> <span class="keyword">if</span> (!_ini[<span class="string">&quot;rtsp&quot;</span>].<span class="built_in">isKeyExist</span>(<span class="string">&quot;port&quot;</span>))</span><br><span class="line"> &#123;</span><br><span class="line">  std::cout &lt;&lt; <span class="string">&quot;rtsp.port is not exist!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// Modify or add key-value pairs.</span></span><br><span class="line"> _ini.<span class="built_in">modify</span>(<span class="string">&quot;rtsp&quot;</span>, <span class="string">&quot;port&quot;</span>, <span class="string">&quot;554&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// Use key-value pairs directly.</span></span><br><span class="line"> std::string rtsp_port = _ini[<span class="string">&quot;rtsp&quot;</span>][<span class="string">&quot;port&quot;</span>];</span><br><span class="line"></span><br><span class="line"> <span class="comment">// You can write section-key-value.</span></span><br><span class="line"> _ini.<span class="built_in">modify</span>(<span class="string">&quot;rtsp&quot;</span>, <span class="string">&quot;port&quot;</span>, <span class="string">&quot;554&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// Add a comment.</span></span><br><span class="line"> _ini.<span class="built_in">modify</span>(<span class="string">&quot;rtsp&quot;</span>, <span class="string">&quot;port&quot;</span>, <span class="string">&quot;554&quot;</span>, <span class="string">&quot;this is the listen port for http server&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// Modify the comment.</span></span><br><span class="line"> _ini.<span class="built_in">modifyComment</span>(<span class="string">&quot;rtsp&quot;</span>, <span class="string">&quot;port&quot;</span>, <span class="string">&quot;this is the listen port for rtsp server ***&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// Try to modify or add more.</span></span><br><span class="line"> _ini.<span class="built_in">modify</span>(<span class="string">&quot;math&quot;</span>, <span class="string">&quot;PI&quot;</span>, <span class="string">&quot;3.1415926&quot;</span>, <span class="string">&quot;This is pi in mathematics.&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// You have obtained the key-value pair and saved it to your config file.</span></span><br><span class="line"> std::cout &lt;&lt; <span class="string">&quot;to string:\trtsp.port = &quot;</span> &lt;&lt; _ini[<span class="string">&quot;rtsp&quot;</span>][<span class="string">&quot;port&quot;</span>] &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// Convert to string, default is string</span></span><br><span class="line"> std::string http_port_s = _ini[<span class="string">&quot;math&quot;</span>].<span class="built_in">toString</span>(<span class="string">&quot;PI&quot;</span>);</span><br><span class="line"> std::cout &lt;&lt; <span class="string">&quot;to string:\tmath.PI   = &quot;</span> &lt;&lt; http_port_s &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// Convert to double</span></span><br><span class="line"> <span class="type">double</span> http_port_d = _ini[<span class="string">&quot;math&quot;</span>].<span class="built_in">toDouble</span>(<span class="string">&quot;PI&quot;</span>);</span><br><span class="line"> std::cout &lt;&lt; <span class="string">&quot;to double:\tmath.PI   = &quot;</span> &lt;&lt; std::<span class="built_in">setprecision</span>(<span class="number">10</span>) &lt;&lt; http_port_d &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// Convert to int</span></span><br><span class="line"> <span class="type">int</span> http_port_i = _ini[<span class="string">&quot;math&quot;</span>].<span class="built_in">toInt</span>(<span class="string">&quot;PI&quot;</span>);</span><br><span class="line"> std::cout &lt;&lt; <span class="string">&quot;to int:\t\tmath.PI   = &quot;</span> &lt;&lt; http_port_i &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="常用API"><a href="#常用API" class="headerlink" title="常用API"></a>常用API</h2><h3 id="实例化"><a href="#实例化" class="headerlink" title="实例化"></a>实例化</h3><p> inicpp::IniManager _ini(“config.ini”);      &#x2F;&#x2F;可以用指针，实例化的时候传入路</p><p> Qt实例化<br> <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> QString inistr=<span class="string">&quot;参数管理/复卷检测.ini&quot;</span>;</span><br><span class="line"><span class="comment">// inistr.toLocal8Bit();</span></span><br><span class="line">_ini=<span class="keyword">new</span> inicpp::<span class="built_in">IniManager</span>(inistr.<span class="built_in">toLocal8Bit</span>().<span class="built_in">toStdString</span>());</span><br></pre></td></tr></table></figure></p><h3 id="写参数值"><a href="#写参数值" class="headerlink" title="写参数值"></a>写参数值</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">modify</span>()        <span class="comment">//修改参数值，如果参数不存在，会自动创建</span></span><br><span class="line"><span class="built_in">modifyComment</span>() <span class="comment">//修改注释，如果注释不存在，会自动创建</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 写参数.</span></span><br><span class="line"> _ini.<span class="built_in">modify</span>(<span class="string">&quot;rtsp&quot;</span>, <span class="string">&quot;port&quot;</span>, <span class="string">&quot;554&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 写参数同时添加注释.</span></span><br><span class="line"> _ini.<span class="built_in">modify</span>(<span class="string">&quot;rtsp&quot;</span>, <span class="string">&quot;port&quot;</span>, <span class="string">&quot;554&quot;</span>, <span class="string">&quot;this is the listen port for http server&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 修改注释.</span></span><br><span class="line"> _ini.<span class="built_in">modifyComment</span>(<span class="string">&quot;rtsp&quot;</span>, <span class="string">&quot;port&quot;</span>, <span class="string">&quot;this is the listen port for rtsp server ***&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="读参数值"><a href="#读参数值" class="headerlink" title="读参数值"></a>读参数值</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">string std = _ini[<span class="string">&quot;section&quot;</span>][<span class="string">&quot;key&quot;</span>]</span><br><span class="line">QString::<span class="built_in">fromstdstring</span>(_ini[<span class="string">&quot;section&quot;</span>][<span class="string">&quot;key&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;PLC1:IP:&quot;</span>&lt;&lt;QString::<span class="built_in">fromStdString</span>((*_ini)[str_key.<span class="built_in">toLocal8Bit</span>().<span class="built_in">toStdString</span>()][<span class="string">&quot;IP&quot;</span>]);</span><br></pre></td></tr></table></figure><h2 id="重要说明"><a href="#重要说明" class="headerlink" title="重要说明"></a>重要说明</h2><ul><li>该库支持中文，包括字段，键，值都可以使用中文</li><li>注释必须为单独的行，不可与参数在同一行，若为同一行，写参数会消除参数同一行后面的注释</li><li>读写参数值时，必须使用string类型，不能使用QString类型，否则会出错</li><li>读写参数前，必须先确保有相应的段，否则会出错（首次创建段之后，重启程序，则不会异常）</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>vscode_msvc_qt开发环境搭建</title>
      <link href="/2024/08/22/vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>/2024/08/22/vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="vscode-msvc-qt开发环境搭建"><a href="#vscode-msvc-qt开发环境搭建" class="headerlink" title="vscode_msvc_qt开发环境搭建"></a>vscode_msvc_qt开发环境搭建</h1><h2 id="vscode"><a href="#vscode" class="headerlink" title="vscode"></a>vscode</h2><p><strong>前言</strong></p><p>vscode编写Qt程序,有智能提示,代码错误会报错,有debug信息,控制台运行bat文件可以生成exe文件,控制台运行designer *.ui,可以编辑ui文件.最终达到比较舒服的开发环境.</p><p>下面分为两种方式实现</p><ol><li>纯插件实现</li><li>纯脚本实现</li></ol><p>第一种方案相对简单<br>推荐使用第二种方案,对整个开发编译过程有更好理解.</p><h2 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h2><h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><ul><li>C&#x2F;C++</li><li>CMake</li><li>CMake Tools</li><li>Qt Configuration</li><li>Qt tools</li></ul><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><ul><li><p>CMake配置,Cmake Path 填写CMake的安装目录”cmake.exe”</p></li><li><p><img src="/.com//vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1711533418466.png" alt="1711533418466"></p></li><li><p>Qt Configuration, ctrl+shift+p 输入qtconfig 选择set qt dir</p></li><li><p><img src="/.com//vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1711533430661.png" alt="1711533430661"></p></li><li><ul><li>选择Qt的安装目录(若安装了多个版本,则需要选择到想要使用的Qt版本的目录)</li></ul></li><li><p><img src="/.com//vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1711533440347.png" alt="1711533440347"></p></li><li><p>设置&#x2F;修改MSVC的编译器的目录</p></li><li><p><img src="/.com//vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1711533449859.png" alt="1711533449859"></p></li><li><p>设置C&#x2F;C++智能提示,ctrl+shift+p,输入C&#x2F;C++配置(UI)</p></li><li><p><img src="/.com//vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1711533459604.png" alt="1711533459604"></p></li><li><p>选择编译器路径(一般会自动扫描到,下拉选择即可,若没有自动扫描到,则需要手动输入,Everything搜索cl.exe路径)</p></li><li><p><img src="/.com//vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1711533469708.png" alt="1711533469708"></p></li><li><p>选择IntelliSense 模式为 windows msvc x64</p></li><li><p>包含路径,填写Qt的include目录(会自动填写),一般为Qt的安装目录\include</p></li><li><p><img src="/.com//vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1711533478717.png" alt="1711533478717"></p></li></ul><h2 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h2><h3 id="头文件相关"><a href="#头文件相关" class="headerlink" title="头文件相关"></a>头文件相关</h3><ul><li>Ctrl+shift+p,输入c,选择c++配置(UI)</li><li>选择编译器路径,选择msvc编译器路径,cl.exe(一般会自动搜寻到,选择自己使用的位数x86&#x2F;x64即可)</li><li>选择IntelliSense 模式为 windows msvc x64</li><li>包含路径,${workspaceRoot}&#x2F;**</li><li>包含路径,qt安装目录里相应编译器的include目录,D:&#x2F;Qt&#x2F;Qt6.6.2&#x2F;6.4.3&#x2F;msvc2019_64&#x2F;include&#x2F;**</li><li>若在UI里总是修改失败,则需要手动修改,在.vscode目录下找到c_cpp_properties.json文件修改”includePath”的内容即可</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Win32&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;includePath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;$&#123;workspaceFolder&#125;/**&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;D:/Qt/Qt6.6.2/6.4.3/msvc2019_64/include/**&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;defines&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;_DEBUG&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;UNICODE&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;_UNICODE&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;windowsSdkVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;10.0.22000.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;compilerPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.29.30133/bin/Hostx64/x64/cl.exe&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c17&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cppStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c++17&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;intelliSenseMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;windows-msvc-x64&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="number">4</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="原理分析-vscode编译qt的核心原理"><a href="#原理分析-vscode编译qt的核心原理" class="headerlink" title="原理分析(vscode编译qt的核心原理)"></a>原理分析(vscode编译qt的核心原理)</h3><h4 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h4><ul><li>vscode编译qt的原理是使用cmake&#x2F;qmake进行编译,cmake会自动生成编译文件(makefile &#x2F;makefile debug&#x2F; makefile release),然后使用msvc进行编译(nmake makefile debug&#x2F; nmake makefile release),msvc会自动生成exe文件,然后使用exe文件进行运行</li><li>简单理解就三步骤</li><li>1.设置msvc编译器环境  call “C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat” x64</li><li><ol start="2"><li>qmake生成makefile文件  qmake -spec win32-msvc “CONFIG+&#x3D;Release” “CONFIG+&#x3D;console”</li></ol></li><li><ol start="3"><li>makefile文件生成exe文件    nmake Release</li></ol></li><li><ol start="4"><li>exe文件运行    %BUILD_DIR%\Release\X_Line.exe</li></ol></li></ul><p>说明:</p><ul><li>控制台使用qmake指令,qml指令,需要先设置qt的编译器的目录为环境变量</li><li>控制台使用nmake指令,需要先设置msvc编译器的目录为环境变量,即call “C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat” x64</li><li>控制台使用designer指令打开ui文件,需要先设置qt安装目录下tools文件夹下qt5&#x2F;qt6的desiner相关文件夹找到designer.exe设置此文件夹为环境变量<br><img src="/.com//vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1712501472515.png" alt="1712501472515"></li></ul><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul><li>项目同级目录创建一个bat文件,也可以先创建一个build文件夹,然后把bat文件放在build文件夹中,bat文件内容如下:</li></ul><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> QT_DIR=d:\Qt\<span class="number">6</span>.<span class="number">4</span>.<span class="number">1</span>\msvc2019_64</span><br><span class="line"><span class="built_in">set</span> SRC_DIR=<span class="variable">%cd%</span></span><br><span class="line"><span class="built_in">set</span> BUILD_DIR=<span class="variable">%cd%</span>\build</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exist</span> <span class="variable">%QT_DIR%</span> <span class="keyword">exit</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exist</span> <span class="variable">%SRC_DIR%</span> <span class="keyword">exit</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exist</span> <span class="variable">%BUILD_DIR%</span> <span class="built_in">md</span> <span class="variable">%BUILD_DIR%</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> &quot;C:\Program Files (x86)\Microsoft Visual Studio\<span class="number">2019</span>\Community\VC\Auxiliary\Build\vcvarsall.bat&quot; x64</span><br><span class="line"></span><br><span class="line"><span class="variable">%QT_DIR%</span>\bin\qmake.exe <span class="variable">%SRC_DIR%</span>\X_Line.pro -spec win32-msvc  &quot;CONFIG+=Release&quot; &quot;CONFIG+=console&quot;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">exist</span> <span class="variable">%BUILD_DIR%</span>\Release\X_Line.exe <span class="built_in">del</span> <span class="variable">%BUILD_DIR%</span>\Release\X_Line.exe</span><br><span class="line">nmake Release</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exist</span> <span class="variable">%BUILD_DIR%</span>\Release\Qt5Cored.dll (</span><br><span class="line">  <span class="variable">%QT_DIR%</span>\bin\windeployqt.exe <span class="variable">%BUILD_DIR%</span>\Release\X_Line.exe</span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li>运行bat文件,编译完成,会在build文件夹中生成Release文件夹,里面有X_Line.exe文件,运行X_Line.exe即可</li></ul><h4 id="bat文件逐行分析"><a href="#bat文件逐行分析" class="headerlink" title="bat文件逐行分析"></a>bat文件逐行分析</h4><ul><li>@echo off: 禁止显示命令行输出</li><li>set QT_DIR&#x3D;d:\Qt\6.4.1\msvc2019_64: 设置Qt的安装目录</li><li>set SRC_DIR&#x3D;%cd%: 设置项目目录</li><li>set BUILD_DIR&#x3D;%cd%\build: 设置编译目录</li><li>if not exist %QT_DIR% exit: 判断Qt的安装目录是否存在,不存在则退出</li><li>if not exist %SRC_DIR% exit: 判断项目目录是否存在,不存在则退出</li><li>if not exist %BUILD_DIR% md %BUILD_DIR%: 判断编译目录是否存在,不存在则创建</li><li>cd build: 进入编译目录</li><li>call “C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat” x64: 设置编译器为msvc2019_64</li><li>%QT_DIR%\bin\qmake.exe %SRC_DIR%\X_Line.pro -spec win32-msvc “CONFIG+&#x3D;Release” “CONFIG+&#x3D;console”: 使用qmake生成makefile文件,指定编译器为msvc2019_64,指定编译模式为Release,指定编译类型为console</li><li>if exist %BUILD_DIR%\Release\X_Line.exe del %BUILD_DIR%\Release\X_Line.exe: 判断Release目录中是否存在X_Line.exe文件,存在则删除</li><li>nmake Release: 使用nmake编译makefile文件,指定编译模式为Release</li><li>if not exist %BUILD_DIR%\Release\Qt5Cored.dll (</li><li>%QT_DIR%\bin\windeployqt.exe %BUILD_DIR%\Release\X_Line.exe: 使用windeployqt将Qt的dll文件复制到Release目录中</li><li>)</li><li>运行bat文件,编译完成,会在build文件夹中生成Release文件夹,里面有X_Line.exe文件,运行X_Line.exe即可</li></ul><h4 id="优化bat文件"><a href="#优化bat文件" class="headerlink" title="优化bat文件"></a>优化bat文件</h4><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> QT_DIR=D:\Qt\Qt6.<span class="number">6</span>.<span class="number">2</span>\<span class="number">6</span>.<span class="number">4</span>.<span class="number">3</span>\msvc2019_64</span><br><span class="line"><span class="built_in">set</span> SRC_DIR=<span class="variable">%cd%</span></span><br><span class="line"><span class="built_in">set</span> BUILD_DIR=<span class="variable">%cd%</span>\build</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exist</span> <span class="variable">%QT_DIR%</span> <span class="keyword">exit</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exist</span> <span class="variable">%SRC_DIR%</span> <span class="keyword">exit</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exist</span> <span class="variable">%BUILD_DIR%</span> <span class="built_in">md</span> <span class="variable">%BUILD_DIR%</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> &quot;C:\Program Files (x86)\Microsoft Visual Studio\<span class="number">2019</span>\Community\VC\Auxiliary\Build\vcvarsall.bat&quot; x64</span><br><span class="line"></span><br><span class="line"><span class="variable">%QT_DIR%</span>\bin\qmake.exe <span class="variable">%SRC_DIR%</span>\control9_level_kick.pro -spec win32-msvc  &quot;CONFIG+=release&quot;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">exist</span> <span class="variable">%BUILD_DIR%</span>\release\control9_level_kick.exe <span class="built_in">del</span> <span class="variable">%BUILD_DIR%</span>\release\control9_level_kick.exe</span><br><span class="line">nmake Release</span><br><span class="line"><span class="comment">@REM if not exist %BUILD_DIR%\release\Qt5Core.dll (</span></span><br><span class="line"><span class="comment">@REM   %QT_DIR%\bin\windeployqt.exe %BUILD_DIR%\release\control9_level_kick.exe</span></span><br><span class="line"><span class="comment">@REM )</span></span><br><span class="line"></span><br><span class="line">release\control9_level_kick.exe</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><strong>逐行解析</strong></li><li>@echo off: 禁止显示命令行输出</li><li>set QT_DIR&#x3D;D:\Qt\Qt6.6.2\6.4.3\msvc2019_64: 设置Qt的安装目录</li><li>set SRC_DIR&#x3D;%cd%: 设置项目目录</li><li>set BUILD_DIR&#x3D;%cd%\build: 设置编译目录</li><li>if not exist %QT_DIR% exit: 判断Qt的安装目录是否存在,不存在则退出</li><li>if not exist %SRC_DIR% exit: 判断项目目录是否存在,不存在则退出</li><li>if not exist %BUILD_DIR% md %BUILD_DIR%: 判断编译目录是否存在,不存在则创建</li><li>cd build: 进入编译目录</li><li>call “C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat” x64: 设置编译器为msvc2019_64</li><li>%QT_DIR%\bin\qmake.exe %SRC_DIR%\control9_level_kick.pro -spec win32-msvc “CONFIG+&#x3D;release”: 使用qmake生成makefile文件,指定编译器为msvc2019_64,指定编译模式为Release</li><li>if exist %BUILD_DIR%\release\control9_level_kick.exe del %BUILD_DIR%\release\control9_level_kick.exe: 判断Release目录中是否存在control9_level_kick.exe文件,存在则删除</li><li>nmake Release: 使用nmake编译makefile文件,指定编译模式为Release</li><li>@REM if not exist %BUILD_DIR%\release\Qt5Core.dll (</li><li>@REM   %QT_DIR%\bin\windeployqt.exe %BUILD_DIR%\release\control9_level_kick.exe: 使用windeployqt将Qt的dll文件复制到Release目录中</li><li>@REM )</li><li>release\control9_level_kick.exe: 运行Release目录中的control9_level_kick.exe文件</li><li>cd ..: 返回项目目录</li><li>@REM 是bat文件的行注释符号</li></ul><h2 id="控制台打印输出"><a href="#控制台打印输出" class="headerlink" title="控制台打印输出"></a>控制台打印输出</h2><ul><li>pro文件添加,config+&#x3D;console</li></ul><p><img src="/.com//vscode_msvc_qt%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1729069891130.png" alt="1729069891130"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Qt_vscode_外部编辑器修改后qtcreator忽略修改提示</title>
      <link href="/2024/08/22/Qt_vscode_%E5%A4%96%E9%83%A8%E7%BC%96%E8%BE%91%E5%99%A8%E4%BF%AE%E6%94%B9%E5%90%8Eqtcreator%E5%BF%BD%E7%95%A5%E4%BF%AE%E6%94%B9%E6%8F%90%E7%A4%BA/"/>
      <url>/2024/08/22/Qt_vscode_%E5%A4%96%E9%83%A8%E7%BC%96%E8%BE%91%E5%99%A8%E4%BF%AE%E6%94%B9%E5%90%8Eqtcreator%E5%BF%BD%E7%95%A5%E4%BF%AE%E6%94%B9%E6%8F%90%E7%A4%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="Qt-vscode-外部编辑器修改后qtcreator忽略修改提示"><a href="#Qt-vscode-外部编辑器修改后qtcreator忽略修改提示" class="headerlink" title="Qt_vscode_外部编辑器修改后qtcreator忽略修改提示"></a>Qt_vscode_外部编辑器修改后qtcreator忽略修改提示</h1><p>设置步骤</p><p>Qtcreatro 12.0.1</p><ol><li>工具-&gt;外部-&gt;配置-&gt;环境-&gt;系统-&gt;当外部文件被修改时-&gt;重新载入所有未变更的编辑器</li><li><img src="/.com//Qt_vscode_%E5%A4%96%E9%83%A8%E7%BC%96%E8%BE%91%E5%99%A8%E4%BF%AE%E6%94%B9%E5%90%8Eqtcreator%E5%BF%BD%E7%95%A5%E4%BF%AE%E6%94%B9%E6%8F%90%E7%A4%BA/1711531430189.png" alt="1711531430189"></li></ol><p>Qtcreator 4.9.1</p><ol><li>工具-&gt;选项-&gt;环境-&gt;system-&gt;when fles are externally modified-&gt;reload All Unchanged Editors</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/08/22/FPGA/CameraLink/"/>
      <url>/2024/08/22/FPGA/CameraLink/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>C++_Modbus</title>
      <link href="/2024/08/08/Qt/C++_Modbus/"/>
      <url>/2024/08/08/Qt/C++_Modbus/</url>
      
        <content type="html"><![CDATA[<h1 id="C-Modbus"><a href="#C-Modbus" class="headerlink" title="C++_Modbus"></a>C++_Modbus</h1><h2 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h2><ol><li>使用QModbusTcpServer即可</li><li>也可使用libmodbus,相对复杂一点</li></ol><h2 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h2><ol><li>不建议使用QModbusTcpClient</li><li>使用libmodbus即可</li></ol><h2 id="HMI"><a href="#HMI" class="headerlink" title="HMI"></a>HMI</h2><h3 id="库的选择"><a href="#库的选择" class="headerlink" title="库的选择"></a>库的选择</h3><ol><li>使用libmodbus库通信,创建自定义控件,lineedit用于显示内容</li><li>lineedit中添加鼠标点击事件,使得点击该控件时,弹出数据设置窗口</li><li>在lineedit同名文件中添加类,该类为一个窗口,内部包含一个doublespinbox控件和一个按钮,分别用于输入数据以及发送数据到从设备.</li><li>在lineedit中开辟多线程,多线程用于处理周期读取数据.创建线程使用线程接受函数的方法,不用run()循环执行</li><li>不论读取数据还是写入数据,都必须使用线程锁,否则很容易会造成通信异常.</li></ol><h3 id="组件实现"><a href="#组件实现" class="headerlink" title="组件实现"></a>组件实现</h3><p>创建modbus结构体,该结构体包含,modbus实例,以及相对应的线程锁</p><ol><li>数据显示器:<ul><li>显示数据</li><li>点击后弹窗修改数据(弹窗使用dialog,小窗置顶,弹出时屏蔽其它窗体)</li><li>实例化时候可设置最大最小值,通信地址,数据类型(小数&#x2F;整数)小数位数</li><li>error信号反射(即通信异常的错误处理)</li></ul></li><li>按钮点击器:<ul><li>按钮点击事件(瞬动,反转,置位,复位)</li><li>按钮显示内容(与标志位挂钩,为0时显示,与为1时显示)</li><li>按钮显示颜色(与标志位挂钩,为0时显示,与为1时显示)</li><li>error信号反射</li></ul></li><li>日志记录</li><li>配方</li></ol>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> Modbus </tag>
            
            <tag> Modbus Client </tag>
            
            <tag> Modbus Server </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>金佰利_多相机产品对齐原理</title>
      <link href="/2024/06/15/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8E%A7%E5%88%B6%E5%99%A8/%E9%87%91%E4%BD%B0%E5%88%A9_%E5%A4%9A%E7%9B%B8%E6%9C%BA%E4%BA%A7%E5%93%81%E5%AF%B9%E9%BD%90%E5%8E%9F%E7%90%86/"/>
      <url>/2024/06/15/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8E%A7%E5%88%B6%E5%99%A8/%E9%87%91%E4%BD%B0%E5%88%A9_%E5%A4%9A%E7%9B%B8%E6%9C%BA%E4%BA%A7%E5%93%81%E5%AF%B9%E9%BD%90%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h1 id="多相机产品对齐原理"><a href="#多相机产品对齐原理" class="headerlink" title="多相机产品对齐原理"></a>多相机产品对齐原理</h1><h2 id="重点"><a href="#重点" class="headerlink" title="重点"></a>重点</h2><h3 id="标定位置"><a href="#标定位置" class="headerlink" title="标定位置"></a>标定位置</h3><ul><li><p>相机1位置</p></li><li><p>相机2位置</p></li><li><p>踢废偏移量校验</p></li></ul><h2 id="计算公式"><a href="#计算公式" class="headerlink" title="计算公式"></a>计算公式</h2><h3 id="相隔几张图像"><a href="#相隔几张图像" class="headerlink" title="相隔几张图像"></a>相隔几张图像</h3><p>  $数量&#x3D;(取整)(相机位置间隔&#x2F;图像高度)$</p><p>  $相机位置间隔&#x3D;相机1位置-相机2位置$</p><!-- ### 相机位置计算 --><p>  $相机位置&#x3D;(图像高度-拍照相位)+图像高度*踢废间隔+踢废偏移量$</p><!-- ### 相机1计算  $CAM1踢废距离=图像高度*踢废间隔+踢废偏移量+(图像高度-拍照相位)$### 相机2计算  $CAM2踢废距离=图像高度*踢废间隔+踢废偏移量+(图像高度-拍照相位)$### 相机1与相机2的距离  $相机1到相机2的距离=CAM1踢废距离-CAM2踢废距离$### 相隔几张图像  $(取整)数量=(相机1到相机2的距离/图像高度)$ --><h3 id="如何校验踢废偏移量设置"><a href="#如何校验踢废偏移量设置" class="headerlink" title="如何校验踢废偏移量设置"></a>如何校验踢废偏移量设置</h3><p>  $相机1(图像高度-拍照相位+踢废偏移量)&#x3D;相机2(图像高度-拍照相位+踢废偏移量)$</p><h2 id="以两台相机举例"><a href="#以两台相机举例" class="headerlink" title="以两台相机举例"></a>以两台相机举例</h2><ul><li>可能有的疑问:产品计算以图像高度计算,不以产品完整的脉冲数计算</li><li>若想要自动计算相机1与相机2间隔多少片图像(包含动态调节相位等因素的影响),则首先需要知道相机1与相机2的间隔距离,我们无法直接测量相机1与相机2的间隔距离(测量结果极不准确,有绕棍,角度等),物理测量几乎行不通.</li><li>此计算办法核心要点在于需要标定踢废位置,即踢废间隔和踢废相位(踢废偏移量),踢废间隔相信技术人员是一定设置准确的,但踢废相位(偏移量)是否能设置准确.若踢废偏移量不能标定一致,则标定差多少,则该办法计算误差就是多少</li><li>相机1踢废位置:Z+拍照相位+踢废间隔+踢废相位</li><li>相机2踢废位置:Z+拍照相位+踢废间隔+踢废相位</li><li>舍掉踢废间隔,拍照相位+踢废相位应相等</li></ul><h2 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h2><ol><li>相机1与相机2</li></ol>]]></content>
      
      
      <categories>
          
          <category> uncategorized </category>
          
      </categories>
      
      
        <tags>
            
            <tag> untagged </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RT_Thread</title>
      <link href="/2024/05/06/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/RT_Thread/"/>
      <url>/2024/05/06/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/RT_Thread/</url>
      
        <content type="html"><![CDATA[<p>RT-Thread 是一个开源的实时操作系统，支持多种 CPU 架构，包括 ARM、MIPS、X86 等。</p><h1 id="RT-Thread"><a href="#RT-Thread" class="headerlink" title="RT_Thread"></a>RT_Thread</h1><h2 id="工程创建"><a href="#工程创建" class="headerlink" title="工程创建"></a>工程创建</h2><h2 id="包-组件管理"><a href="#包-组件管理" class="headerlink" title="包&#x2F;组件管理"></a>包&#x2F;组件管理</h2><h2 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h2><h2 id="IO中断"><a href="#IO中断" class="headerlink" title="IO中断"></a>IO中断</h2><h2 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h2><h3 id="软件定时器"><a href="#软件定时器" class="headerlink" title="软件定时器"></a>软件定时器</h3><h3 id="硬件定时器"><a href="#硬件定时器" class="headerlink" title="硬件定时器"></a>硬件定时器</h3><h2 id="串口中断"><a href="#串口中断" class="headerlink" title="串口中断"></a>串口中断</h2><h2 id="SPI设备注册"><a href="#SPI设备注册" class="headerlink" title="SPI设备注册"></a>SPI设备注册</h2><h2 id="常用API"><a href="#常用API" class="headerlink" title="常用API"></a>常用API</h2><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2>]]></content>
      
      
      <categories>
          
          <category> uncategorized </category>
          
      </categories>
      
      
        <tags>
            
            <tag> untagged </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C_命名规则</title>
      <link href="/2024/04/09/Qt/C_%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99/"/>
      <url>/2024/04/09/Qt/C_%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99/</url>
      
        <content type="html"><![CDATA[<h1 id="命名规则"><a href="#命名规则" class="headerlink" title="命名规则"></a>命名规则</h1><p><a href="https://mp.weixin.qq.com/s/7174gKcN6fQqkVtdvj7gug">参考链接</a></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> C++ </tag>
            
            <tag> 命名规则 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++_23种设计模式</title>
      <link href="/2024/04/09/Qt/C++_23%E7%A7%8D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
      <url>/2024/04/09/Qt/C++_23%E7%A7%8D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="23种设计模式"><a href="#23种设计模式" class="headerlink" title="23种设计模式"></a>23种设计模式</h1><p><a href="https://mp.weixin.qq.com/s/g5rL3ZhghB8zpdQqVuZIBQ">参考连接</a></p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>创建型模式</p><p>设计模式 | 工厂&amp;抽象工厂模式<br>设计模式 | 生成器模式<br>设计模式 | 原型模式<br>设计模式 | 单例模式<br>结构型模式</p><p>设计模式 | 适配器模式<br>设计模式 | 桥接模式<br>设计模式 | 组合模式<br>设计模式 | 装饰模式<br>设计模式 | 外观模式<br>设计模式 | 享元模式<br>设计模式 | 代理模式<br>行为型模式</p><p>设计模式 | 责任链模式<br>设计模式 | 命令模式<br>设计模式 | 迭代器模式<br>设计模式 | 中介者模式<br>设计模式 | 备忘录模式<br>设计模式 | 观察者模式<br>设计模式 | 状态模式<br>设计模式 | 策略模式<br>设计模式 | 模板方法模式<br>设计模式 | 访问者模式</p><h2 id="常用模式"><a href="#常用模式" class="headerlink" title="常用模式"></a>常用模式</h2><ol><li>单例模式</li><li>观察者模式</li><li>策略模式</li></ol>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> C++ </tag>
            
            <tag> 设计模式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QML</title>
      <link href="/2024/04/09/Qt/Qt_QML/"/>
      <url>/2024/04/09/Qt/Qt_QML/</url>
      
        <content type="html"><![CDATA[<h1 id="QML"><a href="#QML" class="headerlink" title="QML"></a>QML</h1><p>QML 是 Qt 的一个图形用户界面语言，它允许你使用 XML 语法来描述界面。<br>QML 是基于 JavaScript 的，因此你可以使用 JavaScript 来编写你的 QML 代码。<br>QML 是一个基于组件的界面语言，这意味着你可以将界面分成多个组件，然后组合在一起。</p><p>优点:界面自由度高,声明式描述语言,较容易实现漂亮的界面,前后端分离,界面代码与逻辑代码解耦<br>缺点:需要学习QML语法,需要学习Quick,相对执行效率低,学习成本高,前后端交互复杂(即QML与C++交互复杂)</p><h2 id="如何在widget中使用QML"><a href="#如何在widget中使用QML" class="headerlink" title="如何在widget中使用QML"></a>如何在widget中使用QML</h2><ol><li>创建一个QML文件，例如main.qml。</li><li>在widget中,使用QQuickWidget对象加载qml文件</li><li>QML文件存放在qrc中,以资源文件的形式存放.(不至于发布程序暴露代码)</li></ol><h3 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">qmlRegisterSingletonInstance</span>(<span class="string">&quot;MyObj&quot;</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="string">&quot;MyObject&quot;</span>,MyObject::<span class="built_in">getInstance</span>());<span class="comment">//注册MyObject单例对象,QML中模块为MyObj,版本号1.0,对象名为MyObject</span></span><br><span class="line"></span><br><span class="line">ui-&gt;list_quick_station_number-&gt;<span class="built_in">setSource</span>(<span class="built_in">QUrl</span>(<span class="string">&quot;qrc:/qml_test.qml&quot;</span>));<span class="comment">//加载qml文件</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> Qt </tag>
            
            <tag> QML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>检测停机设计方案</title>
      <link href="/2024/03/28/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/"/>
      <url>/2024/03/28/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h1 id="检测停机方案"><a href="#检测停机方案" class="headerlink" title="检测停机方案"></a>检测停机方案</h1><h2 id="灵感思路"><a href="#灵感思路" class="headerlink" title="灵感思路"></a>灵感思路</h2><p>目的?</p><h3 id="成本-改进"><a href="#成本-改进" class="headerlink" title="成本&#x2F;改进"></a>成本&#x2F;改进</h3><ul><li>非标自动化公司</li><li>机械零件加工</li></ul><ol><li>若自己设计,外协仅加工机械零件.则需要考虑一些问题<ol><li>较大机械加工厂和小作坊加工的区别</li><li>人力,机械,电气,外协管理(1&#x2F;3?)</li><li>安装&#x2F;调试场地</li></ol></li><li>是否能节省成本?未知,<ol><li>直观认为可以节省成本.节省中间商,材料零部件成本可控.</li><li>但是直觉上认为节省有限,因为,供应链管理,外协管理,场地成本,标准化生产SOP,等,则为隐性成本</li></ol></li></ol><h3 id="问题本质-方案本身"><a href="#问题本质-方案本身" class="headerlink" title="问题本质&#x2F;方案本身"></a>问题本质&#x2F;方案本身</h3><ol><li>回到问题本质,复卷机客户的需求是对无纺布上的瑕疵缺陷进行有效的处理.缺陷全部检出,生产效率要高.</li><li>再说当前方案:先检测,再停机,由人工处理缺陷,再开机.其中优缺点如下:<ol><li>优点:通用性强,适用市面上几乎所有的复卷机</li><li>缺点:于客户而言,一台复卷机依然需要人工</li></ol></li><li>思考:<ol><li>当前方案,不论停机精度还是速度控制,几乎是最好的水平.即便有竞争对手,也基本无法超越.</li><li>是否可以考虑自动处理缺陷的方案,不停机,设备自动处理掉缺陷.以下是一些天马行空的想法:<ol><li>低级版本:在缺陷位置贴个标签</li><li>高级版本:激光刻蚀,烧穿缺陷</li></ol></li></ol></li></ol>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 检测停机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 检测停机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ResilioSync_同步盘</title>
      <link href="/2024/03/27/%E7%BB%BC%E5%90%88/ResilioSync_%E5%90%8C%E6%AD%A5%E7%9B%98/"/>
      <url>/2024/03/27/%E7%BB%BC%E5%90%88/ResilioSync_%E5%90%8C%E6%AD%A5%E7%9B%98/</url>
      
        <content type="html"><![CDATA[<h1 id="ResilioSync-同步盘"><a href="#ResilioSync-同步盘" class="headerlink" title="ResilioSync_同步盘"></a>ResilioSync_同步盘</h1><h2 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h2><p><a href="https://www.resilio.com/download/">ResilioSync地址</a></p><ul><li>下载Home版,个人免费版</li><li>双击安装,不勾选注册为服务</li></ul><h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><ul><li>左上角加号可以设置文件夹映射,可以共享密钥</li><li>其它拥有ResilioSync的电脑,可以从左上角加号,输入密钥或链接,后同步该文件夹</li></ul><h2 id="基本测试"><a href="#基本测试" class="headerlink" title="基本测试"></a>基本测试</h2><ul><li>局域网内同步效果非常好</li><li>公网同步效果差,接近不可用</li><li>若同文件冲突,会自动创建多个</li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>好用,推荐</li></ul>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 同步盘 </tag>
            
            <tag> 网盘 </tag>
            
            <tag> ResilioSync </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>服务器服务</title>
      <link href="/2024/03/13/Qt/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%9C%8D%E5%8A%A1/"/>
      <url>/2024/03/13/Qt/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="服务器服务"><a href="#服务器服务" class="headerlink" title="服务器服务"></a>服务器服务</h1><ol><li>monio</li><li>gitea</li><li>syncthing （文件同步，相当于本地云盘）</li><li>nodebb   （论坛）</li></ol><p>以上服务均已安装，并试用，效果满意</p><p>服务管理</p><ol><li>nssm （服务管理，启动运行，死机自动重启）</li><li>ngix （域名解析，网址索引）</li></ol>]]></content>
      
      
      <categories>
          
          <category> uncategorized </category>
          
      </categories>
      
      
        <tags>
            
            <tag> untagged </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows永久激活</title>
      <link href="/2024/03/09/%E7%BB%BC%E5%90%88/windows%E6%B0%B8%E4%B9%85%E6%BF%80%E6%B4%BB/"/>
      <url>/2024/03/09/%E7%BB%BC%E5%90%88/windows%E6%B0%B8%E4%B9%85%E6%BF%80%E6%B4%BB/</url>
      
        <content type="html"><![CDATA[<h1 id="windows永久激活"><a href="#windows永久激活" class="headerlink" title="windows永久激活"></a>windows永久激活</h1><ol><li>打开PowerShell（管理员）</li><li>输入代码 irm <a href="https://massgrave.dev/get|iex">https://massgrave.dev/get|iex</a>   <img src="/.com//windows%E6%B0%B8%E4%B9%85%E6%BF%80%E6%B4%BB/1709982831315.png" alt="1709982831315"></li><li>等待联网并弹出黑框   <img src="/.com//windows%E6%B0%B8%E4%B9%85%E6%BF%80%E6%B4%BB/1709983115117.png" alt="1709983115117"></li><li>弹出黑框，有几个选项，输入1，激活windows。（输入2激活offce等）</li><li>等待出现Permanently字样的提示，就激活成功了      <img src="/.com//windows%E6%B0%B8%E4%B9%85%E6%BF%80%E6%B4%BB/1709983145593.png" alt="1709983145593"></li><li>激活成功后重启电脑，即完成</li></ol>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> windows </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
            <tag> 激活 </tag>
            
            <tag> win11 </tag>
            
            <tag> 永久激活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt_QDir文件夹</title>
      <link href="/2024/03/08/Qt/Qt_QDir%E6%96%87%E4%BB%B6%E5%A4%B9/"/>
      <url>/2024/03/08/Qt/Qt_QDir%E6%96%87%E4%BB%B6%E5%A4%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="Qt-QDir文件夹"><a href="#Qt-QDir文件夹" class="headerlink" title="Qt_QDir文件夹"></a>Qt_QDir文件夹</h1><h2 id="创建文件夹"><a href="#创建文件夹" class="headerlink" title="创建文件夹"></a>创建文件夹</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QString logFolderPath = <span class="string">&quot;log&quot;</span>;</span><br><span class="line"><span class="built_in">QDir</span>().<span class="built_in">mkdir</span>(logFolderPath);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> Qt </tag>
            
            <tag> 文件夹 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C_define的奇技</title>
      <link href="/2024/02/23/Qt/C_define%E7%9A%84%E5%A5%87%E6%8A%80/"/>
      <url>/2024/02/23/Qt/C_define%E7%9A%84%E5%A5%87%E6%8A%80/</url>
      
        <content type="html"><![CDATA[<h1 id="C-define的奇技"><a href="#C-define的奇技" class="headerlink" title="C_define的奇技"></a>C_define的奇技</h1><p>1.一个宏定义多行,每行末尾使用   \   符号,即可实现,可用来定义函数等</p>]]></content>
      
      
      <categories>
          
          <category> uncategorized </category>
          
      </categories>
      
      
        <tags>
            
            <tag> untagged </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenCV_源码编译</title>
      <link href="/2024/02/02/Qt/OpenCV_%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/"/>
      <url>/2024/02/02/Qt/OpenCV_%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/</url>
      
        <content type="html"><![CDATA[<h1 id="OpenCV-源码编译"><a href="#OpenCV-源码编译" class="headerlink" title="OpenCV_源码编译"></a>OpenCV_源码编译</h1><h2 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h2><h2 id="1-下载源码"><a href="#1-下载源码" class="headerlink" title="1.下载源码"></a>1.下载源码</h2><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> OpenCV </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> OpenCV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenCV_常用算子</title>
      <link href="/2024/02/02/Qt/OpenCV_%E5%B8%B8%E7%94%A8%E7%AE%97%E5%AD%90/"/>
      <url>/2024/02/02/Qt/OpenCV_%E5%B8%B8%E7%94%A8%E7%AE%97%E5%AD%90/</url>
      
        <content type="html"><![CDATA[<h1 id="OpenCV-常用算子"><a href="#OpenCV-常用算子" class="headerlink" title="OpenCV_常用算子"></a>OpenCV_常用算子</h1>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> OpenCV </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> opencv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt_vscode_环境搭建</title>
      <link href="/2024/02/01/Qt/Qt_vscode_%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>/2024/02/01/Qt/Qt_vscode_%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="Qt-vscode-环境搭建"><a href="#Qt-vscode-环境搭建" class="headerlink" title="Qt_vscode_环境搭建"></a>Qt_vscode_环境搭建</h1><h2 id="1-安装Qt"><a href="#1-安装Qt" class="headerlink" title="1. 安装Qt"></a>1. 安装Qt</h2><h2 id="2-安装VSCode"><a href="#2-安装VSCode" class="headerlink" title="2. 安装VSCode"></a>2. 安装VSCode</h2><h2 id="3-安装Qt插件"><a href="#3-安装Qt插件" class="headerlink" title="3. 安装Qt插件"></a>3. 安装Qt插件</h2><h2 id="4-安装CMake插件"><a href="#4-安装CMake插件" class="headerlink" title="4. 安装CMake插件"></a>4. 安装CMake插件</h2><h2 id="5-安装QtCreator插件"><a href="#5-安装QtCreator插件" class="headerlink" title="5. 安装QtCreator插件"></a>5. 安装QtCreator插件</h2><h2 id="6-Qt环境变量配置"><a href="#6-Qt环境变量配置" class="headerlink" title="6. Qt环境变量配置"></a>6. Qt环境变量配置</h2><p><img src="/.com//Qt_vscode_%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/1706798303545.png" alt="1706798303545"></p><ul><li>qt cmake 路径</li></ul><h2 id="7-检查环境变量"><a href="#7-检查环境变量" class="headerlink" title="7. 检查环境变量"></a>7. 检查环境变量</h2><ul><li>打开cmd</li><li>cmake –version</li><li>gcc -v</li></ul>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> Qt </tag>
            
            <tag> VSCode </tag>
            
            <tag> 环境搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++_泛编程</title>
      <link href="/2024/01/26/Qt/C++_%E6%B3%9B%E7%BC%96%E7%A8%8B/"/>
      <url>/2024/01/26/Qt/C++_%E6%B3%9B%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="C-泛编程"><a href="#C-泛编程" class="headerlink" title="C++_泛编程"></a>C++_泛编程</h1><h2 id="自动类型推导"><a href="#自动类型推导" class="headerlink" title="自动类型推导"></a>自动类型推导</h2><ul><li>auto关键字可以自动推导类型，可以省略类型，但是不能省略变量名</li><li>不要滥用auto关键字</li><li>不要用auto作为形参</li><li>推荐用auto作为函数指针的类型声明.举例如下</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fun_c</span><span class="params">(<span class="type">int</span> c)</span></span>&#123;</span><br><span class="line">    cout &lt;&lt; c &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> fun = fun_c;   <span class="comment">//等效于void fun(int c)&#123;...&#125;    </span></span><br><span class="line">    <span class="built_in">fun</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="函数模板"><a href="#函数模板" class="headerlink" title="函数模板"></a>函数模板</h2><h2 id="类模板"><a href="#类模板" class="headerlink" title="类模板"></a>类模板</h2>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> C++ </tag>
            
            <tag> 泛编程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C_数据结构_链表</title>
      <link href="/2024/01/25/Qt/C_%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84_%E9%93%BE%E8%A1%A8/"/>
      <url>/2024/01/25/Qt/C_%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84_%E9%93%BE%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="C-数据结构-链表"><a href="#C-数据结构-链表" class="headerlink" title="C_数据结构_链表"></a>C_数据结构_链表</h1><h2 id="创建链表"><a href="#创建链表" class="headerlink" title="创建链表"></a>创建链表</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义结构体,包含一个指向自己的结构体指针</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">student</span>&#123;</span></span><br><span class="line"><span class="type">int</span> score;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; LinkList;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LinkList *<span class="title function_">creat</span><span class="params">(<span class="type">int</span> n)</span>&#123;</span><br><span class="line">LinkList *head, *node, *end;<span class="comment">//定义头节点，普通节点，尾部节点；</span></span><br><span class="line">head = (LinkList*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LinkList));<span class="comment">//分配地址</span></span><br><span class="line">end = head;         <span class="comment">//若是空链表则头尾节点一样</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">node = (LinkList*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LinkList));</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;node-&gt;score);</span><br><span class="line">end-&gt;next = node;</span><br><span class="line">end = node;</span><br><span class="line">&#125;</span><br><span class="line">end-&gt;next = <span class="literal">NULL</span>;<span class="comment">//结束创建</span></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="修改链表节点值"><a href="#修改链表节点值" class="headerlink" title="修改链表节点值"></a>修改链表节点值</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">change</span><span class="params">(LinkList *<span class="built_in">list</span>,<span class="type">int</span> n)</span> &#123;<span class="comment">//n为第n个节点</span></span><br><span class="line">LinkList *t = <span class="built_in">list</span>;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (i &lt; n &amp;&amp; t != <span class="literal">NULL</span>) &#123;</span><br><span class="line">t = t-&gt;next;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;输入要修改的值&quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t-&gt;score);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;节点不存在&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="删除链表节点"><a href="#删除链表节点" class="headerlink" title="删除链表节点"></a>删除链表节点</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">delet</span><span class="params">(LinkList *<span class="built_in">list</span>, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">LinkList *t = <span class="built_in">list</span>, *in;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (i &lt; n &amp;&amp; t != <span class="literal">NULL</span>) &#123;</span><br><span class="line">in = t;</span><br><span class="line">t = t-&gt;next;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line">in-&gt;next = t-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(t);    <span class="comment">//释放节点</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;节点不存在&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="插入链表节点"><a href="#插入链表节点" class="headerlink" title="插入链表节点"></a>插入链表节点</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">insert</span><span class="params">(LinkList *<span class="built_in">list</span>, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">LinkList *t = <span class="built_in">list</span>, *in;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (i &lt; n &amp;&amp; t != <span class="literal">NULL</span>) &#123;</span><br><span class="line">t = t-&gt;next;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line">in = (LinkList*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LinkList));</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;输入要插入的值&quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;in-&gt;score);</span><br><span class="line">in-&gt;next = t-&gt;next;<span class="comment">//填充in节点的指针域，也就是说把in的指针域指向t的下一个节点</span></span><br><span class="line">t-&gt;next = in;<span class="comment">//填充t节点的指针域，把t的指针域重新指向in</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;节点不存在&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="输出链表-遍历链表"><a href="#输出链表-遍历链表" class="headerlink" title="输出链表(遍历链表)"></a>输出链表(遍历链表)</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">       <span class="keyword">while</span> (h-&gt;next != <span class="literal">NULL</span>) &#123;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">&quot;%d  &quot;</span>, h-&gt;score);</span><br><span class="line">h = h-&gt;next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> C </tag>
            
            <tag> 链表 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>STM32芯片唯一ID</title>
      <link href="/2024/01/25/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/STM32%E8%8A%AF%E7%89%87%E5%94%AF%E4%B8%80ID/"/>
      <url>/2024/01/25/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/STM32%E8%8A%AF%E7%89%87%E5%94%AF%E4%B8%80ID/</url>
      
        <content type="html"><![CDATA[<h1 id="STM32-芯片唯一ID"><a href="#STM32-芯片唯一ID" class="headerlink" title="STM32 芯片唯一ID"></a>STM32 芯片唯一ID</h1><p>实验目的<br>STM32的每一个芯片都有一个电子签名，唯一的身份识别ID。本章我们学习获取STM32的电子签名信息，数据手册请参看第28章。</p><p>实验简介<br>电子签名存放字闪存存储器模块的系统存储区域，可以通过JTAG&#x2F;SWD或者CPU读取。它所包含的芯片识别信息在出厂时编写，用户固件或者外部设备可以读取电子签名，用以自动匹配不同配置的SRM32F10xxx微控制器。</p><p>本实验，我们获取STM32的FLASH容量信息和唯一身份识别ID（96位）。</p><p>代码<br>main.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MyIncludes.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> buff[<span class="number">100</span>];</span><br><span class="line"><span class="comment">//用来存储身份信息</span></span><br><span class="line">CHIP_ID_TypeDef stm32_id;</span><br><span class="line"><span class="comment">//id结构体变量声明</span></span><br><span class="line"><span class="type">uint32_t</span> flash_size = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//flash大小变量</span></span><br><span class="line"></span><br><span class="line">u16 sys_cnt = <span class="number">0</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">systick_isr</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">if</span>(sys_cnt &lt;<span class="number">1000</span>)</span><br><span class="line"> sys_cnt++;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line">   sys_cnt = <span class="number">0</span>;</span><br><span class="line">   HAL_GPIO_TogglePin(GPIOC,GPIO_PIN_4|GPIO_PIN_5);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  System_Init();</span><br><span class="line">  SysTick_Init(systick_isr);</span><br><span class="line">  LED_Init();</span><br><span class="line">  USART1_Init(<span class="number">115200</span>,<span class="literal">NULL</span>,<span class="literal">NULL</span>);</span><br><span class="line">  <span class="comment">//获取芯片ID</span></span><br><span class="line">  ChipID_Get(&amp;stm32_id);      </span><br><span class="line"><span class="comment">//获取芯片大小</span></span><br><span class="line">  flash_size = ChipFlashSize_Get();</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">sprintf</span>(buff,<span class="string">&quot;CHIP ID: %d%d%d\r\n&quot;</span>,stm32_id.ID_H,stm32_id.ID_M,stm32_id.ID_L);</span><br><span class="line">  <span class="comment">//将信息存储在buff数组中</span></span><br><span class="line">  <span class="built_in">printf</span>(buff);</span><br><span class="line">  <span class="comment">//打印buff数组数据</span></span><br><span class="line">  <span class="built_in">sprintf</span>(buff,<span class="string">&quot;CHIP FLASH: %dKB\r\n&quot;</span>,flash_size);</span><br><span class="line">  <span class="built_in">printf</span>(buff);</span><br><span class="line">   </span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>chip_id.h</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __CHIP_ID_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __CHIP_ID_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f1xx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32_types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stm32f1xx_hal.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="type">uint32_t</span> ID_H;<span class="comment">//高32位字</span></span><br><span class="line">  <span class="type">uint32_t</span> ID_M;<span class="comment">//中32位字</span></span><br><span class="line">  <span class="type">uint32_t</span> ID_L;<span class="comment">//低32位字</span></span><br><span class="line">&#125;CHIP_ID_TypeDef;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CHIP_ID_ADDR ((CHIP_ID_TypeDef *)((uint32_t)0x1FFFF7E8)) </span></span><br><span class="line"><span class="comment">//芯片ID基地址</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CHIP_FLASH_SIZE_ADDR  *((uint32_t*)0x1FFFF7E0)</span></span><br><span class="line"><span class="comment">//芯片FLASH大小基地址</span></span><br><span class="line"><span class="comment">//将0x1ffff7e0中的数据作为一个32位无符号指针使用</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">ChipID_Get</span><span class="params">(CHIP_ID_TypeDef* chip_id)</span>;</span><br><span class="line"><span class="comment">//获取芯片ID</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">ChipFlashSize_Get</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="comment">//获取芯片FLASH大小 单位为KB</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>chip_id.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;chip_id.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">ChipID_Get</span><span class="params">(CHIP_ID_TypeDef* chip_id)</span></span><br><span class="line"><span class="comment">//获取芯片ID</span></span><br><span class="line">&#123;</span><br><span class="line">  chip_id-&gt;ID_H = CHIP_ID_ADDR-&gt;ID_H;</span><br><span class="line">  <span class="comment">//高32位</span></span><br><span class="line">  chip_id-&gt;ID_M = CHIP_ID_ADDR-&gt;ID_M;</span><br><span class="line">  <span class="comment">//中32位</span></span><br><span class="line">  chip_id-&gt;ID_L = CHIP_ID_ADDR-&gt;ID_L;</span><br><span class="line">  <span class="comment">//低32位</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">ChipFlashSize_Get</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"><span class="comment">//获取芯片FLASH大小</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> (CHIP_FLASH_SIZE_ADDR &amp; <span class="number">0xFFFF</span>);</span><br><span class="line">  <span class="comment">//低16位为FLASH大小</span></span><br><span class="line">  <span class="comment">//一共32位于0xffff进行与运算，就是16位</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> STM32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> STM32 </tag>
            
            <tag> 序列号 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C_回调函数带参数</title>
      <link href="/2024/01/25/Qt/C_%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E5%B8%A6%E5%8F%82%E6%95%B0/"/>
      <url>/2024/01/25/Qt/C_%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E5%B8%A6%E5%8F%82%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="C-回调函数带参数"><a href="#C-回调函数带参数" class="headerlink" title="C_回调函数带参数"></a>C_回调函数带参数</h1><h2 id="回调函数带参数示例"><a href="#回调函数带参数示例" class="headerlink" title="回调函数带参数示例"></a>回调函数带参数示例</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">Callback_1</span><span class="params">(<span class="type">int</span> x)</span> <span class="comment">// Callback Function 1</span></span><br><span class="line"> </span><br><span class="line">&#123;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello, this is Callback_1: x = %d &quot;</span>, x);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">Handle</span><span class="params">(<span class="type">int</span> y, <span class="type">int</span> (*Callback)(<span class="type">int</span>))</span></span><br><span class="line"> </span><br><span class="line">&#123;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Entering Handle Function. &quot;</span>);</span><br><span class="line"> </span><br><span class="line">Callback(y);</span><br><span class="line"> </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Leaving Handle Function. &quot;</span>);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    Handle(<span class="number">10</span>, Callback_1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//运行结果:</span></span><br><span class="line"><span class="comment">//Entering Handle Function. Hello, this is Callback_1: x = 10 Leaving Handle Function.</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> C </tag>
            
            <tag> 回调函数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt_qDebug_重定向到日志</title>
      <link href="/2024/01/25/Qt/Qt_qDebug_%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%E6%97%A5%E5%BF%97/"/>
      <url>/2024/01/25/Qt/Qt_qDebug_%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%E6%97%A5%E5%BF%97/</url>
      
        <content type="html"><![CDATA[<h1 id="Qt-qDebug-重定向到日志"><a href="#Qt-qDebug-重定向到日志" class="headerlink" title="Qt_qDebug_重定向到日志"></a>Qt_qDebug_重定向到日志</h1><h2 id="实现思路及API含义"><a href="#实现思路及API含义" class="headerlink" title="实现思路及API含义"></a>实现思路及API含义</h2><ul><li>自定义一个函数作为消息处理器(customMessageHandler)，用于输出调试信息到文件中</li><li>使用qInstallMessageHandler函数注册自定义的消息处理器</li><li>qInstallMessageHandle注册回调函数后,会截断qt的默认输出，所有qDebug()、qInfo()、qWarning()、qCritical()等函数的输出都会通过自定义的消息处理器(customMessageHandler)处理,需要注意的一点是，自定义的消息处理器(customMessageHandler)的输出不会显示到控制台，需要显示到控制台，需要在自定义的消息处理器里使用qDebug()输出。</li></ul><h2 id="取消信息处理-一般不取消"><a href="#取消信息处理-一般不取消" class="headerlink" title="取消信息处理 (一般不取消)"></a>取消信息处理 (一般不取消)</h2><p>只要执行qInstallMessageHandler(0) 就行，但是这会把所有的信息输出都屏蔽掉！</p><p>如果只是想屏蔽debug或者warning信息的输出，这时候就需要预定义宏：<br>在工程文件.pro里面添加</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DEFINES += QT_NO_WARNING_OUTPUT\</span><br><span class="line">QT_NO_DEBUG_OUTPUT</span><br></pre></td></tr></table></figure><p>然后重新构建，这样就能去掉qDebug的打印信息了。<br>也可以设置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Release:DEFINES += QT_NO_WARNING_OUTPUT\</span><br><span class="line">QT_NO_DEBUG_OUTPUT</span><br></pre></td></tr></table></figure><p>这样只是在Release版本的时候不打印对应调试和警告消息。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTextStream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDateTime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMutex&gt;</span></span></span><br><span class="line"><span class="type">static</span> QMutex mutex;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">customMessageHandler</span><span class="params">(QtMsgType type,</span></span></span><br><span class="line"><span class="params"><span class="function">                          <span class="type">const</span> QMessageLogContext &amp;context,</span></span></span><br><span class="line"><span class="params"><span class="function">                          <span class="type">const</span> QString &amp;msg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//QMutexLocker locker(&amp;mutex);  //自动释放锁</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//Q_UNUSED(context)</span></span><br><span class="line">    QDateTime _datetime = QDateTime::<span class="built_in">currentDateTime</span>();</span><br><span class="line">    QString szDate = _datetime.<span class="built_in">toString</span>(<span class="string">&quot;hh:mm:ss.zzz&quot;</span>);<span class="comment">//&quot;yyyy-MM-dd hh:mm:ss ddd&quot;</span></span><br><span class="line">    <span class="function">QString <span class="title">txt</span><span class="params">(szDate)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (type)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> QtDebugMsg:<span class="comment">//调试信息提示</span></span><br><span class="line">    &#123;</span><br><span class="line">        txt += <span class="built_in">QString</span>(<span class="string">&quot; [Debug] &quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> QtInfoMsg:<span class="comment">//信息输出</span></span><br><span class="line">    &#123;</span><br><span class="line">        txt += <span class="built_in">QString</span>(<span class="string">&quot; [Info] &quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> QtWarningMsg:<span class="comment">//一般的warning提示</span></span><br><span class="line">    &#123;</span><br><span class="line">        txt += <span class="built_in">QString</span>(<span class="string">&quot; [Warning] &quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> QtCriticalMsg:<span class="comment">//严重错误提示</span></span><br><span class="line">    &#123;</span><br><span class="line">        txt += <span class="built_in">QString</span>(<span class="string">&quot; [Critical] &quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> QtFatalMsg:<span class="comment">//致命错误提示</span></span><br><span class="line">    &#123;</span><br><span class="line">        txt += <span class="built_in">QString</span>(<span class="string">&quot; [Fatal] &quot;</span>);</span><br><span class="line">        <span class="comment">//abort();</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    &#123;</span><br><span class="line">        txt += <span class="built_in">QString</span>(<span class="string">&quot; [Trace] &quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    txt.<span class="built_in">append</span>( <span class="built_in">QString</span>(<span class="string">&quot; %1&quot;</span>).<span class="built_in">arg</span>(context.file) );</span><br><span class="line">    txt.<span class="built_in">append</span>( <span class="built_in">QString</span>(<span class="string">&quot;&lt;%1&gt;: &quot;</span>).<span class="built_in">arg</span>(context.line) );</span><br><span class="line">    txt.<span class="built_in">append</span>(msg);</span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;txt;</span><br><span class="line"></span><br><span class="line">    mutex.<span class="built_in">lock</span>();</span><br><span class="line">    <span class="comment">//一天一个日志</span></span><br><span class="line">    <span class="function">QString <span class="title">fileName</span><span class="params">( <span class="string">&quot;./日志//&quot;</span> + _datetime.toString(<span class="string">&quot;yyyy-MM-dd&quot;</span>) + <span class="string">&quot;.log&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(fileName)</span></span>;</span><br><span class="line">    file.<span class="built_in">open</span>(QIODevice::WriteOnly | QIODevice::Append);</span><br><span class="line">    <span class="function">QTextStream <span class="title">text_stream</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line">    text_stream &lt;&lt; txt &lt;&lt; <span class="string">&quot;\r\n&quot;</span>;</span><br><span class="line">    file.<span class="built_in">flush</span>();</span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">    mutex.<span class="built_in">unlock</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注册MessageHandler</span></span><br><span class="line">    <span class="built_in">qInstallMessageHandler</span>(customMessageHandler);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;this is QtDebugMsg&quot;</span>;</span><br><span class="line">    <span class="built_in">qInfo</span>() &lt;&lt; <span class="string">&quot;this is QtInfoMsg&quot;</span>;</span><br><span class="line">    <span class="built_in">qWarning</span>() &lt;&lt; <span class="string">&quot;this is QtWarningMsg&quot;</span>;</span><br><span class="line">    <span class="built_in">qCritical</span>() &lt;&lt; <span class="string">&quot;this is QtCriticalMsg&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//GBK修饰的输出带双引号,GBK_LOG修饰的不会带双引号</span></span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; (<span class="string">&quot;测试qDebug&quot;</span>);</span><br><span class="line">    <span class="built_in">qInfo</span>() &lt;&lt; (<span class="string">&quot;测试qInfo&quot;</span>);</span><br><span class="line">    <span class="built_in">qWarning</span>() &lt;&lt; (<span class="string">&quot;测试qWarning&quot;</span>);</span><br><span class="line">    <span class="built_in">qCritical</span>() &lt;&lt; (<span class="string">&quot;测试qCritical&quot;</span>);</span><br><span class="line">    <span class="comment">//qFatal() &lt;&lt; &quot;QtFatalMsg&quot;;</span></span><br><span class="line">    <span class="comment">//qFatal(&quot;This is a fatal message&quot;);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nvidia随手笔记</title>
      <link href="/2023/12/14/%E7%BB%BC%E5%90%88/%E5%8D%9A%E5%AE%A2/Nvidia%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/12/14/%E7%BB%BC%E5%90%88/%E5%8D%9A%E5%AE%A2/Nvidia%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="Nvidia"><a href="#Nvidia" class="headerlink" title="Nvidia"></a>Nvidia</h1><h2 id="显卡驱动"><a href="#显卡驱动" class="headerlink" title="显卡驱动"></a>显卡驱动</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ol><li>安装驱动stuido版本，不安装game</li><li>安装visual studio 2022</li><li>安装cuda11.6</li><li>安装cudnn</li></ol><h2 id="CUDA"><a href="#CUDA" class="headerlink" title="CUDA"></a>CUDA</h2><p><a href="https://blog.csdn.net/chen565884393/article/details/127905428">CUDA,cudnn,版本对应，参考文档</a></p><h2 id="cudnn"><a href="#cudnn" class="headerlink" title="cudnn"></a>cudnn</h2><h2 id="安装完重启电脑"><a href="#安装完重启电脑" class="headerlink" title="安装完重启电脑"></a>安装完重启电脑</h2><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ol><li>visual studio 创建cuda runtime项目，直接运行</li><li>终端窗口弹出数组计算结果</li></ol>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> 深度学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 英伟达 </tag>
            
            <tag> Nvidia </tag>
            
            <tag> GPU </tag>
            
            <tag> CUDA </tag>
            
            <tag> cudnn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nssm随手笔记</title>
      <link href="/2023/12/14/%E7%BB%BC%E5%90%88/%E5%8D%9A%E5%AE%A2/nssm%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/12/14/%E7%BB%BC%E5%90%88/%E5%8D%9A%E5%AE%A2/nssm%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="nssm随手笔记"><a href="#nssm随手笔记" class="headerlink" title="nssm随手笔记"></a>nssm随手笔记</h1><h2 id="nssm查看已经安装的服务"><a href="#nssm查看已经安装的服务" class="headerlink" title="nssm查看已经安装的服务"></a>nssm查看已经安装的服务</h2><ul><li>打开powershell,输入</li><li><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-WmiObject win32_service | ?&#123;$_.PathName -like &#x27;*nssm*&#x27;&#125; | select Name, DisplayName, State, PathName</span><br></pre></td></tr></table></figure></li></ul><h2 id="nssm安装服务"><a href="#nssm安装服务" class="headerlink" title="nssm安装服务"></a>nssm安装服务</h2><ul><li>打开powershell,输入</li><li><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nssm install &lt;服务名&gt; &lt;路径&gt;</span><br></pre></td></tr></table></figure></li><li>例如<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nssm install myservice &quot;C:\Program Files\myservice\myservice.exe&quot;</span><br></pre></td></tr></table></figure></li><li>注意: 路径中不能有空格</li></ul><h2 id="nssm卸载服务"><a href="#nssm卸载服务" class="headerlink" title="nssm卸载服务"></a>nssm卸载服务</h2><ul><li>打开powershell,输入</li><li><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nssm remove &lt;服务名&gt;</span><br></pre></td></tr></table></figure></li><li>例如<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nssm remove myservice</span><br></pre></td></tr></table></figure></li></ul><h2 id="编辑已安装的服务"><a href="#编辑已安装的服务" class="headerlink" title="编辑已安装的服务"></a>编辑已安装的服务</h2><ul><li>打开powershell,输入</li><li><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nssm edit &lt;服务名&gt;</span><br></pre></td></tr></table></figure></li><li>例如<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nssm edit myservice</span><br></pre></td></tr></table></figure></li><li>编辑后,按下ctrl+s保存</li></ul><h2 id="启动已安装的服务"><a href="#启动已安装的服务" class="headerlink" title="启动已安装的服务"></a>启动已安装的服务</h2><ul><li>打开powershell,输入</li><li></li></ul><pre><code>nssm start &lt;服务名&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
            <tag> 环境 </tag>
            
            <tag> 启动 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MDK编码</title>
      <link href="/2023/12/12/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/%E7%BC%96%E7%A8%8B/MDK%E7%BC%96%E7%A0%81/"/>
      <url>/2023/12/12/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/%E7%BC%96%E7%A8%8B/MDK%E7%BC%96%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="MDK编码"><a href="#MDK编码" class="headerlink" title="MDK编码"></a>MDK编码</h1><h2 id="MDK使用utf-8"><a href="#MDK使用utf-8" class="headerlink" title="MDK使用utf-8"></a>MDK使用utf-8</h2><h3 id="设置项目编码为utf-8"><a href="#设置项目编码为utf-8" class="headerlink" title="设置项目编码为utf-8"></a>设置项目编码为utf-8</h3><blockquote><p><img src="/.com//MDK%E7%BC%96%E7%A0%81/1711533489853.png" alt="1711533489853"></p></blockquote><h3 id="设置编译格式为utf-8"><a href="#设置编译格式为utf-8" class="headerlink" title="设置编译格式为utf-8"></a>设置编译格式为utf-8</h3><blockquote><p><img src="/.com//MDK%E7%BC%96%E7%A0%81/1711533503607.png" alt="1711533503607"></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> STM32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MDK </tag>
            
            <tag> VScode </tag>
            
            <tag> 编码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>复卷定长校准使用说明</title>
      <link href="/2023/12/07/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E5%A4%8D%E5%8D%B7%E5%AE%9A%E9%95%BF%E6%A0%A1%E5%87%86%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/"/>
      <url>/2023/12/07/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E5%A4%8D%E5%8D%B7%E5%AE%9A%E9%95%BF%E6%A0%A1%E5%87%86%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<h1 id="复卷定长校准使用说明"><a href="#复卷定长校准使用说明" class="headerlink" title="复卷定长校准使用说明"></a>复卷定长校准使用说明</h1><h2 id="定长贴标"><a href="#定长贴标" class="headerlink" title="定长贴标"></a>定长贴标</h2><ol><li>主线每隔一定距离贴一个标签</li><li>复卷机检测标签进行米数校准</li><li>若丢失标签则待检测到下一个标签校准</li><li>校准规则：以贴标间隔米数的一半为分界线，大于则向上取整，小于则向下取整。</li></ol><h2 id="卷尾贴标"><a href="#卷尾贴标" class="headerlink" title="卷尾贴标"></a>卷尾贴标</h2><ol><li>主线必须使用卷尾贴标</li><li>首个校准缺陷必须是卷尾贴的标</li><li>复卷探测卷尾标签，必须小于，定长贴标的间隔&#x2F;2的米数</li><li>手动停机到卷尾标签位置，同步校准即可</li><li>异常恢复：<ol><li>手动停机到定长标签位置</li><li>报表中找到该标签</li><li>右键发送给PLC</li><li>再校准即可。</li></ol></li></ol><h2 id="定长设置页面"><a href="#定长设置页面" class="headerlink" title="定长设置页面"></a>定长设置页面</h2><p><img src="/.com//%E5%A4%8D%E5%8D%B7%E5%AE%9A%E9%95%BF%E6%A0%A1%E5%87%86%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/1711531619486.png" alt="1711531619486"></p><h2 id="通道加补偿值"><a href="#通道加补偿值" class="headerlink" title="通道加补偿值"></a>通道加补偿值</h2><p>设置减补偿值</p><p>配置工具-&gt;定长页面-&gt;点击通道加补偿</p><h2 id="通道减补偿值"><a href="#通道减补偿值" class="headerlink" title="通道减补偿值"></a>通道减补偿值</h2><p>设置通道减补偿值</p><p>配置工具-&gt;定长页面-&gt;点击通道减补偿</p><h2 id="贴标间隔米数"><a href="#贴标间隔米数" class="headerlink" title="贴标间隔米数"></a>贴标间隔米数</h2><p>设置贴标间隔米数</p><p>配置工具-&gt;定长页面-&gt;点击贴标间隔米数</p><h2 id="探标补偿米数"><a href="#探标补偿米数" class="headerlink" title="探标补偿米数"></a>探标补偿米数</h2><p>设置</p><p>配置工具-&gt;定长页面-&gt;显示探标补偿米数</p><p>可手动修改</p><h2 id="18个通道单独补偿停机距离"><a href="#18个通道单独补偿停机距离" class="headerlink" title="18个通道单独补偿停机距离"></a>18个通道单独补偿停机距离</h2><ol><li>每个通道都有两个按钮，分别为停机位置加按钮，和停机位置减按钮</li><li>输入点从X14开始</li><li>X14<del>X35为通道1</del>通道18的加补偿</li><li>X36<del>X57为通道19</del>通道36的减补偿</li></ol>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 复卷瑕疵定位系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 复卷瑕疵定位系统 </tag>
            
            <tag> 复卷 </tag>
            
            <tag> 方案 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>光源控制器</title>
      <link href="/2023/12/05/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%85%89%E6%BA%90%E6%8E%A7%E5%88%B6%E5%99%A8/%E5%85%89%E6%BA%90%E6%8E%A7%E5%88%B6%E5%99%A8/"/>
      <url>/2023/12/05/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%85%89%E6%BA%90%E6%8E%A7%E5%88%B6%E5%99%A8/%E5%85%89%E6%BA%90%E6%8E%A7%E5%88%B6%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="光源控制器"><a href="#光源控制器" class="headerlink" title="光源控制器"></a>光源控制器</h1><h2 id="产品介绍"><a href="#产品介绍" class="headerlink" title="产品介绍"></a>产品介绍</h2><blockquote><ul><li>光源控制器，用于控制光源的亮度。</li><li>两个输出通道。</li></ul></blockquote><h2 id="接线图"><a href="#接线图" class="headerlink" title="接线图"></a>接线图</h2><h2 id="通信协议"><a href="#通信协议" class="headerlink" title="通信协议"></a>通信协议</h2>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 光源控制器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 光源控制器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>yolov8随手记</title>
      <link href="/2023/12/05/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/yolov8%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
      <url>/2023/12/05/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/yolov8%E9%9A%8F%E6%89%8B%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="yolov8随手记"><a href="#yolov8随手记" class="headerlink" title="yolov8随手记"></a>yolov8随手记</h1><h2 id="1-环境配置"><a href="#1-环境配置" class="headerlink" title="1. 环境配置"></a>1. 环境配置</h2><h2 id="安装conda"><a href="#安装conda" class="headerlink" title="安装conda"></a>安装conda</h2><p><a href="https://www.anaconda.com/download/">conda官网下载</a></p><ul><li>下载windows版</li><li>安装要点：<br><img src="/.com//yolov8%E9%9A%8F%E6%89%8B%E8%AE%B0/1711531751763.png" alt="1711531751763"></li><li>安装位置：随意<br><img src="/.com//yolov8%E9%9A%8F%E6%89%8B%E8%AE%B0/1711531760380.png" alt="1711531760380"></li></ul><h2 id="安装pycharm社区版"><a href="#安装pycharm社区版" class="headerlink" title="安装pycharm社区版"></a>安装pycharm社区版</h2><p><a href="https://www.jetbrains.com/pycharm/download/?section=windows">pycharm官网下载</a></p><ul><li>下载社区版</li></ul><p><img src="/.com//yolov8%E9%9A%8F%E6%89%8B%E8%AE%B0/1711531770497.png" alt="1711531770497"></p><ul><li>若有需要勾选的，全部勾选</li></ul><h3 id="创建conda的yolov8虚拟环境"><a href="#创建conda的yolov8虚拟环境" class="headerlink" title="创建conda的yolov8虚拟环境"></a>创建conda的yolov8虚拟环境</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda create -n yolov8 python=3.10</span><br><span class="line">conda activate yolov8</span><br></pre></td></tr></table></figure><h3 id="1-3-安装pytorch"><a href="#1-3-安装pytorch" class="headerlink" title="1.3 安装pytorch"></a>1.3 安装pytorch</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install pytorch torchvision torchaudio cudatoolkit=11.3 -c pytorch</span><br></pre></td></tr></table></figure><h3 id="1-4-安装yolov8"><a href="#1-4-安装yolov8" class="headerlink" title="1.4 安装yolov8"></a>1.4 安装yolov8</h3><p>先安装pytorch，后安装yolov8，否则会被先安装一个pytorch-cpu</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install ultralytics</span><br></pre></td></tr></table></figure><h2 id="2-使用yolov8"><a href="#2-使用yolov8" class="headerlink" title="2. 使用yolov8"></a>2. 使用yolov8</h2><h3 id="2-1-训练模型"><a href="#2-1-训练模型" class="headerlink" title="2.1 训练模型"></a>2.1 训练模型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> ultralytics <span class="keyword">import</span> YOLO</span><br><span class="line"></span><br><span class="line">model = YOLO(<span class="string">&quot;yolov8n.yaml&quot;</span>)</span><br><span class="line">model = YOLO(<span class="string">&quot;yolov8n.pt&quot;</span>)</span><br><span class="line">model = YOLO(<span class="string">&quot;yolov8n.yaml&quot;</span>).load(<span class="string">&quot;yolov8n.pt&quot;</span>)</span><br><span class="line"></span><br><span class="line">model.train(data=<span class="string">&quot;C:/Users/fengj/Desktop/demo2/data.yaml&quot;</span>,epochs=<span class="number">100</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-2-模型预测"><a href="#2-2-模型预测" class="headerlink" title="2.2 模型预测"></a>2.2 模型预测</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> ultralytics <span class="keyword">import</span> YOLO</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载模型</span></span><br><span class="line"><span class="comment"># model = YOLO(&#x27;yolov8n.pt&#x27;)  # 加载官方模型</span></span><br><span class="line">model = YOLO(<span class="string">&#x27;best.pt&#x27;</span>, task=<span class="string">&quot;detect&quot;</span>)  <span class="comment"># 加载自定义模型</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用模型进行预测</span></span><br><span class="line">results = model(<span class="string">&quot;C:/Users/fengj/Desktop/demo2/val/images/&quot;</span>, save = <span class="literal">True</span> , conf = <span class="number">0.25</span>)  <span class="comment"># 对图像进行预测</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3-重要参数"><a href="#3-重要参数" class="headerlink" title="3. 重要参数"></a>3. 重要参数</h2><p>batch</p><ul><li>训练时，batch_size的大小，越大越快，但是占用内存也会变大</li><li>预测时，batch_size的大小，越大越快，但是占用内存也会变大</li><li>一般情况下，batch_size&#x3D;64</li></ul><p>epochs</p><ul><li>训练时，迭代次数，越大越快，但是精度也会变低</li><li>预测时，迭代次数，越大越快，但是占用内存也会变大</li><li>一般情况下，epochs&#x3D;100</li></ul><p>conf</p><ul><li>预测时，置信度阈值，越大越精准，但是占用内存也会变大</li><li>一般情况下，conf&#x3D;0.25</li></ul><h2 id="4-训练数据准备"><a href="#4-训练数据准备" class="headerlink" title="4. 训练数据准备"></a>4. 训练数据准备</h2><h3 id="4-1-训练数据格式"><a href="#4-1-训练数据格式" class="headerlink" title="4.1 训练数据格式"></a>4.1 训练数据格式</h3><ul><li>使用labelme，无需转换格式</li><li>使用labelimg，需要转换格式</li></ul><h3 id="4-2-训练数据标注"><a href="#4-2-训练数据标注" class="headerlink" title="4.2 训练数据标注"></a>4.2 训练数据标注</h3><ul><li>标注工具：labelme</li><li>标注步骤：<ul><li>打开labelme，点击文件-&gt;打开数据集</li><li>选择数据集，点击打开</li><li>标注数据，点击标注</li><li>标注完成，点击保存</li><li>导出数据，点击导出数据集</li><li>选择数据集，点击保存</li><li>选择保存路径，点击保存</li><li>选择格式，选择yolo</li><li>选择保存路径，点击保存</li></ul></li><li></li></ul>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> yolov8 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> conda </tag>
            
            <tag> python </tag>
            
            <tag> yolov8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>conda随手记</title>
      <link href="/2023/12/05/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/conda%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
      <url>/2023/12/05/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/conda%E9%9A%8F%E6%89%8B%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="conda随手记"><a href="#conda随手记" class="headerlink" title="conda随手记"></a>conda随手记</h1><h2 id="创建虚拟环境"><a href="#创建虚拟环境" class="headerlink" title="创建虚拟环境"></a>创建虚拟环境</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create -n env_name python=3.8</span><br></pre></td></tr></table></figure><h2 id="激活虚拟环境"><a href="#激活虚拟环境" class="headerlink" title="激活虚拟环境"></a>激活虚拟环境</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda activate env_name</span><br></pre></td></tr></table></figure><h2 id="退出虚拟环境"><a href="#退出虚拟环境" class="headerlink" title="退出虚拟环境"></a>退出虚拟环境</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda deactivate</span><br></pre></td></tr></table></figure><h2 id="删除虚拟环境"><a href="#删除虚拟环境" class="headerlink" title="删除虚拟环境"></a>删除虚拟环境</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda remove -n env_name --all</span><br></pre></td></tr></table></figure><h2 id="查看已创建的虚拟环境"><a href="#查看已创建的虚拟环境" class="headerlink" title="查看已创建的虚拟环境"></a>查看已创建的虚拟环境</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda env list</span><br></pre></td></tr></table></figure><h2 id="安装包"><a href="#安装包" class="headerlink" title="安装包"></a>安装包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install package_name</span><br></pre></td></tr></table></figure><h2 id="更新包"><a href="#更新包" class="headerlink" title="更新包"></a>更新包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda update package_name</span><br></pre></td></tr></table></figure><h2 id="删除包"><a href="#删除包" class="headerlink" title="删除包"></a>删除包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda remove package_name</span><br></pre></td></tr></table></figure><h2 id="安装pip包"><a href="#安装pip包" class="headerlink" title="安装pip包"></a>安装pip包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install package_name</span><br></pre></td></tr></table></figure><h2 id="更新pip包"><a href="#更新pip包" class="headerlink" title="更新pip包"></a>更新pip包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -U package_name</span><br></pre></td></tr></table></figure><h2 id="删除pip包"><a href="#删除pip包" class="headerlink" title="删除pip包"></a>删除pip包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip uninstall package_name</span><br></pre></td></tr></table></figure><h2 id="安装jupyter"><a href="#安装jupyter" class="headerlink" title="安装jupyter"></a>安装jupyter</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install jupyter</span><br></pre></td></tr></table></figure><h2 id="安装jupyterlab"><a href="#安装jupyterlab" class="headerlink" title="安装jupyterlab"></a>安装jupyterlab</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install jupyterlab</span><br></pre></td></tr></table></figure><h2 id="安装jupyterlab-git"><a href="#安装jupyterlab-git" class="headerlink" title="安装jupyterlab-git"></a>安装jupyterlab-git</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install -c conda-forge jupyterlab-git</span><br></pre></td></tr></table></figure><h2 id="pycharm加载conda虚拟环境"><a href="#pycharm加载conda虚拟环境" class="headerlink" title="pycharm加载conda虚拟环境"></a>pycharm加载conda虚拟环境</h2>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> conda </category>
          
      </categories>
      
      
        <tags>
            
            <tag> conda </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>扩散模型</title>
      <link href="/2023/12/01/%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/"/>
      <url>/2023/12/01/%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="培训-扩散模型"><a href="#培训-扩散模型" class="headerlink" title="培训-扩散模型"></a>培训-扩散模型</h1><h2 id="大模型-视觉类模型-多模态的方向-语言和成像-做缺陷图-AI生成图"><a href="#大模型-视觉类模型-多模态的方向-语言和成像-做缺陷图-AI生成图" class="headerlink" title="大模型&#x2F;视觉类模型&#x2F;多模态的方向&#x2F;语言和成像&#x2F;做缺陷图&#x2F;AI生成图"></a>大模型&#x2F;视觉类模型&#x2F;多模态的方向&#x2F;语言和成像&#x2F;做缺陷图&#x2F;AI生成图</h2><p>主讲人：张星</p><p><a href="zhangxingai.github.io">讲述人博客</a></p><p>1.扩散模型，Stable Diffusion原理与实践，主要再这个文档</p><p>VAE模型，文本模型子训练</p><p>CLIP 图片和文本混合编码</p><p>U_net网络学习框架</p><p>Refiner模型，构建，在最后一步 图生图，分辨率增强</p><p>主要看VAE模型</p><p>VAE的原理主要是，把输入图片像素，编码混合高斯分布，增强学习效率，解码分布采样，加噪声，训练噪声分布</p><p>常用的stable diffusion模型，</p><p>checkpoint 模型（大模型），他用很大成本训练yumoxing，我们可以用微调模型</p><p>Textual Inversion</p><p>LoRA模型</p><p>训练的与大模型相似，把大模型亲量化</p><p>训练好的插入，</p><p>U-net采样器，Sampler，，条件苛刻，若成功效果应该较好</p><p>文生图，</p><p>图生图，输入的图片学习噪声的分布，根据超参数的调整，生成一个高清分辨率的图片</p><p>最近出来的额还有一些应用像inpainting，圈定一个范围，猫或狗，，，，</p><p>实践</p><p>主流的运行扩散模型的，</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532006934.png" alt="1711532006934"></p><p>建议用第一种，可以研究第二种</p><p>安装，不讲了</p><p>训练，</p><p>准备训练的数据集，</p><p>准备图片，比如说，我这里有很多的图片，有褶皱，污点，胶带，</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532021478.png" alt="1711532021478"></p><p>所处分类的文件夹的子文件</p><p>用图片剪裁工具，剪裁为1024*1024，官方建议的图片大小，16的整数倍，</p><p>会生成同名的tic文件</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532030736.png" alt="1711532030736"></p><p>标签，<br>输入可以用脚本批量生成</p><p>名字，，，</p><p>准备好数据集后，，</p><p>打开页面</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532039164.png" alt="1711532039164"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532047806.png" alt="1711532047806"></p><p>在</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532056180.png" alt="1711532056180"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532066440.png" alt="1711532066440"></p><p>需要注意图片文件夹一定要，，，先建一个子文件夹，，固定设定的，，</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532074140.png" alt="1711532074140"></p><p>npz后面产生的</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532090580.png" alt="1711532090580"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532101626.png" alt="1711532101626"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532115142.png" alt="1711532115142"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532122930.png" alt="1711532122930"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532131948.png" alt="1711532131948"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532139502.png" alt="1711532139502"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532148173.png" alt="1711532148173"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532155360.png" alt="1711532155360"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711532164329.png" alt="1711532164329"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711533351854.png" alt="1711533351854"></p><p>高级参数默认，，，use xformers勾选，</p><p>clip skip 写实的用1，动画的用2</p><p>点start training</p><p>训练好的模型放到model文件夹里，</p><p>权重设为1，打入标签，qianzhiya，zhezhou，加入花纹</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711533361681.png" alt="1711533361681"></p><p>点生成，会读条，</p><p>采样步数低于30，要大于30</p><p>采样器可以一个一个试</p><p>refiner不太适合卫品，</p><p>种子数-1可以不用调</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711533371078.png" alt="1711533371078"></p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711533378867.png" alt="1711533378867"></p><p>改为1，是不进行精细化处理</p><p>0.8，后面25~30会出现很假，绘画，不真的情况</p><p>改一个采样器，，效果明显不行</p><p>污点花纹，，等，，图片很假，就调采样器</p><p>可以迁移其它产品的花纹</p><p>不断试参数，采样器就可以<br><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711533387915.png" alt="1711533387915"></p><p>可以优化的方法，数据集可以再优化一下。（我这里比较原始）</p><hr><p>缺陷类型是什么，</p><p>训练的时候打了什么标签，生成的时候就可以</p><p>优点是，有的产品有这个缺陷，另外的产品没有这个缺陷，可以让另外产品产生这个缺陷</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711533396206.png" alt="1711533396206"></p><p>缺陷位置生成的随机</p><p>标签越多的话生成的越真实，</p><p>类比输入熊猫，</p><p><img src="/.com//%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/1711533404498.png" alt="1711533404498"></p><p>加个胶带，很真实</p><p>根据训练集来，</p>]]></content>
      
      
      <categories>
          
          <category> 培训 </category>
          
          <category> 张星 </category>
          
          <category> 扩散模型 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 扩散模型 </tag>
            
            <tag> AI </tag>
            
            <tag> 生成式AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>控制器V10</title>
      <link href="/2023/11/28/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8E%A7%E5%88%B6%E5%99%A8/%E6%8E%A7%E5%88%B6%E5%99%A8V10/"/>
      <url>/2023/11/28/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8E%A7%E5%88%B6%E5%99%A8/%E6%8E%A7%E5%88%B6%E5%99%A8V10/</url>
      
        <content type="html"><![CDATA[<h1 id="控制器V10"><a href="#控制器V10" class="headerlink" title="控制器V10"></a>控制器V10</h1><h2 id="核心板"><a href="#核心板" class="headerlink" title="核心板"></a>核心板</h2><ol><li>主芯片</li><li>晶振</li><li>5V转3.3V</li><li>电源指示灯</li><li>2<em>2</em>25排针IO</li><li>2<em>2</em>4排针电源</li></ol><h2 id="主板"><a href="#主板" class="headerlink" title="主板"></a>主板</h2><ol><li>串口</li><li>网口</li><li>IO输入*6</li><li>电源芯片MP2403</li><li>NMOS输出*8</li><li>DIFF输出*8</li><li>2<em>2</em>25排母IO</li><li>2<em>2</em>4排母电源</li><li>2<em>2</em>20IO弯针扩展</li></ol>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 控制器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 控制器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>羊蝎子火锅</title>
      <link href="/2023/11/27/%E6%97%A5%E5%B8%B8/%E7%94%9F%E6%B4%BB/%E7%BE%8A%E8%9D%8E%E5%AD%90%E7%81%AB%E9%94%85/"/>
      <url>/2023/11/27/%E6%97%A5%E5%B8%B8/%E7%94%9F%E6%B4%BB/%E7%BE%8A%E8%9D%8E%E5%AD%90%E7%81%AB%E9%94%85/</url>
      
        <content type="html"><![CDATA[<h1 id="羊蝎子火锅"><a href="#羊蝎子火锅" class="headerlink" title="羊蝎子火锅"></a>羊蝎子火锅</h1><h2 id="材料"><a href="#材料" class="headerlink" title="材料"></a>材料</h2><table><thead><tr><th>材料</th><th>用量</th></tr></thead><tbody><tr><td>羊蝎子</td><td>1000g</td></tr><tr><td>大葱</td><td>适量一段</td></tr><tr><td>姜</td><td>三五片</td></tr><tr><td>蒜</td><td>三五个</td></tr><tr><td>肉桂</td><td>半个左右</td></tr><tr><td>白芷</td><td>两三个</td></tr><tr><td>香叶</td><td>两三片</td></tr><tr><td>花椒</td><td>适量一把</td></tr><tr><td>青花椒</td><td>适量一把</td></tr><tr><td>干辣椒</td><td>五到七个，掰开</td></tr><tr><td>小茴香</td><td>一小把</td></tr><tr><td>豆瓣酱</td><td>适量</td></tr><tr><td>黄豆酱</td><td>适量</td></tr></tbody></table><h2 id="做法步骤"><a href="#做法步骤" class="headerlink" title="做法步骤"></a>做法步骤</h2><ol><li>羊蝎子洗净，泡水1小时，泡出血水，再次洗净</li><li>羊蝎子焯水，撇去黑色血沫，再捞出来洗净，放一旁备用</li><li>大葱切段，姜切片，拍蒜，肉桂半个，白芷，香叶，花椒，青花椒，辣椒，小茴香</li><li>准备一个小碗，放入一勺豆瓣酱，两勺黄豆酱</li><li>清洗香料，起锅烧油，放入大葱，姜，蒜，炒香后，放入剩下香料。再次炒香</li><li>倒入豆瓣酱和黄豆酱，再次炒香。</li><li>后倒入适量水。</li><li>锅开后，倒入砂锅（煮锅）转小火，加入羊蝎子。煮一个小时。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 美食 </category>
          
          <category> 火锅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 火锅 </tag>
            
            <tag> 羊蝎子 </tag>
            
            <tag> 美食 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>黄冈稳健</title>
      <link href="/2023/11/27/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E9%BB%84%E5%86%88%E7%A8%B3%E5%81%A5/"/>
      <url>/2023/11/27/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E9%BB%84%E5%86%88%E7%A8%B3%E5%81%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="黄冈稳健异纤检测后剔除方案"><a href="#黄冈稳健异纤检测后剔除方案" class="headerlink" title="黄冈稳健异纤检测后剔除方案"></a>黄冈稳健异纤检测后剔除方案</h1><h2 id="相机拍照方案一"><a href="#相机拍照方案一" class="headerlink" title="相机拍照方案一"></a>相机拍照方案一</h2><ul><li>帧触发</li><li>帧信号校准图像原点位置</li></ul><h2 id="相机拍照方案二"><a href="#相机拍照方案二" class="headerlink" title="相机拍照方案二"></a>相机拍照方案二</h2><ul><li>行触发</li><li>相机图像完成信号校准图像原点位置</li></ul><h2 id="缺陷处理方案一"><a href="#缺陷处理方案一" class="headerlink" title="缺陷处理方案一"></a>缺陷处理方案一</h2><ul><li>小工位模式+串口组网联机</li><li>1工控机+8控制器</li></ul><h2 id="小工位方案简述"><a href="#小工位方案简述" class="headerlink" title="小工位方案简述"></a>小工位方案简述</h2><ul><li>以图像为基准作为一个基准工位</li><li>图像分割为255份作为小工位</li><li>可以单点踢废，踢废长度为设定值</li><li>可以连续踢废，会回溯一定范围的距离（可设定），从有缺陷的位置开始，到接收到连续踢废的位置结束</li></ul><h3 id="小工位方案通信协议简述"><a href="#小工位方案通信协议简述" class="headerlink" title="小工位方案通信协议简述"></a>小工位方案通信协议简述</h3><ul><li>单点踢废：31 01 00 01  相机1，第1个小工位，踢废IO为1</li><li>连续踢废：10 03 e9 00 01 55   通道1的连续踢废指令</li><li>设定连续范围： 10 03 e8 01 01 55 判定是否为连续缺陷的回溯范围</li></ul><h2 id="需改动的点"><a href="#需改动的点" class="headerlink" title="需改动的点"></a>需改动的点</h2><ul><li>完成组网协议</li><li>组网踢废</li><li>优化执行效率</li><li>增加指定范围的连续缺陷协议</li></ul><h3 id="组网协议"><a href="#组网协议" class="headerlink" title="组网协议"></a>组网协议</h3><ul><li>沿用小工位模式的通信协议，从机站号以通信首地址区分。</li></ul><h3 id="组网踢废"><a href="#组网踢废" class="headerlink" title="组网踢废"></a>组网踢废</h3><ul><li>单点&#x2F;大面积协议指令：10 01 03 ea 01 01 ff 01  站号1，相机1的第一个通道缺陷长度255,缺陷位置1</li></ul><table><thead><tr><th>功能</th><th>字节</th><th>取值</th><th>备注</th></tr></thead><tbody><tr><td>起始位</td><td>0x10</td><td>0x10</td><td>固定格式</td></tr><tr><td>站号</td><td>0x01</td><td>0x00~0xff</td><td>站号</td></tr><tr><td>地址高位</td><td>0x03</td><td>0x00~0xff</td><td>和地址低位共同组成地址位，判断其功能</td></tr><tr><td>地址地位</td><td>0xea</td><td>0x00~0xff</td><td>和地址高位共同组成地址位，判断其功能</td></tr><tr><td>kickid号</td><td>0x01</td><td>0x00~0x02</td><td>对应kickid号</td></tr><tr><td>踢废通道</td><td>0x01</td><td>0x00~0x08</td><td>对应8个通道</td></tr><tr><td>踢废长度</td><td>0xff</td><td>0x01~0xff</td><td>对应踢废1~255个小工位</td></tr><tr><td>踢废位置</td><td>0xff</td><td>0x01~0xff</td><td>对应踢废1~255个工位</td></tr></tbody></table><h3 id="黄冈稳健-硬件配置"><a href="#黄冈稳健-硬件配置" class="headerlink" title="黄冈稳健-硬件配置"></a>黄冈稳健-硬件配置</h3><ul><li>一排相机，两个8K</li><li>60路踢废通道</li><li>帧触发拍照</li><li>一台工控机，八个控制器</li><li>编码器型号1000</li><li>串口通信-232转485</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">231129记录</span><br><span class="line"></span><br><span class="line">黄冈稳健：</span><br><span class="line">1. 2个8K相机，每个相机约24个通道，分成3个控制器</span><br><span class="line">2. 速度100米，编码器可能是1000，换算成1000图像高度，是5.5帧，每个相机一张图保留10个缺陷</span><br><span class="line">3. 波特率115200，每秒可发11.52K个字节</span><br><span class="line">4. 两个相机都往一个串口发，可能会存在互锁的情况</span><br><span class="line">5. 增加控制器编号，每个控制器接收到的数据，可能是自己需要处理的6倍</span><br><span class="line"></span><br><span class="line">如果每个相机连一个串口485控制3个控制器，通讯数据可以降低一半，也不存在互锁的问题</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/.com//%E9%BB%84%E5%86%88%E7%A8%B3%E5%81%A5/1711531632577.png" alt="1711531632577"></p><h2 id="通用多字节协议设计-可讨论是否采用"><a href="#通用多字节协议设计-可讨论是否采用" class="headerlink" title="通用多字节协议设计(可讨论是否采用)"></a>通用多字节协议设计(可讨论是否采用)</h2><ul><li>增加字节长度消息</li><li>例如：</li></ul><table><thead><tr><th>功能位</th><th>字节</th><th>取值范围</th><th>备注</th></tr></thead><tbody><tr><td>起始位</td><td>0x10</td><td>0x10</td><td>固定格式</td></tr><tr><td>从站地址</td><td>0x01</td><td>0x01~0xff</td><td>从站站号</td></tr><tr><td>功能码</td><td>0x10</td><td>0x03读&#x2F;0x10写</td><td>功能码，可选位</td></tr><tr><td>数据地址高位</td><td>0x03</td><td>0x00~0xff</td><td>数据地址高位</td></tr><tr><td>数据地址低位</td><td>0xe9</td><td>0x00~0xff</td><td>数据地址低位</td></tr><tr><td>数据长度高位</td><td>0x00</td><td>0x00~0xff</td><td>数据长度高位</td></tr><tr><td>数据长度低位</td><td>0x01</td><td>0x00~0xff</td><td>数据长度低位</td></tr><tr><td>数据内容高位</td><td>0x01</td><td>0x00~0xff</td><td>数据内容高位</td></tr><tr><td>数据内容低位</td><td>0x01</td><td>0x00~0xff</td><td>数据内容低位</td></tr><tr><td>结束位</td><td>0x55</td><td>0x55</td><td>固定格式</td></tr></tbody></table><ul><li>超时设计：上位机发送一个数据，下位机返回一个数据，若超时则再发送一次（不必对同一个数据始终判断超时）。</li></ul><p>串口消息间隔 4ms,支持消息连发</p><p>波特率115200</p>]]></content>
      
      
      <categories>
          
          <category> 项目经验 </category>
          
          <category> 黄冈稳健 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目经验 </tag>
            
            <tag> 黄冈稳健 </tag>
            
            <tag> 控制器 </tag>
            
            <tag> 串口组网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编码器正反转</title>
      <link href="/2023/11/26/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8E%A7%E5%88%B6%E5%99%A8/%E7%BC%96%E7%A0%81%E5%99%A8%E6%AD%A3%E5%8F%8D%E8%BD%AC/"/>
      <url>/2023/11/26/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8E%A7%E5%88%B6%E5%99%A8/%E7%BC%96%E7%A0%81%E5%99%A8%E6%AD%A3%E5%8F%8D%E8%BD%AC/</url>
      
        <content type="html"><![CDATA[<h1 id="编码器正反转"><a href="#编码器正反转" class="headerlink" title="编码器正反转"></a>编码器正反转</h1><h2 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h2><p>编码器转动，每个边沿信号对应另一线的电平状态都是不同的。A，B两个信号线共有4个边沿信号，每个信号根据当前正反转的状态，电平状态不同。</p><h2 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h2><p><img src="/.com//%E7%BC%96%E7%A0%81%E5%99%A8%E6%AD%A3%E5%8F%8D%E8%BD%AC/1711531549597.png" alt="1711531549597"></p><h2 id="程序示例"><a href="#程序示例" class="headerlink" title="程序示例"></a>程序示例</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> encoder_input_A PAin(15)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> encoder_input_B PBin(3)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/// @brief B接收信号</span></span><br><span class="line"><span class="comment">/// @param  无</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">EXTI3_IRQHandler</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (sZDebounce &gt; <span class="number">0</span>) <span class="built_in">delay_us</span>(sZDebounce);  <span class="comment">// Z信号输入去抖</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// B-</span></span><br><span class="line">  <span class="keyword">if</span> (encoder_input_B == <span class="literal">false</span>) &#123;     <span class="comment">//调试信号用</span></span><br><span class="line">    <span class="keyword">if</span> (encoder_input_A == <span class="literal">false</span>) &#123;  <span class="comment">// A上</span></span><br><span class="line">      iACount--;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (encoder_input_A == <span class="literal">true</span>) &#123;  <span class="comment">// A下</span></span><br><span class="line">      iACount++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (encoder_input_B == <span class="literal">true</span>) &#123;  <span class="comment">// B+  //调试信号用</span></span><br><span class="line">    <span class="keyword">if</span> (encoder_input_A == <span class="literal">false</span>) &#123;      <span class="comment">// A上</span></span><br><span class="line">      iACount++;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (encoder_input_A == <span class="literal">true</span>) &#123;  <span class="comment">// A下</span></span><br><span class="line">      iACount--;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">EXTI_ClearITPendingBit</span>(EXTI_Line3);  <span class="comment">// 清除中断标志位</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* I/O线中断，A信号，中断线为: PA.15 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">EXTI15_10_IRQHandler</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (sADebounce &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">delay_us</span>(sADebounce);  <span class="comment">// A信号输入去抖</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// A-</span></span><br><span class="line">  <span class="keyword">if</span> (encoder_input_A == <span class="literal">false</span>) &#123;       <span class="comment">//调试信号用</span></span><br><span class="line">    <span class="keyword">if</span> (encoder_input_B == <span class="literal">false</span>) &#123;  <span class="comment">// B上</span></span><br><span class="line">      iACount++;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (encoder_input_B == <span class="literal">true</span>) &#123;  <span class="comment">// B下</span></span><br><span class="line">      iACount--;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (encoder_input_A == <span class="literal">true</span>) &#123;  <span class="comment">// A+    //调试信号用</span></span><br><span class="line">    <span class="keyword">if</span> (encoder_input_B == <span class="literal">false</span>) &#123;      <span class="comment">// B上</span></span><br><span class="line">      iACount--;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (encoder_input_B == <span class="literal">true</span>) &#123;  <span class="comment">// B下</span></span><br><span class="line">      iACount++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><h3 id="增量编码器直连"><a href="#增量编码器直连" class="headerlink" title="增量编码器直连"></a>增量编码器直连</h3><ul><li>编码器A连控制器A，编码器B连控制器Z1，使用高速光耦，正转3000，反转-3000，仅脉冲加，数量为5000，A信号数量2000正常，B信号数量3000</li><li>去除核心板C31的电容，无改善</li><li>编码器A连Z3，B连Z4（即使用PC817），可以达到预期控制效果，但帧率较低，1秒3圈1K的编码器，开启正反转就是4倍频，即12K行频就是极限（按10K即可）。</li></ul><h3 id="差分编码器转接（PC817）"><a href="#差分编码器转接（PC817）" class="headerlink" title="差分编码器转接（PC817）"></a>差分编码器转接（PC817）</h3><ul><li>编码器A连控制器A，编码器B连控制器Z1，使用高速光耦，正转4000，反转-4000。</li><li>差分转接后，正转4000，反转-4000，达到预期。</li><li>实现脉冲级正反转判断。任意正反转，都不会多拍或少拍。</li><li>约12K行频，效果稳定（按10K即可）</li></ul>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 控制器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 控制器 </tag>
            
            <tag> 编码器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt多线程</title>
      <link href="/2023/11/25/Qt/Qt_%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
      <url>/2023/11/25/Qt/Qt_%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="Qt多线程"><a href="#Qt多线程" class="headerlink" title="Qt多线程"></a>Qt多线程</h2><h2 id="QtConcurrent"><a href="#QtConcurrent" class="headerlink" title="QtConcurrent"></a>QtConcurrent</h2><p>keyword: QtConcurrent, Qt多线程, Qt多线程编程</p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><ul><li>QtConcurrent模块提供了在Qt应用程序中使用多线程的类和函数。</li><li>可以在任意位置，使用该方法将需要执行的函数传入，并返回一个future对象，该对象可以用来判断函数是否执行完成，以及获取函数的返回值。</li></ul><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>QtConcurrent::run()</p><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QFuture&lt;<span class="type">void</span>&gt; future = QtConcurrent::<span class="built_in">run</span>([=]()&#123;</span><br><span class="line">      QMutexLocker <span class="built_in">locker</span>(&amp;serial_qmutex);  <span class="comment">//加锁并自动释放</span></span><br><span class="line">        <span class="built_in">serialPort_readyRead</span>();</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h2 id="线程锁"><a href="#线程锁" class="headerlink" title="线程锁"></a>线程锁</h2><h3 id="QMutexLocker"><a href="#QMutexLocker" class="headerlink" title="QMutexLocker"></a>QMutexLocker</h3><p>keyword: QMutexLocker, Qt多线程, Qt多线程编程</p><h3 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h3><ul><li>QMutexLocker类是QMutex的包装类，用于自动加锁和解锁。</li><li>该类在构造函数中传入QMutex对象，并在析构函数中自动解锁。</li></ul><h3 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QFuture&lt;<span class="type">void</span>&gt; future = QtConcurrent::<span class="built_in">run</span>([=]()&#123;</span><br><span class="line">      QMutexLocker <span class="built_in">locker</span>(&amp;serial_qmutex);  <span class="comment">//加锁并自动释放</span></span><br><span class="line">        <span class="built_in">serialPort_readyRead</span>();</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>复卷定长校准方案</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E5%A4%8D%E5%8D%B7%E5%AE%9A%E9%95%BF%E6%A0%A1%E5%87%86%E6%96%B9%E6%A1%88/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E5%A4%8D%E5%8D%B7%E5%AE%9A%E9%95%BF%E6%A0%A1%E5%87%86%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h1 id="复卷定长校准方案"><a href="#复卷定长校准方案" class="headerlink" title="复卷定长校准方案"></a>复卷定长校准方案</h1><h2 id="1-方案描述"><a href="#1-方案描述" class="headerlink" title="1. 方案描述"></a>1. 方案描述</h2><p>复卷定长校准方案，是针对复卷生产与复卷由于张力或其它因素造成缺陷位置变化的定长校准缺陷位置的方案。</p><h2 id="2-方案原理"><a href="#2-方案原理" class="headerlink" title="2. 方案原理"></a>2. 方案原理</h2><p>主线生产定长打标，复卷机复卷，检测标签，根据检测到的标签位置校准放卷米数。</p><h2 id="3-方案流程"><a href="#3-方案流程" class="headerlink" title="3. 方案流程"></a>3. 方案流程</h2><h3 id="3-1-方案流程图"><a href="#3-1-方案流程图" class="headerlink" title="3.1 方案流程图"></a>3.1 方案流程图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line"></span><br><span class="line">大线</span><br><span class="line">--&gt;每100米贴标</span><br><span class="line">--&gt;复卷</span><br><span class="line">--&gt;检测标签--有标签</span><br><span class="line">--&gt;校准计米</span><br></pre></td></tr></table></figure><h3 id="3-2-方案流程描述"><a href="#3-2-方案流程描述" class="headerlink" title="3.2 方案流程描述"></a>3.2 方案流程描述</h3><p>复卷定长校准方案，主线每隔100米贴标，然后复卷，检测标签，根据检测到的标签位置校准放卷米数。</p><h3 id="软件重启"><a href="#软件重启" class="headerlink" title="软件重启"></a>软件重启</h3><p>重启软件读取控制器的计米。</p><h3 id="自动计算系数"><a href="#自动计算系数" class="headerlink" title="自动计算系数"></a>自动计算系数</h3><p>探测到标签自动计算系数。</p><h3 id="按钮纠偏"><a href="#按钮纠偏" class="headerlink" title="按钮纠偏"></a>按钮纠偏</h3><ul><li>验光板上下2排按钮，每按一下上下纠偏固定长度。</li><li>18个通道，每个通道两个按钮。</li><li>每次停机只能纠偏一次，纠偏与复位按钮为独立的按钮。</li></ul><h3 id="软件贴标"><a href="#软件贴标" class="headerlink" title="软件贴标"></a>软件贴标</h3><ul><li>软件贴标，每100米贴一次，使用0x31踢废指令即可，记录到报表中，但默认不勾选</li><li>PLC根据实际米长以及检测到的标签位置，计算校准系数。并完成校准。</li><li>定长贴标的记录，校准</li><li>卷尾贴标必须使用。</li></ul><h3 id="任务拆解"><a href="#任务拆解" class="headerlink" title="任务拆解"></a>任务拆解</h3><ol><li>探标自动校准,获得补偿值 （完成）</li><li>按钮分段补偿（即36个按钮对应16个通道的位置补偿） （初步完成）</li><li>根据横坐标判断补偿值 （完成）</li><li>合并探标补偿 （完成）</li><li>合并按钮通道补偿 （完成）</li><li>停机位置修正，合入按钮分段补偿 （待开始）</li><li>自动校准系数？（暂不做）</li><li>调试，验证</li></ol><h3 id="计算公式"><a href="#计算公式" class="headerlink" title="计算公式"></a>计算公式</h3><p>$$实时米数&#x3D;原始米数+同步补偿+探标补偿$$<br>$$同步补偿&#x3D;缺陷坐标-实时米数$$<br>$$探标补偿&#x3D;((int)(实时米数&#x2F;贴标间隔))*(贴标间隔)+（（实时米数&#x2F;贴标间隔）-（int）（实时米数&#x2F;贴标间隔）&gt;&#x3D;0.5?贴标间隔:0）$$</p>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 复卷瑕疵定位系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 复卷瑕疵定位系统 </tag>
            
            <tag> 复卷 </tag>
            
            <tag> 方案 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode-随用笔记</title>
      <link href="/2023/11/17/%E7%BB%BC%E5%90%88/vscode/vscode-%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/11/17/%E7%BB%BC%E5%90%88/vscode/vscode-%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="VScode"><a href="#VScode" class="headerlink" title="VScode"></a>VScode</h1><h2 id="配置VScode语言"><a href="#配置VScode语言" class="headerlink" title="配置VScode语言"></a>配置VScode语言</h2><ol><li>调出命令框（Ctrl+Shift+P）</li><li>输入language</li><li>选择configure display language</li><li>选择en（英文），zH-cn（中文简体）</li></ol><h2 id="格式化文本"><a href="#格式化文本" class="headerlink" title="格式化文本"></a>格式化文本</h2><ol><li>安装插件Clang-Format（写文档的时候，不确定是否一定要安装这个插件）</li><li>clang-Format 下载LLVM，并安装。（还需要在vs中设置google格式化规则）<ol><li>Ctrl + ,， 打开设置</li><li>输入 clang-format</li><li>将C_Cpp.clang_format_fallbackStyle值从Visual Studio改为 Google</li><li>如图<img src="/.com//vscode-%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/1711531685606.png" alt="1711531685606"></li></ol></li><li>默认格式化配置<ol><li>右键-&gt;使用…格式化-&gt;选择clang-Format（google格式），也可以选择系统默认格式化。</li></ol></li></ol><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><ol><li>C&#x2F;C++</li><li>ChatGPT-中文版 （注册账号可以免费使用gpt-3.5）</li><li>Chinese（简体中文）</li><li>Clang-Format   （代码google格式化规则）</li><li>Code Runner    （运行多种语言代码）</li><li>Keil Assistant    （MDK开发支持）</li><li>Markdown PDF</li><li>Markdown All in One</li><li>Markdown Preview Enhanced （预览可以有目录）</li><li>markdownlint  （检查md语法格式，格式化）</li><li>Typora</li><li>python</li><li>Var Conversion （变量名称转换）</li><li>verilog-HDL&#x2F;System Verilog&#x2F;Bluespec SystemVerilog（verilog语法高亮，格式化）</li><li>vscode-icons （图标）</li><li>vscode-mindmap   (思维导图，文件名*.km可以使用)</li><li>Qt tools   （备选，扫描套件用，不建议工程使用）</li><li>Qt Configure （备选，可以用vscode新建并开发qt程序，需要注意，尽量不要用qt creator 大量改动文件结构，不建议工程使用）</li><li>GitHub Copilot （很好用的代码AI提示，需要付费，会严重拖慢VScode的启动速度</li><li>Tabnine AI ***** （免费的代码AI提示，相对不那么智能，会严重拖慢VScode的启动速度</li><li>markmap (好用的markdown转思维导图工具)</li><li>var-translate-en (好用的中文翻译工具)</li></ol><h2 id="C-C"><a href="#C-C" class="headerlink" title="C++&#x2F;C"></a>C++&#x2F;C</h2><h3 id="C-C-Themes"><a href="#C-C-Themes" class="headerlink" title="C&#x2F;C++ Themes"></a>C&#x2F;C++ Themes</h3><ul><li>编写C项目代码，可以使用该插件设置主题颜色。针对C代码的高亮更完善。</li><li>设置-&gt;代码格式设置-&gt;找到format相关字样的，设置为Google即可使用google格式化，设置为visual studio则使用vs格式化。无需再下载clang format插件</li></ul><h3 id="1-keil记录"><a href="#1-keil记录" class="headerlink" title="1. keil记录"></a>1. keil记录</h3><ul><li>启用C++&#x2F;C插件，写keil程序，会头文件报错</li><li>报错内容为：typedef redefinition with different types (‘unsigned int’ vs ‘unsigned long long’)，大意为vacode判断会出现编译异常。</li><li>此时，只需要直接右键该报错内容，禁用此类报错,禁用代码分析即可。不影响编译。</li><li>C++插件中找到代码分析，找到Run Automatlcally 设置为false<br><img src="/.com//vscode-%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/1711531710320.png" alt="1711531710320"></li><li>若需要启用代码分析，则按下快捷键Ctrl+Shift+P，输入C++：run Code Analysis，即可启用代码分析。<br><img src="/.com//vscode-%E9%9A%8F%E6%89%8B%E7%AC%94%E8%AE%B0/1711531719781.png" alt="1711531719781"></li></ul>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> vscode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 环境搭建 </tag>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>项目经验-张力分段折叠机</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8A%98%E5%8F%A0%E6%9C%BA/%E5%BC%A0%E5%8A%9B%E5%88%86%E6%AE%B5%E6%8A%98%E5%8F%A0%E6%9C%BA/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8A%98%E5%8F%A0%E6%9C%BA/%E5%BC%A0%E5%8A%9B%E5%88%86%E6%AE%B5%E6%8A%98%E5%8F%A0%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="张力分段折叠机"><a href="#张力分段折叠机" class="headerlink" title="张力分段折叠机"></a>张力分段折叠机</h1><h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><ul><li>崇阳稳健</li></ul><h2 id="要点简述"><a href="#要点简述" class="headerlink" title="要点简述"></a>要点简述</h2><ul><li>项目主要难点为材料分折叠前和折叠后两段，中间由一个浮动滚保持整体张力，由于浮动滚为循环滚动，故此无法准确得知折叠前的动态踢废间隔。</li><li>解决方法：使用了两段编码器互差的方法，以浮动滚落在最低处为基准点，计算出两段编码器差值，以此计算出两段材料之间的间距。</li><li>此方法存在误差，误差为浮动滚限位响应误差。</li><li>另一个主要难点：折叠前使用了面阵相机拍照一片产品拍两次，上半部分拍一张，下半部分拍一张，以此计算出产品对应的踢废间隔。对齐工位踢废。</li><li>解决方法：拍照时候记录位置信息。每个光电信号与产品对应。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目经验 </category>
          
          <category> 折叠机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目经验 </tag>
            
            <tag> 张力分段折叠机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>项目经验-多通道折叠机</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8A%98%E5%8F%A0%E6%9C%BA/%E5%A4%9A%E9%80%9A%E9%81%93%E6%8A%98%E5%8F%A0%E6%9C%BA/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8A%98%E5%8F%A0%E6%9C%BA/%E5%A4%9A%E9%80%9A%E9%81%93%E6%8A%98%E5%8F%A0%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="多通道折叠机"><a href="#多通道折叠机" class="headerlink" title="多通道折叠机"></a>多通道折叠机</h1><h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><ul><li>崇阳稳健</li></ul><h2 id="要点简述"><a href="#要点简述" class="headerlink" title="要点简述"></a>要点简述</h2><ul><li>两个通道，四台相机，两台相机为一个通道</li><li>排片为固定节拍，踢废产品不计入节拍数量</li><li>使用光电计数</li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目经验 </category>
          
          <category> 多通道折叠机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目经验 </tag>
            
            <tag> 多通道折叠机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows-环境搭建</title>
      <link href="/2023/11/17/%E7%BB%BC%E5%90%88/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/Windows/"/>
      <url>/2023/11/17/%E7%BB%BC%E5%90%88/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/Windows/</url>
      
        <content type="html"><![CDATA[<h1 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h1><h2 id="系统语言"><a href="#系统语言" class="headerlink" title="系统语言"></a>系统语言</h2><p>系统语言选择English，地区选择china，格式选择chinese<br><img src="/.com//Windows/1711531646844.png" alt="1711531646844"></p><h2 id="通用软件语言"><a href="#通用软件语言" class="headerlink" title="通用软件语言"></a>通用软件语言</h2><p>部分软件乱码解决办法<br><img src="/.com//Windows/1711531653790.png" alt="1711531653790"></p>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> 办公 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 环境搭建 </tag>
            
            <tag> Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>视频播放-Potplayer</title>
      <link href="/2023/11/17/%E7%BB%BC%E5%90%88/%E5%8A%9E%E5%85%AC%E5%B7%A5%E5%85%B7/Potplayer/"/>
      <url>/2023/11/17/%E7%BB%BC%E5%90%88/%E5%8A%9E%E5%85%AC%E5%B7%A5%E5%85%B7/Potplayer/</url>
      
        <content type="html"><![CDATA[<h1 id="Potplayer"><a href="#Potplayer" class="headerlink" title="Potplayer"></a>Potplayer</h1><h2 id="界面卡顿-更换解码方式"><a href="#界面卡顿-更换解码方式" class="headerlink" title="界面卡顿(更换解码方式)"></a>界面卡顿(更换解码方式)</h2><ul><li>左上角菜单（播放页面内右键）-&gt;滤镜-&gt;使用内置DXVA视频解码器</li><li>左上角菜单（播放页面内右键）-&gt;选项-&gt;声音-&gt;语言&#x2F;同步&#x2F;其他-&gt;同步调整单位（毫秒）：50-&gt;默认同步(毫秒)：50-&gt;次设备输出同步(毫秒):50</li></ul>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> 视频播放 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 视频播放 </tag>
            
            <tag> potplayer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>InnoSetup-脚本定制</title>
      <link href="/2023/11/17/Qt/InnoSetup/%E8%84%9A%E6%9C%AC%E5%AE%9A%E5%88%B6/"/>
      <url>/2023/11/17/Qt/InnoSetup/%E8%84%9A%E6%9C%AC%E5%AE%9A%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="InnoSetup"><a href="#InnoSetup" class="headerlink" title="InnoSetup"></a>InnoSetup</h1><h2 id="添加和卸载环境变量"><a href="#添加和卸载环境变量" class="headerlink" title="添加和卸载环境变量"></a>添加和卸载环境变量</h2><figure class="highlight pascal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[Code]</span><br><span class="line"><span class="comment">// 设置环境变量函数</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">SetEnv</span><span class="params">(aEnvName, aEnvValue: <span class="keyword">string</span>; aIsInstall, aIsInsForAllUser: Boolean)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">sOrgValue: <span class="keyword">string</span>;</span><br><span class="line">sFileName: <span class="keyword">string</span>;</span><br><span class="line">S1: AnsiString;                                                  <span class="comment">//注意类型是AnsiString,不是string</span></span><br><span class="line">bRetValue, bInsForAllUser: Boolean;</span><br><span class="line">SL: TStringList;</span><br><span class="line">x: integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">bInsForAllUser := aIsInsForAllUser;</span><br><span class="line"><span class="keyword">if</span> UsingWinNT <span class="keyword">then</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> bInsForAllUser <span class="keyword">then</span></span><br><span class="line">      bRetValue := RegQueryStringValue(HKEY_LOCAL_MACHINE, <span class="string">&#x27;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&#x27;</span>, aEnvName, sOrgValue)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      bRetValue := RegQueryStringValue(HKEY_CURRENT_USER, <span class="string">&#x27;Environment&#x27;</span>, aEnvName, sOrgValue);</span><br><span class="line">    sOrgValue := Trim(sOrgValue);</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      S1 := aEnvValue;</span><br><span class="line">      <span class="keyword">if</span> pos(Uppercase(s1), Uppercase(sOrgValue)) = <span class="number">0</span> <span class="keyword">then</span> <span class="comment">//还没有加入</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> aIsInstall <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          x := Length(sOrgValue);</span><br><span class="line">          <span class="keyword">if</span> (x &gt; <span class="number">0</span>) <span class="keyword">and</span> (StringOfChar(sOrgValue[x], <span class="number">1</span>) &lt;&gt; <span class="string">&#x27;;&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">            sOrgValue := sOrgValue + <span class="string">&#x27;;&#x27;</span>;</span><br><span class="line">          sOrgValue := sOrgValue + S1;</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">else</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> aIsInstall <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          StringChangeEx(sOrgValue, S1 + <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, True);</span><br><span class="line">          StringChangeEx(sOrgValue, S1, <span class="string">&#x27;&#x27;</span>, True);</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> bInsForAllUser <span class="keyword">then</span></span><br><span class="line">        RegWriteStringValue(HKEY_LOCAL_MACHINE, <span class="string">&#x27;SYSTEM\CurrentControlSet\Control\Session Manager\Environment&#x27;</span>, aEnvName, sOrgValue)</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">not</span> aIsInstall) <span class="keyword">and</span> (Trim(sOrgValue) = <span class="string">&#x27;&#x27;</span>) <span class="keyword">then</span></span><br><span class="line">          RegDeleteValue(HKEY_CURRENT_USER, <span class="string">&#x27;Environment&#x27;</span>, aEnvName)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          RegWriteStringValue(HKEY_CURRENT_USER, <span class="string">&#x27;Environment&#x27;</span>, aEnvName, sOrgValue);</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">else</span> <span class="comment">//非NT 系统,如Win98</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    SL := TStringList.Create;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">      sFileName := ExpandConstant(<span class="string">&#x27;&#123;sd&#125;\autoexec.bat&#x27;</span>);</span><br><span class="line">      LoadStringFromFile(sFileName, S1);</span><br><span class="line">      SL.Text := s1;</span><br><span class="line">      s1 :=   <span class="string">&#x27;&quot;&#x27;</span> + aEnvValue + <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">      s1 := <span class="string">&#x27;set &#x27;</span>+aEnvName +<span class="string">&#x27;=%path%;&#x27;</span> + s1 ;</span><br><span class="line"></span><br><span class="line">      bRetValue := False;</span><br><span class="line">      x := SL.IndexOf(s1);</span><br><span class="line">      <span class="keyword">if</span> x = -<span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> aIsInstall <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          SL.Add(s1);</span><br><span class="line">          bRetValue := True;</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line">      <span class="keyword">end</span> <span class="keyword">else</span> <span class="comment">//还没添加</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> aIsInstall <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          SL.Delete(x);</span><br><span class="line">          bRetValue := True;</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> bRetValue <span class="keyword">then</span></span><br><span class="line">        SL.SaveToFile(sFileName);</span><br><span class="line">    <span class="keyword">finally</span></span><br><span class="line">      SL.free;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 安装前添加环境变量</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">CurStepChanged</span><span class="params">(CurStep: TSetupStep)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">if</span> CurStep = ssInstall <span class="keyword">then</span>                        <span class="comment">//对于(ssInstall)这个变量可依据自身需要进行更改，帮助文档中有说明(也可是安装完成之后进行写入对应变量为ssDone)</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  <span class="comment">// 将&#123;app&#125;路径添加到path环境变量中</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;;&#x27;),true,true); //对于添加多个环境变量需要注意要添加分割符号&quot;;&quot;,否则系统会认为是一个</span></span><br><span class="line">     SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\pylon&#x27;</span>),true,true); <span class="comment">//在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">     SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\opencv&#x27;</span>),true,true); <span class="comment">//在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\x86&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">     SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\x64&#x27;</span>),true,true); <span class="comment">//在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//if CurStep = ssDone then                        //对于(ssInstall)这个变量可依据自身需要进行更改，帮助文档中有说明(也可是安装完成之后进行写入对应变量为ssDone)</span></span><br><span class="line">  <span class="comment">//begin</span></span><br><span class="line">  <span class="comment">// 将&#123;app&#125;路径添加到path环境变量中</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;;&#x27;),true,true); //对于添加多个环境变量需要注意要添加分割符号&quot;;&quot;,否则系统会认为是一个</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\pylon&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\opencv&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">    <span class="comment">// SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\x86&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">     <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\x64&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line">  <span class="comment">//end;</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 卸载前删除环境变量</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">CurUninstallStepChanged</span><span class="params">(CurUninstallStep: TUninstallStep)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">// 将&#123;app&#125;路径从path环境变量中删除</span></span><br><span class="line">  <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;;&#x27;),false,true);</span></span><br><span class="line">  SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\pylon&#x27;</span>),false,true); <span class="comment">//卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line">  SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\opencv&#x27;</span>),false,true); <span class="comment">//卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line">  <span class="comment">//SetEnv(&#x27;path&#x27;,ExpandConstant(&#x27;&#123;app&#125;\bin\x86&#x27;),false,true); //卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line">  SetEnv(<span class="string">&#x27;path&#x27;</span>,ExpandConstant(<span class="string">&#x27;&#123;app&#125;\bin\x64&#x27;</span>),false,true); <span class="comment">//卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="完整项目示例"><a href="#完整项目示例" class="headerlink" title="完整项目示例"></a>完整项目示例</h2><figure class="highlight pascal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br></pre></td><td class="code"><pre><span class="line">; Script generated by the Inno Setup Script Wizard.</span><br><span class="line">; SEE THE DOCUMENTATION <span class="keyword">FOR</span> DETAILS <span class="keyword">ON</span> CREATING INNO SETUP SCRIPT FILES!</span><br><span class="line"></span><br><span class="line">#define MyAppName &quot;恒意得上位机_230809&quot;</span><br><span class="line">#define MyAppVersion &quot;<span class="number">9.22</span>.<span class="number">10.26</span>&quot;</span><br><span class="line">#define MyAppPublisher &quot;HID&quot;</span><br><span class="line">#define MyAppURL &quot;https:<span class="comment">//www.hengideal.com/&quot;</span></span><br><span class="line">#define MyAppExeName &quot;controller.exe&quot;</span><br><span class="line"></span><br><span class="line">;标准控制器</span><br><span class="line">#define btn_Controller_V9</span><br><span class="line">;检测停机V3                             </span><br><span class="line">;#define btn_RewindDetectionShutdown_V3              </span><br><span class="line">;信号转换器</span><br><span class="line">;#define btn_InputSignalConverter                    </span><br><span class="line">;一体机</span><br><span class="line">;#define btn_YiTiJi                                  </span><br><span class="line">;复卷系统</span><br><span class="line">;#define btn_Rewinding_System                        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;****************我是分割线****************</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;是否集成X线组件</span><br><span class="line">;#define btn_XLine                                   </span><br><span class="line">;定位转IO</span><br><span class="line">;#define btn_PositioningTo                           </span><br><span class="line">;检测停机V2</span><br><span class="line">;#define btn_RewindDetectionShutdown_V2              </span><br><span class="line">;光源控制器</span><br><span class="line">;#define btn_Light_source_controller                 </span><br><span class="line">;崇阳折叠机<span class="number">2</span>通道<span class="number">4</span>相机</span><br><span class="line">;#define btn_Gauze_2ch_4cam                          </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[Types]</span><br><span class="line"><span class="keyword">Name</span>: Compact ;Description:&quot;简洁安装&quot;;        </span><br><span class="line"><span class="keyword">Name</span>: Full ;Description:&quot;完全安装&quot;;    </span><br><span class="line"><span class="keyword">Name</span>: Custom; Description:&quot;自定义安装&quot;;       Flags: iscustom</span><br><span class="line">;上述代码会根据写代码顺序排列选择顺序,,,Flags:iscustom,为标记该类型为自定义安装.配合下述Components代码实现选择安装</span><br><span class="line"></span><br><span class="line">#ifdef  btn_Controller_V9</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:control_v9;Description:&quot;标准控制器&quot;;Types:Full Compact Custom;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\标准控制器\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\标准控制器&quot;; Flags: ignoreversion   ;Components: control_v9</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#MyAppExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion ; Components: control_v9</span><br><span class="line">;语句后增加 Flags:fixed 字段 可强制安装</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#MyAppName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#MyAppExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:control_v9</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#MyAppExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(MyAppName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent    ;Components:control_v9</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;X线定义</span><br><span class="line">#ifdef btn_XLine</span><br><span class="line">#define X_LineName &quot;X线控制器&quot;</span><br><span class="line">#define X_LineExeName &quot;X_line.exe&quot;</span><br><span class="line">#define Xline_HMIName &quot;X线PLC设置&quot;</span><br><span class="line">#define Xline_HMIExeName &quot;Xline_HMI.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:X_Line;Description:<span class="comment">&#123;#X_LineName&#125;</span>;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\折叠机_X线\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\折叠机_X线&quot;; Flags: ignoreversion   ;Components: X_Line</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: X_Line</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#Xline_HMIExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: X_Line</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#Xline_HMIName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Xline_HMIExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:X_Line</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(X_LineName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent   ;Components:X_Line</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Xline_HMIExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(Xline_HMIName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent     ;Components:X_Line</span><br><span class="line">;上述代码将在安装完成界面添加check选项框,是否运行,或者可以添加打开更新日志之类的功能</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;一体机定义</span><br><span class="line">#ifdef btn_YiTiJi</span><br><span class="line">#define YiTiJiName &quot;一体机&quot;</span><br><span class="line">#define YiTiJiExeName &quot;YiTiJi.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:YiTiJi;Description:<span class="comment">&#123;#YiTiJiName&#125;</span>;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\包装检测一体机\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\包装检测一体机&quot;; Flags: ignoreversion   ;Components: YiTiJi</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#YiTiJiExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: YiTiJi</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#YiTiJiName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#YiTiJiExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:YiTiJi</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#YiTiJiExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(YiTiJiName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent   ;Components:YiTiJi</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;复卷系统定义</span><br><span class="line">#ifdef btn_Rewinding_System </span><br><span class="line">#define  Rewinding_SystemName &quot;复卷数据系统&quot;</span><br><span class="line">#define  Rewinding_SystemExeName &quot;复卷系统/复卷系统.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:Rewinding_System;Description:&quot;复卷系统&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\复卷系统\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\复卷系统&quot;; Flags: ignoreversion   ;Components: Rewinding_System</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#Rewinding_SystemExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\复卷系统&quot;; Flags: ignoreversion; Components: Rewinding_System</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#Rewinding_SystemName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Rewinding_SystemExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:Rewinding_System</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Rewinding_SystemExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(Rewinding_SystemName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent    ;Components:Rewinding_System</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;定位测量转IO定义</span><br><span class="line">#ifdef btn_PositioningTo </span><br><span class="line">#define  PositioningToIOName &quot;定位测量转IO&quot;</span><br><span class="line">#define  PositioningToIOExeName &quot;LocationToIO.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:PositioningToIO;Description:&quot;定位测量转IO&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\定位测量转IO\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\定位测量转IO&quot;; Flags: ignoreversion   ;Components: PositioningToIO</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#PositioningToIOExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: PositioningToIO</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#PositioningToIOName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#PositioningToIOExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:PositioningToIO</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#PositioningToIOExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(PositioningToIOName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent     ;Components:PositioningToIO</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;复卷检测停机V2定义</span><br><span class="line">#ifdef btn_RewindDetectionShutdown_V2</span><br><span class="line">#define  RewindDetectionShutdownNameV2 &quot;复卷检测停机V2&quot;</span><br><span class="line">#define  RewindDetectionShutdownExeNameV2 &quot;RewindingV2.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:RewindDetectionShutdownV2;Description:&quot;复卷检测停机V2&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\复卷检测停机\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\复卷检测停机&quot;; Flags: ignoreversion recursesubdirs createallsubdirs  ;Components: RewindDetectionShutdownV2</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#RewindDetectionShutdownExeNameV2&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: RewindDetectionShutdownV2</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownNameV2&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownExeNameV2&#125;</span>&quot;; Tasks: desktopicon      ;Components:RewindDetectionShutdownV2</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownExeNameV2&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(RewindDetectionShutdownNameV2, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent    ;Components:RewindDetectionShutdownV2</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;复卷检测停机V3定义</span><br><span class="line">#ifdef btn_RewindDetectionShutdown_V3</span><br><span class="line">#define  RewindDetectionShutdownName &quot;复卷检测停机V3&quot;</span><br><span class="line">#define  RewindDetectionShutdownExeName &quot;RewindingDetectionV3.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:RewindDetectionShutdownV3;Description:&quot;复卷检测停机V3&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\复卷检测停机\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\复卷检测停机&quot;; Flags: ignoreversion recursesubdirs createallsubdirs  ;Components: RewindDetectionShutdownV3</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#RewindDetectionShutdownExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: RewindDetectionShutdownV3</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:RewindDetectionShutdownV3</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#RewindDetectionShutdownExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(RewindDetectionShutdownName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent    ;Components:RewindDetectionShutdownV3</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;光源控制器定义</span><br><span class="line">#ifdef btn_Light_source_controller </span><br><span class="line">#define  Light_source_controllerName &quot;光源控制器&quot;</span><br><span class="line">#define  Light_source_controllerExeName &quot;Light_source_controller.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:Light_source_controller;Description:&quot;光源控制器&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\光源控制器\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\光源控制器&quot;; Flags: ignoreversion   ;Components: Light_source_controller</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#Light_source_controllerExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: Light_source_controller</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#Light_source_controllerName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Light_source_controllerExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:Light_source_controller</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Light_source_controllerExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(Light_source_controllerName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent    ;Components:Light_source_controller</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;纱布折叠机_两通道_四相机定义</span><br><span class="line">#ifdef btn_Gauze_2ch_4cam </span><br><span class="line">#define  Gauze_2ch_4camName &quot;纱布折叠机_两通道_四相机&quot;</span><br><span class="line">#define  Gauze_2ch_4camExeName &quot;Gauze_2ch_4cam.exe&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:Gauze_2ch_4cam;Description:&quot;纱布折叠机_两通道_四相机&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\折叠机_双通道四相机\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\折叠机_双通道四相机&quot;; Flags: ignoreversion   ;Components: Gauze_2ch_4cam</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#Gauze_2ch_4camExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: Gauze_2ch_4cam</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line"><span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#Gauze_2ch_4camName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Gauze_2ch_4camExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:Gauze_2ch_4cam</span><br><span class="line">[Run]</span><br><span class="line">Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#Gauze_2ch_4camExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(Gauze_2ch_4camName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent        ;Components:Gauze_2ch_4cam</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">;产线信号转换器定义</span><br><span class="line">#ifdef btn_InputSignalConverter </span><br><span class="line">#define  ProductionLineSignalConverterName &quot;产线信号转换器&quot;</span><br><span class="line">#define  ProductionLineSignalConverterExeName &quot;&quot;</span><br><span class="line">[Components]</span><br><span class="line"><span class="keyword">Name</span>:ProductionLineSignalConverter;Description:&quot;产线信号转换器&quot;;Types:Full;</span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\产线信号转换器\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\产线信号转换器&quot;; Flags: ignoreversion   ;Components: ProductionLineSignalConverter</span><br><span class="line">;Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\<span class="comment">&#123;#ProductionLineSignalConverterExeName&#125;</span>&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion; Components: ProductionLineSignalConverter</span><br><span class="line">[Icons]</span><br><span class="line">;桌面快捷方式  </span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autoprograms&#125;</span>\<span class="comment">&#123;#X_LineName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#X_LineExeName&#125;</span>&quot;      ;Components:X_Line</span><br><span class="line">;<span class="keyword">Name</span>: &quot;<span class="comment">&#123;autodesktop&#125;</span>\<span class="comment">&#123;#ProductionLineSignalConverterName&#125;</span>&quot;; Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#ProductionLineSignalConverterExeName&#125;</span>&quot;; Tasks: desktopicon      ;Components:ProductionLineSignalConverter</span><br><span class="line">[Run]</span><br><span class="line">;Filename: &quot;<span class="comment">&#123;app&#125;</span>\<span class="comment">&#123;#ProductionLineSignalConverterExeName&#125;</span>&quot;; Description: &quot;<span class="comment">&#123;cm:LaunchProgram,&#123;#StringChange(ProductionLineSignalConverterName, &#x27;&amp;&#x27;, &#x27;&amp;&amp;&#x27;)&#125;</span>&#125;&quot;; Flags: nowait postinstall skipifsilent</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">[Setup]</span><br><span class="line">; NOTE: The value <span class="keyword">of</span> AppId uniquely identifies this application. <span class="keyword">Do</span> <span class="keyword">not</span> use the same AppId value <span class="keyword">in</span> installers <span class="keyword">for</span> other applications.</span><br><span class="line">; (<span class="keyword">To</span> generate a new GUID, click Tools | Generate GUID inside the IDE.)</span><br><span class="line">AppId=<span class="comment">&#123;&#123;433F837C-1CBE-45B1-948F-B33CB8DC0191&#125;</span></span><br><span class="line">AppName=<span class="comment">&#123;#MyAppName&#125;</span></span><br><span class="line">AppVersion=<span class="comment">&#123;#MyAppVersion&#125;</span></span><br><span class="line">;AppVerName=<span class="comment">&#123;#MyAppName&#125;</span> <span class="comment">&#123;#MyAppVersion&#125;</span></span><br><span class="line">AppPublisher=<span class="comment">&#123;#MyAppPublisher&#125;</span></span><br><span class="line">AppPublisherURL=<span class="comment">&#123;#MyAppURL&#125;</span></span><br><span class="line">AppSupportURL=<span class="comment">&#123;#MyAppURL&#125;</span></span><br><span class="line">AppUpdatesURL=<span class="comment">&#123;#MyAppURL&#125;</span></span><br><span class="line">DefaultDirName=C:/恒意得上位机系统</span><br><span class="line">DisableProgramGroupPage=yes</span><br><span class="line">;InfoAfterFile=C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\更新日志.md</span><br><span class="line">; Uncomment the following line <span class="keyword">to</span> run <span class="keyword">in</span> non administrative install mode (install <span class="keyword">for</span> current user only.)</span><br><span class="line">;PrivilegesRequired=lowest</span><br><span class="line">OutputDir=C:\Users\fengj\OneDrive\Programs\Controller\Release_Installation_Package</span><br><span class="line">OutputBaseFilename=<span class="comment">&#123;#MyAppName&#125;</span>_setup_安装包</span><br><span class="line">SetupIconFile=C:\\Users\\fengj\\OneDrive\\Programs\\Controller\\Release\\Software_msvc\\source_material\\icon\\install.ico</span><br><span class="line">UninstallDisplayIcon=C:\\Users\\fengj\\OneDrive\\Programs\\Controller\\Release\\Software_msvc\\source_material\\icon\\install.ico</span><br><span class="line">Compression=lzma</span><br><span class="line">SolidCompression=yes</span><br><span class="line">WizardStyle=modern</span><br><span class="line">ChangesEnvironment=true</span><br><span class="line">UsePreviousAppDir=no</span><br><span class="line">;UsePreviousAppDir该字段设置为no则允许用户使用非覆盖的方式安装应用,若需要还原为覆盖安装则删除该字段即可</span><br><span class="line">ShowLanguageDialog=yes</span><br><span class="line">;上述语句为组件选择安装使用</span><br><span class="line">password=heng</span><br><span class="line">;上述语句用于添加安装密码</span><br><span class="line"></span><br><span class="line">;ChangesEnvironment=yes</span><br><span class="line">;上述语句用于环境变量相关</span><br><span class="line"></span><br><span class="line">;AlwaysRestart =yes</span><br><span class="line">;  上述 用于重启</span><br><span class="line"></span><br><span class="line">;RestartIfNeededByRun=yes</span><br><span class="line">;重启相关</span><br><span class="line"></span><br><span class="line">DefaultGroupName=<span class="comment">&#123;#MyAppName&#125;</span> </span><br><span class="line">;菜单栏创建文件夹</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[Languages]</span><br><span class="line"><span class="keyword">Name</span>: &quot;english&quot;; MessagesFile: &quot;compiler:<span class="keyword">Default</span>.isl&quot;</span><br><span class="line"><span class="keyword">Name</span>: &quot;chinesesimplified&quot;; MessagesFile: &quot;compiler:Languages\ChineseSimplified.isl&quot;</span><br><span class="line"></span><br><span class="line">[Tasks]</span><br><span class="line"><span class="keyword">Name</span>: &quot;desktopicon&quot;; Description: &quot;<span class="comment">&#123;cm:CreateDesktopIcon&#125;</span>&quot;; GroupDescription: &quot;<span class="comment">&#123;cm:AdditionalIcons&#125;</span>&quot;; Flags: checkablealone; </span><br><span class="line">;以上若需要默认不勾选安装快捷方式,则可以将flags替换为unchecked ,若默认需要勾选则为checkablealone</span><br><span class="line">; 只是在同级页面添加了选项.....<span class="keyword">Name</span>:&quot;YiTiJi&quot;;Description: &quot;测试&quot;;Flags:unchecked</span><br><span class="line">; 只是在同级页面添加了选项.....<span class="keyword">Name</span>:&quot;X_Line&quot;;Description:&quot;测试<span class="number">2</span>&quot;;Components:X_Line</span><br><span class="line"></span><br><span class="line">;<span class="keyword">Name</span>:&quot;RestartPC&quot;; Description:&quot;Restart the Computer&quot;; GroupDescription:&quot;Post Installation Options&quot;; Flags: unchecked;</span><br><span class="line">;上述代码用于设定安装完重启</span><br><span class="line"></span><br><span class="line">[Files]</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\*.dll&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\iconengines\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\iconengines&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\imageformats\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\imageformats&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\platforms\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\platforms&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\styles\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\styles&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\translations\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\translations&quot;; Flags: ignoreversion                </span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Skin\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Skin&quot;; Flags: ignoreversion</span><br><span class="line">Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\参数管理\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\参数管理&quot;; Flags: ignoreversion onlyifdoesntexist</span><br><span class="line">;Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\dll修复工具\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\dll修复工具&quot;; Flags: ignoreversion   recursesubdirs createallsubdirs</span><br><span class="line"></span><br><span class="line">;Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\标准控制器\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\标准控制器&quot;; Flags: ignoreversion</span><br><span class="line">;Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\Docs\复卷检测\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\Docs\复卷检测&quot;; Flags: ignoreversion   ;Components: Rewinding_System</span><br><span class="line">;Source: &quot;C:\Users\fengj\OneDrive\Programs\Controller\Release\Software_msvc\复卷系统\*&quot;; DestDir: &quot;<span class="comment">&#123;app&#125;</span>\复卷系统&quot;; Flags: ignoreversion recursesubdirs createallsubdirs;Components: Rewinding_System</span><br><span class="line">; NOTE: Don<span class="string">&#x27;t use &quot;Flags: ignoreversion&quot; on any shared system files</span></span><br><span class="line"><span class="string">;后缀加上 recursesubdirs createallsubdirs 可以包含文件夹下所有内容</span></span><br><span class="line"><span class="string">;后缀加上 onlyifdoesntexist 可以判断文件夹是否有该文件,若存在该文件则不替换</span></span><br><span class="line"><span class="string">;[Icons]</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autoprograms&#125;\&#123;#MyAppName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#MyAppExeName&#125;&quot;  </span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autodesktop&#125;\&#123;#MyAppName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#MyAppExeName&#125;&quot;; Tasks: desktopicon </span></span><br><span class="line"><span class="string">;下述代码实现了安装完成后桌面显示多个快捷方式的功能</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autoprograms&#125;\&#123;#YiTiJiName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#YiTiJiExeName&#125;&quot;      ;Components:YiTiJi</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autodesktop&#125;\&#123;#YiTiJiName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#YiTiJiExeName&#125;&quot;; Tasks: desktopicon      ;Components:YiTiJi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;复卷系统的桌面快捷方式</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autoprograms&#125;\&#123;#Rewinding_SystemName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#Rewinding_SystemExeName&#125;&quot;      ;Components:Rewinding_System</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;autodesktop&#125;\&#123;#Rewinding_SystemName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#Rewinding_SystemExeName&#125;&quot;; Tasks: desktopicon      ;Components:Rewinding_System</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;菜单栏创建文件夹</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;group&#125;\&#123;#MyAppName&#125;&quot;; Filename: &quot;&#123;app&#125;\&#123;#MyAppExeName&#125;&quot;; WorkingDir:&quot;&#123;app&#125;&quot;</span></span><br><span class="line"><span class="string">;Name: &quot;&#123;group&#125;\&#123;cm:UninstallProgram,&#123;#MyAppName&#125;&#125;&quot;; Filename: &quot;&#123;uninstallexe&#125;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Code]</span></span><br><span class="line"><span class="string">// 设置环境变量函数</span></span><br><span class="line"><span class="string">procedure SetEnv(aEnvName, aEnvValue: string; aIsInstall, aIsInsForAllUser: Boolean);</span></span><br><span class="line"><span class="string">var</span></span><br><span class="line"><span class="string">sOrgValue: string;</span></span><br><span class="line"><span class="string">sFileName: string;</span></span><br><span class="line"><span class="string">S1: AnsiString;                                                  //注意类型是AnsiString,不是string</span></span><br><span class="line"><span class="string">bRetValue, bInsForAllUser: Boolean;</span></span><br><span class="line"><span class="string">SL: TStringList;</span></span><br><span class="line"><span class="string">x: integer;</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">bInsForAllUser := aIsInsForAllUser;</span></span><br><span class="line"><span class="string">if UsingWinNT then</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">    if bInsForAllUser then</span></span><br><span class="line"><span class="string">      bRetValue := RegQueryStringValue(HKEY_LOCAL_MACHINE, &#x27;</span>SYSTEM\CurrentControlSet\Control\Session Manager\Environment<span class="string">&#x27;, aEnvName, sOrgValue)</span></span><br><span class="line"><span class="string">    else</span></span><br><span class="line"><span class="string">      bRetValue := RegQueryStringValue(HKEY_CURRENT_USER, &#x27;</span>Environment<span class="string">&#x27;, aEnvName, sOrgValue);</span></span><br><span class="line"><span class="string">    sOrgValue := Trim(sOrgValue);</span></span><br><span class="line"><span class="string">    begin</span></span><br><span class="line"><span class="string">      S1 := aEnvValue;</span></span><br><span class="line"><span class="string">      if pos(Uppercase(s1), Uppercase(sOrgValue)) = 0 then //还没有加入</span></span><br><span class="line"><span class="string">      begin</span></span><br><span class="line"><span class="string">        if aIsInstall then</span></span><br><span class="line"><span class="string">        begin</span></span><br><span class="line"><span class="string">          x := Length(sOrgValue);</span></span><br><span class="line"><span class="string">          if (x &gt; 0) and (StringOfChar(sOrgValue[x], 1) &lt;&gt; &#x27;</span>;<span class="string">&#x27;) then</span></span><br><span class="line"><span class="string">            sOrgValue := sOrgValue + &#x27;</span>;<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">          sOrgValue := sOrgValue + S1;</span></span><br><span class="line"><span class="string">        end;</span></span><br><span class="line"><span class="string">      end else</span></span><br><span class="line"><span class="string">      begin</span></span><br><span class="line"><span class="string">        if not aIsInstall then</span></span><br><span class="line"><span class="string">        begin</span></span><br><span class="line"><span class="string">          StringChangeEx(sOrgValue, S1 + &#x27;</span>;<span class="string">&#x27;, &#x27;&#x27;, True);</span></span><br><span class="line"><span class="string">          StringChangeEx(sOrgValue, S1, &#x27;&#x27;, True);</span></span><br><span class="line"><span class="string">        end;</span></span><br><span class="line"><span class="string">      end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      if bInsForAllUser then</span></span><br><span class="line"><span class="string">        RegWriteStringValue(HKEY_LOCAL_MACHINE, &#x27;</span>SYSTEM\CurrentControlSet\Control\Session Manager\Environment<span class="string">&#x27;, aEnvName, sOrgValue)</span></span><br><span class="line"><span class="string">      else</span></span><br><span class="line"><span class="string">      begin</span></span><br><span class="line"><span class="string">        if (not aIsInstall) and (Trim(sOrgValue) = &#x27;&#x27;) then</span></span><br><span class="line"><span class="string">          RegDeleteValue(HKEY_CURRENT_USER, &#x27;</span>Environment<span class="string">&#x27;, aEnvName)</span></span><br><span class="line"><span class="string">        else</span></span><br><span class="line"><span class="string">          RegWriteStringValue(HKEY_CURRENT_USER, &#x27;</span>Environment<span class="string">&#x27;, aEnvName, sOrgValue);</span></span><br><span class="line"><span class="string">      end;</span></span><br><span class="line"><span class="string">    end;</span></span><br><span class="line"><span class="string">end else //非NT 系统,如Win98</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">    SL := TStringList.Create;</span></span><br><span class="line"><span class="string">    try</span></span><br><span class="line"><span class="string">      sFileName := ExpandConstant(&#x27;</span><span class="comment">&#123;sd&#125;</span>\autoexec.bat<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">      LoadStringFromFile(sFileName, S1);</span></span><br><span class="line"><span class="string">      SL.Text := s1;</span></span><br><span class="line"><span class="string">      s1 :=   &#x27;</span>&quot;<span class="string">&#x27; + aEnvValue + &#x27;</span>&quot;<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">      s1 := &#x27;</span><span class="keyword">set</span> <span class="string">&#x27;+aEnvName +&#x27;</span>=%path%;<span class="string">&#x27; + s1 ;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      bRetValue := False;</span></span><br><span class="line"><span class="string">      x := SL.IndexOf(s1);</span></span><br><span class="line"><span class="string">      if x = -1 then</span></span><br><span class="line"><span class="string">      begin</span></span><br><span class="line"><span class="string">        if aIsInstall then</span></span><br><span class="line"><span class="string">        begin</span></span><br><span class="line"><span class="string">          SL.Add(s1);</span></span><br><span class="line"><span class="string">          bRetValue := True;</span></span><br><span class="line"><span class="string">        end;</span></span><br><span class="line"><span class="string">      end else //还没添加</span></span><br><span class="line"><span class="string">        if not aIsInstall then</span></span><br><span class="line"><span class="string">        begin</span></span><br><span class="line"><span class="string">          SL.Delete(x);</span></span><br><span class="line"><span class="string">          bRetValue := True;</span></span><br><span class="line"><span class="string">        end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      if bRetValue then</span></span><br><span class="line"><span class="string">        SL.SaveToFile(sFileName);</span></span><br><span class="line"><span class="string">    finally</span></span><br><span class="line"><span class="string">      SL.free;</span></span><br><span class="line"><span class="string">    end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">end;</span></span><br><span class="line"><span class="string">end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// 安装前添加环境变量</span></span><br><span class="line"><span class="string">procedure CurStepChanged(CurStep: TSetupStep);</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">  if CurStep = ssInstall then                        //对于(ssInstall)这个变量可依据自身需要进行更改，帮助文档中有说明(也可是安装完成之后进行写入对应变量为ssDone)</span></span><br><span class="line"><span class="string">  begin</span></span><br><span class="line"><span class="string">  // 将&#123;app&#125;路径添加到path环境变量中</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>;<span class="string">&#x27;),true,true); //对于添加多个环境变量需要注意要添加分割符号&quot;;&quot;,否则系统会认为是一个</span></span><br><span class="line"><span class="string">     SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\pylon<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">     SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\opencv<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x86<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">     SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x64<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">  end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  //if CurStep = ssDone then                        //对于(ssInstall)这个变量可依据自身需要进行更改，帮助文档中有说明(也可是安装完成之后进行写入对应变量为ssDone)</span></span><br><span class="line"><span class="string">  //begin</span></span><br><span class="line"><span class="string">  // 将&#123;app&#125;路径添加到path环境变量中</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>;<span class="string">&#x27;),true,true); //对于添加多个环境变量需要注意要添加分割符号&quot;;&quot;,否则系统会认为是一个</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\pylon<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\opencv<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">    // SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x86<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">     //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x64<span class="string">&#x27;),true,true); //在这儿调用,一定在这儿调用,安装完无须重启,立即生效</span></span><br><span class="line"><span class="string">  //end;</span></span><br><span class="line"><span class="string">end;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// 卸载前删除环境变量</span></span><br><span class="line"><span class="string">procedure CurUninstallStepChanged(CurUninstallStep: TUninstallStep);</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">  // 将&#123;app&#125;路径从path环境变量中删除</span></span><br><span class="line"><span class="string">  //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>;<span class="string">&#x27;),false,true);</span></span><br><span class="line"><span class="string">  SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\pylon<span class="string">&#x27;),false,true); //卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line"><span class="string">  SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\opencv<span class="string">&#x27;),false,true); //卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line"><span class="string">  //SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x86<span class="string">&#x27;),false,true); //卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line"><span class="string">  SetEnv(&#x27;</span>path<span class="string">&#x27;,ExpandConstant(&#x27;</span><span class="comment">&#123;app&#125;</span>\bin\x64<span class="string">&#x27;),false,true); //卸载时所需要删除的环境变量需要与所添加的变量一致，以免误删除</span></span><br><span class="line"><span class="string">end;</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> InnoSetup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> InnoSetup </tag>
            
            <tag> 安装包制作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>InnoSetup-向导创建</title>
      <link href="/2023/11/17/Qt/InnoSetup/%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/"/>
      <url>/2023/11/17/Qt/InnoSetup/%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="Inno-Setup-制作安装包"><a href="#Inno-Setup-制作安装包" class="headerlink" title="Inno Setup:制作安装包"></a>Inno Setup:制作安装包</h1><p>简述:Inno Setup有两种方式可以制作安装包</p><p>图片</p><p>使用向导方式制作,优点:简单快捷.缺点:仅基础安装,很多功能向导不提供</p><p>编写脚本,优点:可定制化程度高.缺点:需要一定的学习成本</p><p>制作过程如下:</p><p>一. 向导制作安装包</p><p> 点击新建,创建一个带向导的文件,点击OK</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534316925.png" alt="1711534316925"></p><p>点击下一步</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534324969.png" alt="1711534324969"></p><p>输入软件名称,软件版本(也可使用默认不填),应用网址</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534334328.png" alt="1711534334328"></p><p>下一步,选择自定义默认输出路径</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534342781.png" alt="1711534342781"></p><p>下一步,选择要封装的软件的路径,other application files:选择要封装的依赖文件</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534351173.png" alt="1711534351173"></p><p>下一步</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534359466.png" alt="1711534359466"></p><p>默认勾选创建菜单快捷方式以及桌面快捷方式,下一步</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534367913.png" alt="1711534367913"></p><p>根据需要是否加入安装前显示文本文件或安装后显示文本文件,下一步</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534376607.png" alt="1711534376607"></p><p>默认管理安装,下一步</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534384920.png" alt="1711534384920"></p><p>安装语言文件选择,中文,下一步</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534392677.png" alt="1711534392677"></p><p>图标文件和密码可以不填</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534401263.png" alt="1711534401263"></p><p>下一步</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534409426.png" alt="1711534409426"></p><p>完成</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534437191.png" alt="1711534437191"></p><p>立即编译脚本</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534492010.png" alt="1711534492010"></p><p>保存脚本文件,选择是</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534425859.png" alt="1711534425859"></p><p>保存文件</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534500456.png" alt="1711534500456"></p><p>编译完成</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534509173.png" alt="1711534509173"></p><p>输出路径找到生成的安装包</p><p><img src="/.com//%E5%90%91%E5%AF%BC%E5%88%9B%E5%BB%BA/1711534518361.png" alt="1711534518361"></p><p>评价:</p><p>用向导制作可以快速完成一个软件安装包的制作,但若想要添加环境变量,根据选择安装语言实现软件语言包的相应安装,美化界面等定制化功能,则需要使用inno setup的脚本语言(下篇记录脚本语言).</p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> InnoSetup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> InnoSetup </tag>
            
            <tag> 安装包制作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitea-部署笔记</title>
      <link href="/2023/11/17/git/gitea/"/>
      <url>/2023/11/17/git/gitea/</url>
      
        <content type="html"><![CDATA[<h1 id="Gitea"><a href="#Gitea" class="headerlink" title="Gitea"></a>Gitea</h1><h2 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h2><p><a href="https://github.com/go-gitea/gitea">github链接</a></p><h2 id="配置服务器"><a href="#配置服务器" class="headerlink" title="配置服务器"></a>配置服务器</h2><ul><li>双击gieta.exe</li><li>打开网页</li><li>配置信息，数据库使用sqlite，路径地址使用相对地址</li></ul><h2 id="注册服务"><a href="#注册服务" class="headerlink" title="注册服务"></a>注册服务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nssm install gitea</span><br><span class="line">nssm start gitea</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="配置发布版本附件大小以及数量"><a href="#配置发布版本附件大小以及数量" class="headerlink" title="配置发布版本附件大小以及数量"></a>配置发布版本附件大小以及数量</h2><p>custom文件夹-&gt;conf文件夹-&gt;app.ini</p><p>添加以下内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[attachment]</span><br><span class="line">ENABLED=true</span><br><span class="line">ALLOWED_TYPES=*/*</span><br><span class="line">MAX_SIZE=1024</span><br><span class="line">MAX_FILES=10</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> 版本管理 </tag>
            
            <tag> 服务器部署 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git-随用笔记</title>
      <link href="/2023/11/17/git/git_note/"/>
      <url>/2023/11/17/git/git_note/</url>
      
        <content type="html"><![CDATA[<h1 id="git笔记"><a href="#git笔记" class="headerlink" title="git笔记"></a>git笔记</h1><h2 id="一-如何修改-gitignore"><a href="#一-如何修改-gitignore" class="headerlink" title="一. 如何修改.gitignore"></a>一. 如何修改.gitignore</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#add .gitignore</span><br><span class="line">#查看状态，是否忽略了指定的文件？ </span><br><span class="line">$ git status --ignored #查看状态，包括忽略的文件</span><br><span class="line"> </span><br><span class="line">#让其对已经跟踪的文件也起作用</span><br><span class="line">$ git rm -r --cached .  #清除缓存 -r 表示递归删除（如果有文件夹的话） . 表示所有文件</span><br><span class="line"> </span><br><span class="line">#查看一下具体效果</span><br><span class="line">$ git status --ignored</span><br><span class="line">$ git add .           #重新trace file</span><br><span class="line">$ git commit -m &quot;update .gitignore&quot;     #提交和注释</span><br></pre></td></tr></table></figure><h2 id="二-如何删除分支"><a href="#二-如何删除分支" class="headerlink" title="二. 如何删除分支"></a>二. 如何删除分支</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d branch-name</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin --delete dev</span><br></pre></td></tr></table></figure><h2 id="三-合并指定文件夹"><a href="#三-合并指定文件夹" class="headerlink" title="三. 合并指定文件夹"></a>三. 合并指定文件夹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout 分支名 根目录/demo1.txt    //指定文件</span><br><span class="line">git checkout dev lib/ui/pages/member/** //多级目录</span><br></pre></td></tr></table></figure><h2 id="四-强制推送分支"><a href="#四-强制推送分支" class="headerlink" title="四. 强制推送分支"></a>四. 强制推送分支</h2><ul><li>命令格式为:<br>git push &lt;远程名称&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;<br>例如,推送本地的 master 分支到远程的 master 分支,强制覆盖远程代码:<br>git push origin master:master -f</li></ul>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> 版本管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UDP_socket</title>
      <link href="/2023/11/17/Qt/UDP_socket/"/>
      <url>/2023/11/17/Qt/UDP_socket/</url>
      
        <content type="html"><![CDATA[<h1 id="QUdpSocket"><a href="#QUdpSocket" class="headerlink" title="QUdpSocket"></a>QUdpSocket</h1><p>详见Qt高级，Qt_UDP.pdf</p><h1 id="libuv"><a href="#libuv" class="headerlink" title="libuv"></a>libuv</h1><p>两种模式，事件循环调用（回调）</p><p>1.The I&#x2F;O loop</p><p>2.File I&#x2F;O</p><h1 id="系统知识"><a href="#系统知识" class="headerlink" title="系统知识"></a>系统知识</h1><p>系统缓存约64KB字节，（超过这么多字节的数据，则会丢包。直到程序读取走一包数据。）</p><h1 id="测试过程试和验结果"><a href="#测试过程试和验结果" class="headerlink" title="测试过程试和验结果"></a>测试过程试和验结果</h1><p>总结：是否丢包主要取决于系统性能（以及是否繁忙等），低性能设备给高性能设备发数据丢包率小于高性能设备给低性能设备发数据。</p><p>libuv，与QUdpSocket性能相差不大，均为一定概率丢包。系统缓存64KB，不能单独设置缓存。</p><h1 id="测试工具-NetAssist"><a href="#测试工具-NetAssist" class="headerlink" title="测试工具 NetAssist"></a>测试工具 NetAssist</h1><ol><li>必须连接上网络，并且网络设置中已经显示正在识别或未识别的网络（否则可能会无法发现，不能被枚举出来）</li><li>与是否开启高性能模式无关，与是否插电源无关，是否开启无线网络无关，是否安装开启网卡属性中basler等其它gige无关，与是否开启虚拟网络无关</li></ol><p><img src="/.com//UDP_socket/1711531738424.png" alt="1711531738424"></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> Qt </tag>
            
            <tag> udp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt高级</title>
      <link href="/2023/11/17/Qt/Qt_UDP/"/>
      <url>/2023/11/17/Qt/Qt_UDP/</url>
      
        <content type="html"><![CDATA[<h1 id="Qt高级编程"><a href="#Qt高级编程" class="headerlink" title="Qt高级编程"></a>Qt高级编程</h1><h2 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h2><h3 id="QUdpSocket"><a href="#QUdpSocket" class="headerlink" title="QUdpSocket"></a>QUdpSocket</h3><h4 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h4><ol><li>pro文件添加模块，QT       +&#x3D;  network</li><li>添加头文件#include <code>&lt;QUdpSocket&gt;</code> <code>&lt;QHostAddress&gt;</code></li><li>创建对象并实例化  private:    QUdpSocket *udpSocket;    udpSocket&#x3D;new QUdpSocket(this);</li><li>绑定IP地址和端口：udpSocket-&gt;bind(QHostAddress::AnyIPv4,port);&#x2F;&#x2F;port是端口号，任意指定，建议大于1024小于65535</li><li>连接接收数据槽函数   connect(udpSocket,&amp;QUdpSocket::readyRead,this,&amp;MainWindow::read_image);&#x2F;&#x2F;接收数据，处理函数为read_image</li><li>发送数据 udpSocket-&gt;writeDatagram(ui-&gt;textEdit-&gt;toPlainText().toUtf8(),QHostAddress(ui-&gt;linee_IP-&gt;text()),i-&gt;linee_port-&gt;text().toInt());</li></ol><h4 id="其它UDP库"><a href="#其它UDP库" class="headerlink" title="其它UDP库"></a>其它UDP库</h4><p>1.c++系统库 <code>&lt;sys/socket.h&gt;性能较高，非异步，可能会阻塞主线程，需要额外处理</code></p><p>2.libuv <code>&lt;uv.h&gt;异步，性能高，使用单独的事件循环</code></p><p>&lt;**处理接收数据**&gt;</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">QHostAddress address;</span><br><span class="line">    quint16 port;</span><br><span class="line"></span><br><span class="line">    QByteArray array;</span><br><span class="line">    array.<span class="built_in">resize</span>(udpSocket-&gt;<span class="built_in">bytesAvailable</span>());<span class="comment">//根据可读数据来设置空间大小</span></span><br><span class="line">    <span class="comment">//读取数据，获取客户端的IP地址和端口号</span></span><br><span class="line">    <span class="type">int</span> tmp = udpSocket-&gt;<span class="built_in">readDatagram</span>(array.<span class="built_in">data</span>(),array.<span class="built_in">size</span>(),&amp;address,&amp;port);</span><br><span class="line">    <span class="keyword">if</span> (tmp&gt;<span class="number">0</span>&amp;&amp;tmp&lt;=<span class="number">1000</span>) &#123;</span><br><span class="line">           ui-&gt;textEdit-&gt;<span class="built_in">append</span>(<span class="string">&quot;接收来自：&quot;</span>+address.<span class="built_in">toString</span>()+<span class="string">&quot;:&quot;</span>+QString::<span class="built_in">number</span>(port)+array);</span><br><span class="line">       &#125;</span><br><span class="line">    <span class="keyword">if</span> (array.<span class="built_in">size</span>() &gt;<span class="number">1000</span>) &#123; <span class="comment">// 假设2表示其他类型的消息</span></span><br><span class="line">           <span class="comment">// 处理其他类型的消息</span></span><br><span class="line"></span><br><span class="line">           <span class="function">QBuffer <span class="title">buffer</span><span class="params">(&amp;array)</span></span>;<span class="comment">//添加数据到缓冲器</span></span><br><span class="line">           buffer.<span class="built_in">open</span>(QIODevice::ReadOnly);<span class="comment">//读取</span></span><br><span class="line"></span><br><span class="line">           <span class="function">QImageReader <span class="title">reader</span><span class="params">(&amp;buffer,<span class="string">&quot;JPG&quot;</span>)</span></span>;<span class="comment">//读取img</span></span><br><span class="line">           QImage img = reader.<span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span>(!img.<span class="built_in">isNull</span>())&#123;</span><br><span class="line"></span><br><span class="line">               QMessageBox::<span class="built_in">information</span>(<span class="literal">NULL</span>,<span class="string">&quot;ima&quot;</span>,<span class="string">&quot;ima&quot;</span>);</span><br><span class="line">               ui-&gt;lb_image_show-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(img));</span><br><span class="line">               ui-&gt;lb_image_show-&gt;<span class="built_in">show</span>();</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="built_in">qDebug</span>()&lt;&lt;address&lt;&lt;<span class="string">&quot;---&quot;</span>&lt;&lt;port;</span><br><span class="line"></span><br><span class="line">           ui-&gt;textEdit-&gt;<span class="built_in">append</span>(<span class="string">&quot;接收来自：&quot;</span>+address.<span class="built_in">toString</span>()+<span class="string">&quot;:&quot;</span>+<span class="string">&quot;\r\n&quot;</span>+QString::<span class="built_in">number</span>(port)+array.<span class="built_in">toHex</span>());</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>&lt;**发送图像数据**&gt;</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">QString filename = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>, <span class="built_in">tr</span>(<span class="string">&quot;选择图片&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="built_in">tr</span>(<span class="string">&quot;图片文件 (*.png *.jpg *.jpeg)&quot;</span>));</span><br><span class="line">   <span class="keyword">if</span> (!filename.<span class="built_in">isEmpty</span>()) &#123;</span><br><span class="line">   <span class="comment">// 打开图片并进行相应操作</span></span><br><span class="line"></span><br><span class="line">   QImage image;</span><br><span class="line">   <span class="keyword">if</span> (image.<span class="built_in">load</span>(filename)) &#123;</span><br><span class="line">       QLabel* label = ui-&gt;lb_image_show;</span><br><span class="line">       label-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(image));</span><br><span class="line">       label-&gt;<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       QByteArray byteArray;</span><br><span class="line">       QBuffer buffer;</span><br><span class="line">       buffer.<span class="built_in">open</span>(QIODevice::WriteOnly);</span><br><span class="line">       image.<span class="built_in">save</span>(&amp;buffer, <span class="string">&quot;JPG&quot;</span>);  <span class="comment">// 将图片数据保存到byteArray中</span></span><br><span class="line">       byteArray.<span class="built_in">append</span>(buffer.<span class="built_in">data</span>());</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(udpSocket-&gt;<span class="built_in">writeDatagram</span>(byteArray.<span class="built_in">data</span>(),</span><br><span class="line">            byteArray.<span class="built_in">size</span>(), <span class="built_in">QHostAddress</span>(ui-&gt;linee_IP-&gt;<span class="built_in">text</span>()),</span><br><span class="line">                                    ui-&gt;linee_port-&gt;<span class="built_in">text</span>().<span class="built_in">toInt</span>())==<span class="number">-1</span>)&#123;</span><br><span class="line">           <span class="built_in">qDebug</span>()&lt;&lt;udpSocket-&gt;<span class="built_in">error</span>();</span><br><span class="line">           QMessageBox::<span class="built_in">warning</span>(<span class="literal">NULL</span>,<span class="string">&quot;erro&quot;</span>,udpSocket-&gt;<span class="built_in">errorString</span>());</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="comment">// 图片加载失败</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h3 id="libuv"><a href="#libuv" class="headerlink" title="libuv"></a>libuv</h3><h4 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h4><ol><li>下载源码 <a href="https://github.com/libuv/libuv.git">https://github.com/libuv/libuv.git</a></li><li>下载cmake</li><li>cmake编译源码，使用msvc编译器，记住构建路径，点configure后串口显示的内容中有（生成的lib文件，dll，都在这里）（第四第五步骤可以忽略）</li><li>打开编译好的内容，找到.sln文件打开工程</li><li>选择编译器，release，全部生成</li><li>添加lib文件，dll文件，源码中include文件夹，src文件夹到qt工程中。</li><li>还需要再pro文件中添加以下内容</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">DEFINES += _WIN32_WINNT=<span class="number">0x0602</span></span><br><span class="line">LIBS += -lws2_32</span><br><span class="line">LIBS += -lUserEnv</span><br><span class="line">LIBS += -lIPHLPAPI</span><br><span class="line">LIBS += -lPsapi</span><br><span class="line">LIBS += -ladvapi32</span><br><span class="line">LIBS += -lUser32</span><br><span class="line">LIBS += -lGdi32</span><br></pre></td></tr></table></figure><h2 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h2><h3 id="QThread-线程类"><a href="#QThread-线程类" class="headerlink" title="QThread 线程类"></a>QThread 线程类</h3><h4 id="常用操作函数"><a href="#常用操作函数" class="headerlink" title="常用操作函数"></a>常用操作函数</h4><p>QThread::QThread(QObject * parent&#x3D;0);   &#x2F;&#x2F;构造函数</p><p>void QThread::start();  &#x2F;&#x2F;启动线程</p><p>bool QThread::wait(unsigned long time &#x3D; ULONG_MAX); &#x2F;&#x2F;阻塞调用该函数线程</p><p>void QThread::terminate(); &#x2F;&#x2F;结束线程</p><p>启动线程后，QThread::run()会被调用；</p><h4 id="QThread操作步骤"><a href="#QThread操作步骤" class="headerlink" title="QThread操作步骤"></a>QThread操作步骤</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QThread&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>新建文件c++类，基类为QThread，继承QObject</li><li>头文件重写虚函数，virtual void run();</li><li>cpp实现，run();</li><li>回主线程，包含子线程头文件</li><li>创建子线程类，MyThread mt；  mt.start();</li></ol><h3 id="QSemaphore-同步"><a href="#QSemaphore-同步" class="headerlink" title="QSemaphore 同步"></a>QSemaphore 同步</h3><p><a href="https://www.bilibili.com/video/BV1ka411y7oP?p=2&amp;spm_id_from=pageDriver&amp;vd_source=468a1f7565d351f1fb1599d05949abd0">https://www.bilibili.com/video/BV1ka411y7oP?p=2&amp;spm_id_from=pageDriver&amp;vd_source=468a1f7565d351f1fb1599d05949abd0</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QSemaphore&gt;</span></span></span><br></pre></td></tr></table></figure><ol><li>新建文件，SemManager，</li><li>包含QSemaphore，私有化单例：SemManager</li><li>公有成员 QSemaphore semA，semB,构造函数分别赋值1，和0</li><li>创建一个单例模式</li><li>子线程中调用sm-&gt;semB.acquire();阻塞B</li><li>子线程中调用sm-&gt;semA.release();释放A</li><li>另一个子线程顺序相反，先sm-&gt;semA.acquire();阻塞B</li><li>然后sm-&gt;semB.release();释放B</li><li>以此实现同步</li></ol><h3 id="QMutex-互斥"><a href="#QMutex-互斥" class="headerlink" title="QMutex  互斥"></a>QMutex  互斥</h3><p>保护一段代码同一个时刻只有一个线程可以执行</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMutex&gt;</span></span></span><br></pre></td></tr></table></figure><p>常用成员函数：</p><p>QMutex::QMutex(RecurisonMode mode&#x3D; NonRescursive)&#x2F;&#x2F;构造函数<br>void QMutex::lock();&#x2F;&#x2F;上锁<br>void QMutex::unlock();&#x2F;&#x2F;解锁</p><h3 id="moveToThread-委托槽函数给线程执行"><a href="#moveToThread-委托槽函数给线程执行" class="headerlink" title="moveToThread    委托槽函数给线程执行"></a>moveToThread    委托槽函数给线程执行</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QThread&gt;</span></span></span><br><span class="line">SlotObject *slotObj =<span class="keyword">new</span> <span class="built_in">SlotObject</span>(); <span class="comment">//槽函数，功能实现子类,**moveToThread时不能指定父对象**因为没有指定父对象，所以需要自己析构（在关闭窗口中，写delete slotObj;）</span></span><br><span class="line">QThread *thread = <span class="keyword">new</span> <span class="built_in">QThread</span>(<span class="keyword">this</span>);     <span class="comment">//创建一个线程类</span></span><br><span class="line">slotObj-&gt;<span class="built_in">moveToThread</span>(thread);<span class="comment">//委托线程</span></span><br><span class="line"><span class="built_in">connect</span>(ui-&gt;btn_start,QPushbutton::clicked,slotObj,SlotObject::fun);</span><br><span class="line">thread-&gt;<span class="built_in">start</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="插件QPlagin-带界面动态库"><a href="#插件QPlagin-带界面动态库" class="headerlink" title="插件QPlagin(带界面动态库)"></a>插件QPlagin(带界面动态库)</h2><p><a href="https://www.bilibili.com/video/BV1Sh4y1X7wQ/?spm_id_from=333.999.0.0&vd_source=468a1f7565d351f1fb1599d05949abd0">参考视频</a></p><ul><li>创建主框架程序</li><li>创建插件工程</li><li>插件工程添加界面类</li><li>插件创建头文件</li><li>定义接口</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> PLUGININTERFACE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLUGININTERFACE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Qwidget&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PluginInterfaceIID <span class="string">&quot;com.szweebon.PluginInterface/1.0.0&quot;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PluginInterface</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">virtual</span> ~<span class="built_in">PluginInterface</span>() = <span class="keyword">default</span>;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> QWidget *<span class="title">genWidget</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">Q_DECLARE_INTERFACE</span>(PluginInterface，PluginInterfaceIID)</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// PLUGININTERFACE_H</span></span></span><br></pre></td></tr></table></figure><p>未完待续</p><h2 id="树形结构浏览器"><a href="#树形结构浏览器" class="headerlink" title="树形结构浏览器"></a>树形结构浏览器</h2><h2 id="显示图片"><a href="#显示图片" class="headerlink" title="显示图片"></a>显示图片</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//QLabel显示OpenCV图像</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_pushButton_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Mat srcImg = <span class="built_in">imread</span>(<span class="string">&quot;1.jpg&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(srcImg.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;警告&quot;</span>,<span class="string">&quot;图片读取失败，请检查图片路径！&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Mat imgShow;</span><br><span class="line">    <span class="built_in">cvtColor</span>(srcImg, imgShow, COLOR_BGR2RGB); <span class="comment">// 图像格式转换</span></span><br><span class="line">    QImage qImg = <span class="built_in">QImage</span>((<span class="type">unsigned</span> <span class="type">char</span>*)(imgShow.data), imgShow.cols,</span><br><span class="line">                             imgShow.rows, imgShow.cols*imgShow.<span class="built_in">channels</span>(), QImage::Format_RGB888);</span><br><span class="line">    ui-&gt;label-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(qImg.<span class="built_in">scaled</span>(ui-&gt;label-&gt;<span class="built_in">size</span>(), Qt::KeepAspectRatio)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Graphics View显示OpenCV图像</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_pushButton_2_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Mat srcImg = <span class="built_in">imread</span>(<span class="string">&quot;2.jpg&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(srcImg.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;警告&quot;</span>,<span class="string">&quot;图片读取失败，请检查图片路径！&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Mat imgShow;</span><br><span class="line">    <span class="built_in">cvtColor</span>(srcImg, imgShow, COLOR_BGR2RGB); <span class="comment">// 图像格式转换</span></span><br><span class="line">    QImage qImg = <span class="built_in">QImage</span>((<span class="type">unsigned</span> <span class="type">char</span>*)(imgShow.data), imgShow.cols,</span><br><span class="line">                             imgShow.rows, imgShow.cols*imgShow.<span class="built_in">channels</span>(), QImage::Format_RGB888);</span><br><span class="line"></span><br><span class="line">    QGraphicsScene *scene = <span class="keyword">new</span> QGraphicsScene;<span class="comment">//图像显示</span></span><br><span class="line">    ui-&gt;graphicsView-&gt;<span class="built_in">setScene</span>(scene);</span><br><span class="line">    ui-&gt;graphicsView-&gt;<span class="built_in">show</span>();</span><br><span class="line">    scene-&gt;<span class="built_in">addPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(qImg));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> Qt </tag>
            
            <tag> UDP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt基础</title>
      <link href="/2023/11/17/Qt/Qt_ini_%E7%BC%96%E7%A0%81/"/>
      <url>/2023/11/17/Qt/Qt_ini_%E7%BC%96%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="Qt"><a href="#Qt" class="headerlink" title="Qt"></a>Qt</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QByteArray data;</span><br><span class="line">    data.<span class="built_in">clear</span>();</span><br><span class="line">    data.<span class="built_in">append</span>(<span class="number">0xac</span>);</span><br><span class="line">    data.<span class="built_in">append</span>(<span class="number">0x02</span>);</span><br><span class="line">    data.<span class="built_in">append</span>(<span class="number">0x55</span>);</span><br><span class="line">    serial-&gt;<span class="built_in">write</span>(data);</span><br></pre></td></tr></table></figure><h2 id="ini文件中文"><a href="#ini文件中文" class="headerlink" title="ini文件中文"></a>ini文件中文</h2><p>Qt的ini配置文件默认不支持直接读写中文，需要手动设置下编码格式才行，强烈建议统一用utf-8<br>编码，包括代码文件。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置了编码以后配置文件内容为 Company=上海物联网技术研究中心</span></span><br><span class="line"><span class="comment">//没有设置编码则配置文件内容为</span></span><br><span class="line">Company=\xe4\xb8\x8a\xe6\xb5\xb7\xe7\x89\xa9\xe8\x81\x94\xe7\xbd\x91\xe6\x8a</span><br><span class="line">\x80\xe6\x9c\xaf\xe7\xa0\x94\xe7\xa9\xb6\xe4\xb8\xad\xe5\xbf\x83</span><br><span class="line"><span class="type">void</span> App::<span class="built_in">readConfig</span>()</span><br><span class="line">&#123;</span><br><span class="line">QSettings <span class="built_in">set</span>(App::ConfigFile, QSettings::IniFormat);</span><br><span class="line">set.<span class="built_in">setIniCodec</span>(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">set.<span class="built_in">beginGroup</span>(<span class="string">&quot;AppConfig1&quot;</span>);</span><br><span class="line">App::Company = set.<span class="built_in">value</span>(<span class="string">&quot;Company&quot;</span>, App::Company).<span class="built_in">toString</span>();</span><br><span class="line">set.<span class="built_in">endGroup</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">App::writeConfig</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">QSettings <span class="title">set</span><span class="params">(App::ConfigFile, QSettings::IniFormat)</span></span>;</span><br><span class="line">set.<span class="built_in">setIniCodec</span>(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">set.<span class="built_in">beginGroup</span>(<span class="string">&quot;AppConfig1&quot;</span>);</span><br><span class="line">set.<span class="built_in">setValue</span>(<span class="string">&quot;Company&quot;</span>, App::Company);</span><br><span class="line">set.<span class="built_in">endGroup</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技术 </tag>
            
            <tag> Qt </tag>
            
            <tag> 乱码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一体机-图像处理时间计算</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E4%B8%80%E4%BD%93%E6%9C%BA/%E4%B8%80%E4%BD%93%E6%9C%BA%E6%97%B6%E9%97%B4%E5%85%AC%E5%BC%8F%E8%AE%A1%E7%AE%97/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E4%B8%80%E4%BD%93%E6%9C%BA/%E4%B8%80%E4%BD%93%E6%9C%BA%E6%97%B6%E9%97%B4%E5%85%AC%E5%BC%8F%E8%AE%A1%E7%AE%97/</url>
      
        <content type="html"><![CDATA[<h1 id="一体机处理时间计算"><a href="#一体机处理时间计算" class="headerlink" title="一体机处理时间计算"></a>一体机处理时间计算</h1><h2 id="相关参数（数据来源：上海富永）"><a href="#相关参数（数据来源：上海富永）" class="headerlink" title="相关参数（数据来源：上海富永）"></a>相关参数（数据来源：上海富永）</h2><ul><li>速度：50片&#x2F;分钟</li><li>产品长度：120毫米</li><li>产品间隔：360毫米</li><li>编码器型号：2000</li><li>编码器周长：300毫米</li><li>踢废位置间隔：400毫米</li><li>踢废脉冲间隔：1000</li></ul><h2 id="拍照"><a href="#拍照" class="headerlink" title="拍照"></a>拍照</h2><ol><li><p><strong>完整公式</strong></p><p> t&#x3D;（产品长度+产品间隔）&#x2F;（（产品长度+产品间隔）<em>（速度）&#x2F;60）</em>1000</p></li><li><p><strong>简化公式</strong></p><p> t&#x3D;60&#x2F;速度*1000</p></li></ol><h2 id="踢废"><a href="#踢废" class="headerlink" title="踢废"></a>踢废</h2><ol><li><p><strong>完整公式</strong></p><p> t&#x3D;（踢废间隔-（产品长度&#x2F;2））&#x2F;（编码器周长<em>（（产品长度+产品间隔）</em>60&#x2F;（每圈周长<em>60）））</em>1000</p></li><li><p><strong>解析：</strong></p><p> t&#x3D;S&#x2F;V<br> 时间&#x3D;距离&#x2F;每秒速度<br> S&#x3D;（踢废间隔-产品长度&#x2F;2）<br> V&#x3D;（编码器周长<em>（（50</em>（120+360）&#x2F;300）&#x2F;60））</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 一体机控制器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 一体机控制器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>STM32-HAL库</title>
      <link href="/2023/11/17/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/%E7%BC%96%E7%A8%8B/STM32-HAL%E5%BA%93/"/>
      <url>/2023/11/17/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/%E7%BC%96%E7%A8%8B/STM32-HAL%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h1 id="STM32-HAL库"><a href="#STM32-HAL库" class="headerlink" title="STM32-HAL库"></a>STM32-HAL库</h1><h2 id="cubemx创建工程"><a href="#cubemx创建工程" class="headerlink" title="cubemx创建工程"></a>cubemx创建工程</h2><h3 id="下载cubemx"><a href="#下载cubemx" class="headerlink" title="下载cubemx"></a>下载cubemx</h3><p><a href="https://www.st.com/zh/microcontrollers-microprocessors/stm32-32-bit-arm-cortex-mcus.html#tools-software">下载链接:STM32CubeMX</a></p><h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><p>安装路径中不得出现中文,一路下一步即可</p><h3 id="安装基础包"><a href="#安装基础包" class="headerlink" title="安装基础包"></a>安装基础包</h3><p>找到需要的芯片,展开,勾选需要安装的版本,点击install安装即可,该方式为网络安装,时间较长.</p><p><img src="/.com//STM32-HAL%E5%BA%93/1711533516759.png" alt="1711533516759"></p><p><img src="/.com//STM32-HAL%E5%BA%93/1711533526818.png" alt="1711533526818"></p><h3 id="新建工程"><a href="#新建工程" class="headerlink" title="新建工程"></a>新建工程</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533535631.png" alt="1711533535631"></p><h3 id="选择芯片"><a href="#选择芯片" class="headerlink" title="选择芯片"></a>选择芯片</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533544089.png" alt="1711533544089"></p><h3 id="配置引脚"><a href="#配置引脚" class="headerlink" title="配置引脚"></a>配置引脚</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533552679.png" alt="1711533552679"></p><h3 id="配置时钟-外部时钟源"><a href="#配置时钟-外部时钟源" class="headerlink" title="配置时钟(外部时钟源)"></a>配置时钟(外部时钟源)</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533561859.png" alt="1711533561859"></p><p><img src="/.com//STM32-HAL%E5%BA%93/1711533570357.png" alt="1711533570357"></p><h3 id="配置swd"><a href="#配置swd" class="headerlink" title="配置swd"></a>配置swd</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533579302.png" alt="1711533579302"></p><h3 id="配置定时器-需完善"><a href="#配置定时器-需完善" class="headerlink" title="配置定时器(需完善)"></a>配置定时器(需完善)</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533587286.png" alt="1711533587286"></p><h3 id="配置SPI"><a href="#配置SPI" class="headerlink" title="配置SPI"></a>配置SPI</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533596345.png" alt="1711533596345"></p><h3 id="配置IIC"><a href="#配置IIC" class="headerlink" title="配置IIC"></a>配置IIC</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533606269.png" alt="1711533606269"></p><h3 id="配置USART"><a href="#配置USART" class="headerlink" title="配置USART"></a>配置USART</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533614736.png" alt="1711533614736"></p><h3 id="配置ADC"><a href="#配置ADC" class="headerlink" title="配置ADC"></a>配置ADC</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533623669.png" alt="1711533623669"></p><h3 id="配置DAC"><a href="#配置DAC" class="headerlink" title="配置DAC"></a>配置DAC</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533632742.png" alt="1711533632742"></p><h3 id="设置工程"><a href="#设置工程" class="headerlink" title="设置工程"></a>设置工程</h3><p><img src="/.com//STM32-HAL%E5%BA%93/1711533640808.png" alt="1711533640808"><br><img src="/.com//STM32-HAL%E5%BA%93/1711533648469.png" alt="1711533648469"></p><h3 id="生成代码"><a href="#生成代码" class="headerlink" title="生成代码"></a>生成代码</h3><p>确保工程路径后点击,GENERATE CODE</p><p><img src="/.com//STM32-HAL%E5%BA%93/1711533657277.png" alt="1711533657277"></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
          <category> STM32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> STM32 </tag>
            
            <tag> HAL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>差分编码器转接板说明书</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%B7%AE%E5%88%86%E4%BF%A1%E5%8F%B7%E8%BD%AC%E6%8E%A5%E6%9D%BF/%E5%B7%AE%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8%E8%BD%AC%E6%8E%A5%E6%9D%BF%E8%AF%B4%E6%98%8E%E4%B9%A6/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%B7%AE%E5%88%86%E4%BF%A1%E5%8F%B7%E8%BD%AC%E6%8E%A5%E6%9D%BF/%E5%B7%AE%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8%E8%BD%AC%E6%8E%A5%E6%9D%BF%E8%AF%B4%E6%98%8E%E4%B9%A6/</url>
      
        <content type="html"><![CDATA[<h1 id="差分编码器转接板"><a href="#差分编码器转接板" class="headerlink" title="差分编码器转接板"></a>差分编码器转接板</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ol><li>差分编码器转接板，由差分编码器输入差分信号，输出差分信号给线扫相机，输出IO信号给控制器，实现差分信号到差分信号的转换。</li><li>差分编码器转接板还集成了一个24V（9V~26V）-5V的电源，用于给差分编码器供电。</li><li>控制器可以输出IO信号给差分编码器转接板，用于控制差分编码器转接板的差分信号输出开关。</li></ol><!-- ## 原理图 --><!-- ![原理图](image/SCH_STM32F103C8T6_1-P1_2023-09-11.png) --><h2 id="管脚定义"><a href="#管脚定义" class="headerlink" title="管脚定义"></a>管脚定义</h2><p><img src="/.com//%E5%B7%AE%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8%E8%BD%AC%E6%8E%A5%E6%9D%BF%E8%AF%B4%E6%98%8E%E4%B9%A6/1711531563017.png" alt="1711531563017"></p><h2 id="功能定义"><a href="#功能定义" class="headerlink" title="功能定义"></a>功能定义</h2><table><thead><tr><th>引脚</th><th>功能描述</th><th>备注</th></tr></thead><tbody><tr><td>GND</td><td>电源负极引脚</td><td>接开关电源</td></tr><tr><td>24V</td><td>电源正极引脚</td><td>接开关电源</td></tr><tr><td>TRA-</td><td>差分输出A-</td><td>接相机input-</td></tr><tr><td>TRA+</td><td>差分输出A+</td><td>接相机input+</td></tr><tr><td>TRB-</td><td>差分输出B-</td><td>接相机input-</td></tr><tr><td>TRB+</td><td>差分输出B+</td><td>接相机input+</td></tr><tr><td>GND</td><td>电源负极引脚</td><td>接差分编码器</td></tr><tr><td>5V</td><td>5V供电输出</td><td>接差分编码器</td></tr><tr><td>EN_A-</td><td>差分信号输入</td><td>接差分编码器A-</td></tr><tr><td>EN_A+</td><td>差分信号输入</td><td>接差分编码器A+</td></tr><tr><td>EN_B-</td><td>差分信号输入</td><td>接差分编码器B-</td></tr><tr><td>EN_B+</td><td>差分信号输入</td><td>接差分编码器B+</td></tr><tr><td>EN_Z-</td><td>差分信号输入</td><td>接差分编码器Z-</td></tr><tr><td>EN_Z+</td><td>差分信号输入</td><td>接差分编码器Z+</td></tr><tr><td>IO_A</td><td>使能差分输出</td><td>默认开启，输入信号关闭。接控制器，IO引脚，控制差分输出A</td></tr><tr><td>IO_B</td><td>使能差分呼出</td><td>默认开启，输入信号关闭。接控制器，IO引脚，控制差分输出B</td></tr><tr><td>OUTA</td><td>差分转电极</td><td>接控制器编码器输入引脚A</td></tr><tr><td>OUTB</td><td>差分转电极</td><td>预留</td></tr><tr><td>OUTZ</td><td>差分转电极</td><td>接控制器编码器输入引脚Z</td></tr></tbody></table><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>差分编码器转接板统一使用500P&#x2F;R的差分编码器输入信号</li></ol><h2 id="控制器设置"><a href="#控制器设置" class="headerlink" title="控制器设置"></a>控制器设置</h2><ol><li>参数设置<ul><li>编码器型号：倍频后的一圈脉冲数量<br><img src="/.com//%E5%B7%AE%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8%E8%BD%AC%E6%8E%A5%E6%9D%BF%E8%AF%B4%E6%98%8E%E4%B9%A6/1711531575468.png" alt="1711531575468"></li><li>高级-&gt;差分编码器倍频系数：与相机设置的倍频系数一致<br><img src="/.com//%E5%B7%AE%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8%E8%BD%AC%E6%8E%A5%E6%9D%BF%E8%AF%B4%E6%98%8E%E4%B9%A6/1711531584264.png" alt="1711531584264"></li></ul></li></ol><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ol><li>卫品（帧触发）</li><li>卫材</li></ol><h2 id="参考资料（相机驱动设置编码器模式以及倍频）"><a href="#参考资料（相机驱动设置编码器模式以及倍频）" class="headerlink" title="参考资料（相机驱动设置编码器模式以及倍频）"></a>参考资料（相机驱动设置编码器模式以及倍频）</h2><ol><li><a href="Basler.html">Basler相机差分编码器设置及倍频设置</a></li><li><a href="HIK.html">海康相机差分编码器设置及倍频设置</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 差分编码器转接板 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 差分编码器转接板 </tag>
            
            <tag> 倍分频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>复卷瑕疵定位系统</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E5%A4%8D%E5%8D%B7%E7%91%95%E7%96%B5%E5%AE%9A%E4%BD%8D%E7%B3%BB%E7%BB%9F/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E5%A4%8D%E5%8D%B7%E7%91%95%E7%96%B5%E5%AE%9A%E4%BD%8D%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="复卷瑕疵定位系统"><a href="#复卷瑕疵定位系统" class="headerlink" title="复卷瑕疵定位系统"></a>复卷瑕疵定位系统</h1><h2 id="产线速度计算公式"><a href="#产线速度计算公式" class="headerlink" title="产线速度计算公式"></a>产线速度计算公式</h2><p>$$生产速度&#x3D;频率<em>60&#x2F;脉冲数量</em>(脉冲数量&#x2F;压轮周长)$$<br>$$speed&#x3D;frequency<em>60&#x2F;pulseNumber</em>(pulseNumber&#x2F;perimeter)$$</p><h2 id="减速度计算公式"><a href="#减速度计算公式" class="headerlink" title="减速度计算公式"></a>减速度计算公式</h2><p>$$减速度&#x3D;运行速度&#x2F;减速时间$$<br>$$reduceSpeed&#x3D;runningSpeed&#x2F;decelerationTime$$</p><h2 id="锥度计算公式"><a href="#锥度计算公式" class="headerlink" title="锥度计算公式"></a>锥度计算公式</h2><p>$$减速距离&#x3D;0.5*(运行速度&#x2F;减速时间)<em>减速时间²+初始速度</em>时间$$</p><h2 id="位移反推适当速度"><a href="#位移反推适当速度" class="headerlink" title="位移反推适当速度"></a>位移反推适当速度</h2><h3 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h3><p>$$时间&#x3D;\sqrt[]{距离&#x2F;(0.5*减速度)}$$</p><h3 id="速度"><a href="#速度" class="headerlink" title="速度"></a>速度</h3><p>$$速度&#x3D;时间*加速度$$</p><h2 id="收卷寻疵停机距离递增计算公式"><a href="#收卷寻疵停机距离递增计算公式" class="headerlink" title="收卷寻疵停机距离递增计算公式"></a>收卷寻疵停机距离递增计算公式</h2><h3 id="计算圈数"><a href="#计算圈数" class="headerlink" title="计算圈数"></a>计算圈数</h3><p>$$当前圈数&#x3D;(-2<em>PI</em>初始半径+\sqrt[]{(4<em>PI²</em>初始半径²+4<em>厚度</em>材料长度<em>PI)})&#x2F;(2</em>厚度*PI)$$</p><h3 id="外圈半径"><a href="#外圈半径" class="headerlink" title="外圈半径"></a>外圈半径</h3><p>$$外圈半径&#x3D;初始半径+当前圈数*厚度$$</p><h3 id="外圈周长"><a href="#外圈周长" class="headerlink" title="外圈周长"></a>外圈周长</h3><p>$$外圈周长&#x3D;2<em>PI</em>外圈半径$$</p><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><ol><li>增加高低速分段速度模型控制,以探标位置为分割点,探标前处于高速模型,探标后处于低速模型.</li></ol>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 复卷瑕疵定位系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品 </tag>
            
            <tag> 复卷瑕疵定位系统 </tag>
            
            <tag> 复卷 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>检测停机-Dalsa倍分频-差分转接板-控制器</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E5%A4%8D%E5%8D%B7%E6%9C%BA/%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="检测停机"><a href="#检测停机" class="headerlink" title="检测停机"></a>检测停机</h1><h2 id="Dalsa倍频设置"><a href="#Dalsa倍频设置" class="headerlink" title="Dalsa倍频设置"></a>Dalsa倍频设置</h2><h3 id="下载SDK"><a href="#下载SDK" class="headerlink" title="下载SDK"></a>下载SDK</h3><p><a href="http://teledynedalsa.com/sapera-lt-dl/?dl=1&pkg=SDKWOW64&key=BezZNB87ZcwFO7mZ1Neb1g==">Sapera LT 8.73 SDK (WoW64)</a></p><p><a href="http://teledynedalsa.com/sapera-lt-dl/?dl=1&pkg=SDK&key=BezZNB87ZcwFO7mZ1Neb1g==">Sapera LT 8.73 SDK For Developers</a></p><h3 id="8K线扫-LA-GM-08K08A-00-R-Linea-M8192-7um-1"><a href="#8K线扫-LA-GM-08K08A-00-R-Linea-M8192-7um-1" class="headerlink" title="8K线扫(LA-GM-08K08A-00-R&#x2F;Linea_M8192-7um_1)"></a>8K线扫(LA-GM-08K08A-00-R&#x2F;Linea_M8192-7um_1)</h3><h4 id="接口-引脚定义"><a href="#接口-引脚定义" class="headerlink" title="接口&#x2F;引脚定义"></a>接口&#x2F;引脚定义</h4><p><img src="/.com//%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/1711534122220.png" alt="1711534122220"></p><h4 id="倍频设置（编码器型号500，设置2000）"><a href="#倍频设置（编码器型号500，设置2000）" class="headerlink" title="倍频设置（编码器型号500，设置2000）"></a>倍频设置（编码器型号500，设置2000）</h4><ol><li>点击show more<img src="/.com//%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/1711534130041.png" alt="1711534130041"></li><li>Trigger Selector 选择 Single Line Trigger（Start）</li><li>Trigger Mode 选择 On</li><li>Trigger Source 选择 Rotary Encoder   （触发源选择编码器模式）</li><li>Trigger Overlap 选择 Readout</li><li>Rotary Encoder Output Mode 选择 Motion   （编码器方向：忽略方向）</li><li>Rotary Encoder Input A Source 选择 Line1 （编码器A）</li><li>Rotary Encoder Input B Source 选择 Line2 （编码器B）</li><li>Rotary Encoder Source Activation 选择 Any Edge   （边沿触发）</li><li>Rotary Encoder Multiplier 选择 1    （倍频）</li><li>Rotary Encoder Divider 选择 1   （分频）</li><li>Line Selector 选择 Line1    （设置Line1滤波）</li><li>Input Line Debouncing Period（in us）设置5  （滤波设置5us）</li><li>Line Selector 选择 Line2    （设置Line2滤波）</li><li>Input Line Debouncing Period（in us）设置5  （滤波设置5us）</li></ol><p><img src="/.com//%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/1711534139524.png" alt="1711534139524"></p><h4 id="PLC接线"><a href="#PLC接线" class="headerlink" title="PLC接线"></a>PLC接线</h4><p><img src="/.com//%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/1711534148259.png" alt="1711534148259"></p><h4 id="差分编码器转接板接线"><a href="#差分编码器转接板接线" class="headerlink" title="差分编码器转接板接线"></a>差分编码器转接板接线</h4><h5 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h5><ol><li>差分编码器转接板，由差分编码器输入差分信号，输出差分信号给线扫相机，输出IO信号给控制器，实现差分信号到差分信号的转换。</li><li>差分编码器转接板还集成了一个24V（9V~26V）-5V的电源，用于给差分编码器供电。</li><li>控制器可以输出IO信号给差分编码器转接板，用于控制差分编码器转接板的差分信号输出开关。</li></ol><!-- ## 原理图 --><!-- ![原理图](image/SCH_STM32F103C8T6_1-P1_2023-09-11.png) --><h5 id="管脚定义"><a href="#管脚定义" class="headerlink" title="管脚定义"></a>管脚定义</h5><p><img src="/.com//%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/1711534157609.png" alt="1711534157609"></p><h5 id="功能定义"><a href="#功能定义" class="headerlink" title="功能定义"></a>功能定义</h5><table><thead><tr><th>引脚</th><th>功能描述</th><th>备注</th></tr></thead><tbody><tr><td>GND</td><td>电源负极引脚</td><td>接开关电源</td></tr><tr><td>24V</td><td>电源正极引脚</td><td>接开关电源</td></tr><tr><td>TRA-</td><td>差分输出A-</td><td>接相机input-</td></tr><tr><td>TRA+</td><td>差分输出A+</td><td>接相机input+</td></tr><tr><td>TRB-</td><td>差分输出B-</td><td>接相机input-</td></tr><tr><td>TRB+</td><td>差分输出B+</td><td>接相机input+</td></tr><tr><td>GND</td><td>电源负极引脚</td><td>接差分编码器</td></tr><tr><td>5V</td><td>5V供电输出</td><td>接差分编码器</td></tr><tr><td>EN_A-</td><td>差分信号输入</td><td>接差分编码器A-</td></tr><tr><td>EN_A+</td><td>差分信号输入</td><td>接差分编码器A+</td></tr><tr><td>EN_B-</td><td>差分信号输入</td><td>接差分编码器B-</td></tr><tr><td>EN_B+</td><td>差分信号输入</td><td>接差分编码器B+</td></tr><tr><td>EN_Z-</td><td>差分信号输入</td><td>接差分编码器Z-</td></tr><tr><td>EN_Z+</td><td>差分信号输入</td><td>接差分编码器Z+</td></tr><tr><td>IO_A</td><td>使能差分输出</td><td>默认开启，输入信号关闭。接控制器，IO引脚，控制差分输出A</td></tr><tr><td>IO_B</td><td>使能差分呼出</td><td>默认开启，输入信号关闭。接控制器，IO引脚，控制差分输出B</td></tr><tr><td>OUTA</td><td>差分转电极</td><td>接控制器编码器输入引脚A</td></tr><tr><td>OUTB</td><td>差分转电极</td><td>预留</td></tr><tr><td>OUTZ</td><td>差分转电极</td><td>接控制器编码器输入引脚Z</td></tr></tbody></table><h5 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h5><ol><li>差分编码器转接板统一使用500P&#x2F;R的差分编码器输入信号</li></ol><h5 id="控制器设置"><a href="#控制器设置" class="headerlink" title="控制器设置"></a>控制器设置</h5><ol><li>参数设置<ul><li>编码器型号：倍频后的一圈脉冲数量<br> <img src="/.com//%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/1711534169103.png" alt="1711534169103"></li><li>高级-&gt;差分编码器倍频系数：与相机设置的倍频系数一致<br> <img src="/.com//%E6%A3%80%E6%B5%8B%E5%81%9C%E6%9C%BA%E7%B3%BB%E7%BB%9F/1711534178587.png" alt="1711534178587"></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 检测停机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 控制器 </tag>
            
            <tag> 产品 </tag>
            
            <tag> 检测停机 </tag>
            
            <tag> Dalsa </tag>
            
            <tag> 倍频 </tag>
            
            <tag> 差分转接板 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>控制器-串口1对多方案设计</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8E%A7%E5%88%B6%E5%99%A8/%E6%8E%A7%E5%88%B6%E5%99%A8-%E4%B8%80%E4%B8%BB%E5%A4%9A%E4%BB%8E/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/%E6%8E%A7%E5%88%B6%E5%99%A8/%E6%8E%A7%E5%88%B6%E5%99%A8-%E4%B8%80%E4%B8%BB%E5%A4%9A%E4%BB%8E/</url>
      
        <content type="html"><![CDATA[<h1 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h1><h2 id="1-串口1对多方案设计"><a href="#1-串口1对多方案设计" class="headerlink" title="1.串口1对多方案设计"></a>1.串口1对多方案设计</h2><h3 id="1-1需求一"><a href="#1-1需求一" class="headerlink" title="1.1需求一"></a>1.1需求一</h3><ul><li>黄冈稳健：主机1，控制器10，用来踢废。纵向精度毫米级</li></ul><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><ul><li>主机使用串口1，串口转485通信，485转串口接控制器，作为通信组网硬件配置</li><li>控制器协议使用自定义的带协议站号，寄存器地址分配，写入和读取的协议</li><li>协议简述：站号0，作为广播通用配置，用于配置站号属性</li><li>功能地址位：1~100为硬件写功能地址</li><li>功能地址位：1000~1120为写掉电保持地址</li><li>功能地址位：3001~6000为硬件读功能地址</li><li>功能地址位：60000~65535为保留地址</li></ul><h3 id="1-2需求二"><a href="#1-2需求二" class="headerlink" title="1.2需求二"></a>1.2需求二</h3><ul><li>杭州豪悦: 主机1，控制器1，相机2</li></ul><h4 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h4><ul><li>主机使用串口1，从机通信参考上述黄冈稳健，编码器为1个，两个相机，功能：标准控制器功能即可</li></ul>]]></content>
      
      
      <categories>
          
          <category> 产品 </category>
          
          <category> 控制器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 控制器 </tag>
            
            <tag> 通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>qudpsocket</title>
      <link href="/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/qudpsocket/"/>
      <url>/2023/11/17/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/qudpsocket/</url>
      
        <content type="html"><![CDATA[<h1 id="QUdpSocket"><a href="#QUdpSocket" class="headerlink" title="QUdpSocket"></a>QUdpSocket</h1><h2 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h2><ol><li>pro文件添加模块，QT       +&#x3D;  network</li><li>添加头文件#include <code>&lt;QUdpSocket&gt;</code> <code>&lt;QHostAddress&gt;</code></li><li>创建对象并实例化  private:    QUdpSocket *udpSocket;    udpSocket&#x3D;new QUdpSocket(this);</li><li>绑定IP地址和端口：udpSocket-&gt;bind(QHostAddress::AnyIPv4,port);&#x2F;&#x2F;port是端口号，任意指定，建议大于1024小于65535</li><li>连接接收数据槽函数   connect(udpSocket,&amp;QUdpSocket::readyRead,this,&amp;MainWindow::read_image);&#x2F;&#x2F;接收数据，处理函数为read_image</li><li>发送数据 udpSocket-&gt;writeDatagram(ui-&gt;textEdit-&gt;toPlainText().toUtf8(),QHostAddress(ui-&gt;linee_IP-&gt;text()),i-&gt;linee_port-&gt;text().toInt());</li></ol><h2 id="其它UDP库"><a href="#其它UDP库" class="headerlink" title="其它UDP库"></a>其它UDP库</h2><p>1.c++系统库 <code>&lt;sys/socket.h&gt;性能较高，非异步，可能会阻塞主线程，需要额外处理</code></p><p>2.libuv <code>&lt;uv.h&gt;异步，性能高，使用单独的事件循环</code></p><p>&lt;**处理接收数据**&gt;</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">QHostAddress address;</span><br><span class="line">    quint16 port;</span><br><span class="line"></span><br><span class="line">    QByteArray array;</span><br><span class="line">    array.<span class="built_in">resize</span>(udpSocket-&gt;<span class="built_in">bytesAvailable</span>());<span class="comment">//根据可读数据来设置空间大小</span></span><br><span class="line">    <span class="comment">//读取数据，获取客户端的IP地址和端口号</span></span><br><span class="line">    <span class="type">int</span> tmp = udpSocket-&gt;<span class="built_in">readDatagram</span>(array.<span class="built_in">data</span>(),array.<span class="built_in">size</span>(),&amp;address,&amp;port);</span><br><span class="line">    <span class="keyword">if</span> (tmp&gt;<span class="number">0</span>&amp;&amp;tmp&lt;=<span class="number">1000</span>) &#123;</span><br><span class="line">           ui-&gt;textEdit-&gt;<span class="built_in">append</span>(<span class="string">&quot;接收来自：&quot;</span>+address.<span class="built_in">toString</span>()+<span class="string">&quot;:&quot;</span>+QString::<span class="built_in">number</span>(port)+array);</span><br><span class="line">       &#125;</span><br><span class="line">    <span class="keyword">if</span> (array.<span class="built_in">size</span>() &gt;<span class="number">1000</span>) &#123; <span class="comment">// 假设2表示其他类型的消息</span></span><br><span class="line">           <span class="comment">// 处理其他类型的消息</span></span><br><span class="line"></span><br><span class="line">           <span class="function">QBuffer <span class="title">buffer</span><span class="params">(&amp;array)</span></span>;<span class="comment">//添加数据到缓冲器</span></span><br><span class="line">           buffer.<span class="built_in">open</span>(QIODevice::ReadOnly);<span class="comment">//读取</span></span><br><span class="line"></span><br><span class="line">           <span class="function">QImageReader <span class="title">reader</span><span class="params">(&amp;buffer,<span class="string">&quot;JPG&quot;</span>)</span></span>;<span class="comment">//读取img</span></span><br><span class="line">           QImage img = reader.<span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span>(!img.<span class="built_in">isNull</span>())&#123;</span><br><span class="line"></span><br><span class="line">               QMessageBox::<span class="built_in">information</span>(<span class="literal">NULL</span>,<span class="string">&quot;ima&quot;</span>,<span class="string">&quot;ima&quot;</span>);</span><br><span class="line">               ui-&gt;lb_image_show-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(img));</span><br><span class="line">               ui-&gt;lb_image_show-&gt;<span class="built_in">show</span>();</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="built_in">qDebug</span>()&lt;&lt;address&lt;&lt;<span class="string">&quot;---&quot;</span>&lt;&lt;port;</span><br><span class="line"></span><br><span class="line">           ui-&gt;textEdit-&gt;<span class="built_in">append</span>(<span class="string">&quot;接收来自：&quot;</span>+address.<span class="built_in">toString</span>()+<span class="string">&quot;:&quot;</span>+<span class="string">&quot;\r\n&quot;</span>+QString::<span class="built_in">number</span>(port)+array.<span class="built_in">toHex</span>());</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>&lt;**发送图像数据**&gt;</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">QString filename = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>, <span class="built_in">tr</span>(<span class="string">&quot;选择图片&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="built_in">tr</span>(<span class="string">&quot;图片文件 (*.png *.jpg *.jpeg)&quot;</span>));</span><br><span class="line">   <span class="keyword">if</span> (!filename.<span class="built_in">isEmpty</span>()) &#123;</span><br><span class="line">   <span class="comment">// 打开图片并进行相应操作</span></span><br><span class="line"></span><br><span class="line">   QImage image;</span><br><span class="line">   <span class="keyword">if</span> (image.<span class="built_in">load</span>(filename)) &#123;</span><br><span class="line">       QLabel* label = ui-&gt;lb_image_show;</span><br><span class="line">       label-&gt;<span class="built_in">setPixmap</span>(QPixmap::<span class="built_in">fromImage</span>(image));</span><br><span class="line">       label-&gt;<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       QByteArray byteArray;</span><br><span class="line">       QBuffer buffer;</span><br><span class="line">       buffer.<span class="built_in">open</span>(QIODevice::WriteOnly);</span><br><span class="line">       image.<span class="built_in">save</span>(&amp;buffer, <span class="string">&quot;JPG&quot;</span>);  <span class="comment">// 将图片数据保存到byteArray中</span></span><br><span class="line">       byteArray.<span class="built_in">append</span>(buffer.<span class="built_in">data</span>());</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(udpSocket-&gt;<span class="built_in">writeDatagram</span>(byteArray.<span class="built_in">data</span>(),</span><br><span class="line">            byteArray.<span class="built_in">size</span>(), <span class="built_in">QHostAddress</span>(ui-&gt;linee_IP-&gt;<span class="built_in">text</span>()),</span><br><span class="line">                                    ui-&gt;linee_port-&gt;<span class="built_in">text</span>().<span class="built_in">toInt</span>())==<span class="number">-1</span>)&#123;</span><br><span class="line">           <span class="built_in">qDebug</span>()&lt;&lt;udpSocket-&gt;<span class="built_in">error</span>();</span><br><span class="line">           QMessageBox::<span class="built_in">warning</span>(<span class="literal">NULL</span>,<span class="string">&quot;erro&quot;</span>,udpSocket-&gt;<span class="built_in">errorString</span>());</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="comment">// 图片加载失败</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> udp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> udp </tag>
            
            <tag> 测试 </tag>
            
            <tag> qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>npcap</title>
      <link href="/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/npcap/"/>
      <url>/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/npcap/</url>
      
        <content type="html"><![CDATA[<h1 id="Npcap"><a href="#Npcap" class="headerlink" title="Npcap"></a>Npcap</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul><li>官网下载：<a href="https://npcap.com/dist/npcap-sdk-1.13.zip">Npcap SDK 1.13 (ZIP).</a></li></ul><h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">├─docs</span><br><span class="line">│  └─wpcap</span><br><span class="line">├─Examples-pcap</span><br><span class="line">    ├─MakeAll.sln</span><br><span class="line">├─Examples-remote</span><br><span class="line">├─Include</span><br><span class="line">│  └─pcap</span><br><span class="line">└─Lib</span><br><span class="line">    ├─ARM64</span><br><span class="line">    └─x64</span><br></pre></td></tr></table></figure><p>其中需要关注的有Lib文件夹，以及Examples-pcap和Examples-remote文件夹。</p><h2 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h2><ul><li>打开Examples-pcap文件夹下的MakeAll.sln，使用Visual Studio 2019编译。</li><li>若编译失败，查看是否需要链接库，若需要，则将Lib-&gt;x64-&gt;下的wpcap.lib与Packet.lib添加到工程中。包含Include文件夹下的内容。</li></ul><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ul><li>设置udpdump为启动项（也可以是basic_dump），会弹出控制台窗口，输入数字选择网卡，即开启抓包。</li><li>修改printf内容，增加一个序号打印如下： <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//printf(&quot;%s,%.6d len:%d\n&quot;, timestr, header-&gt;ts.tv_usec, header-&gt;len);</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">i++;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d,l:%d\n&quot;</span>,i,header-&gt;len);</span><br></pre></td></tr></table></figure></li><li>测试抓包数量小于wireshark抓包速度，约为其一半左右，与第三方udp库速度差不多。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> udp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> udp </tag>
            
            <tag> 测试 </tag>
            
            <tag> npcap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>libuv</title>
      <link href="/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libuv/"/>
      <url>/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libuv/</url>
      
        <content type="html"><![CDATA[<h1 id="libuv"><a href="#libuv" class="headerlink" title="libuv"></a>libuv</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>libuv 是一个多平台 C 库，它支持基于事件循环的异步 I&#x2F;O。它支持 epoll（4）、kqueue（2）、Windows IOCP、Solaris 事件移植和 Linux io_uring。它主要设计用于 Node.js，但它也被其他软件项目使用。[3] 它最初是围绕 libev 或 Microsoft IOCP 的抽象，因为 libev 在 Windows 上不支持 IOCP。在 node-v0.9.0 的 libuv 版本中，删除了对 libev 的依赖。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul><li>vcpkg 安装    vcpkg install libuv</li><li>github上的<a href="https://github.com/libuv/libuv">libuv</a></li></ul><h2 id="客户端-服务器代码"><a href="#客户端-服务器代码" class="headerlink" title="客户端&#x2F;服务器代码"></a>客户端&#x2F;服务器代码</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFuture&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> *read_image_data;</span><br><span class="line"></span><br><span class="line">    <span class="type">uv_loop_t</span> *loop;        <span class="comment">//</span></span><br><span class="line">    <span class="type">uv_udp_t</span> send_socket;   <span class="comment">//“客户端”句柄，发送消息</span></span><br><span class="line">    <span class="type">uv_udp_t</span> recv_socket;   <span class="comment">//“服务器”句柄，接收消息</span></span><br><span class="line"></span><br><span class="line">    <span class="type">uv_udp_send_t</span> send_req;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">send_addr</span>;</span></span><br><span class="line">    <span class="type">uv_buf_t</span> discover_msg;</span><br><span class="line"></span><br><span class="line">    <span class="type">uv_buf_t</span> <span class="title function_">make_discover_msg</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">set_uv_receive</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    read_image_data = new <span class="type">char</span>[<span class="number">9</span>*<span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回初始化的默认循环。在以下情况下，它可能会返回 NULL。 分配失败。</span></span><br><span class="line">    <span class="comment">//此函数只是在整个过程中进行全局循环的便捷方式 一个应用程序，默认循环与默认循环没有任何不同 用 初始化。</span></span><br><span class="line">    <span class="comment">//因此，默认循环可以（和 应该）关闭，以便关联的资源 有了它就被释放了。</span></span><br><span class="line">    loop = uv_default_loop();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化新的 UDP 句柄。实际的套接字是延迟创建的。 成功时返回 0。</span></span><br><span class="line">    uv_udp_init(loop, &amp;recv_socket);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//结构体，成员有IP地址，端口号</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">recv_addr</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//将包含 IPv4 地址的字符串转换为二进制结构。</span></span><br><span class="line">    uv_ip4_addr(<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">6800</span>, &amp;recv_addr);   <span class="comment">//监听地址和端口</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    将IP地址和端口绑定到UDP 句柄。</span></span><br><span class="line">    <span class="comment">//    句柄 – UDP 句柄。。</span></span><br><span class="line">    <span class="comment">//    addr – 具有要绑定到的地址和端口的结构sockaddr_in或结构sockaddr_in6。</span></span><br><span class="line">    <span class="comment">//    flags – 指示套接字的绑定方式、、 以及受支持方式。UV_UDP_IPV6ONLYUV_UDP_REUSEADDRUV_UDP_RECVERR</span></span><br><span class="line">    <span class="comment">//    返回值:</span></span><br><span class="line">    <span class="comment">//    成功时为 0，失败时错误代码&lt; 0。</span></span><br><span class="line">    uv_udp_bind(&amp;recv_socket, (<span class="type">const</span> <span class="keyword">struct</span> sockaddr *)&amp;recv_addr, UV_UDP_REUSEADDR);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    准备接收数据。如果套接字以前未绑定 与它绑定到 0.0.0.0（“所有接口” IPv4 地址）和随机端口号。</span></span><br><span class="line">    <span class="comment">//    参数：</span></span><br><span class="line">    <span class="comment">//    句柄 – UDP 句柄。应该使用 初始化。</span></span><br><span class="line">    <span class="comment">//    alloc_cb – 需要临时存储时调用的回调。  //无法设置缓存区大小，默认使用系统参数（一般为4K~64K，即65535字节）</span></span><br><span class="line">    <span class="comment">//    recv_cb – 使用接收到的数据进行调用的回调。</span></span><br><span class="line">    <span class="comment">//    返回值:</span></span><br><span class="line">    <span class="comment">//    成功时为 0，失败时错误代码&lt; 0。</span></span><br><span class="line">    uv_udp_recv_start(&amp;recv_socket, alloc_buffer, on_read);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//发送消息，已验证成功</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化新的 UDP 句柄。实际的套接字是延迟创建的。 成功时返回 0。</span></span><br><span class="line">    uv_udp_init(loop, &amp;send_socket);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//绑定发送端的IP以及端口号</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">broadcast_addr</span>;</span></span><br><span class="line">    uv_ip4_addr(<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">6800</span>, &amp;broadcast_addr);</span><br><span class="line">    uv_udp_bind(&amp;send_socket, (<span class="type">const</span> <span class="keyword">struct</span> sockaddr *)&amp;broadcast_addr, <span class="number">0</span>);</span><br><span class="line">    uv_udp_set_broadcast(&amp;send_socket, <span class="number">1</span>);  <span class="comment">//打开或关闭广播功能，1为开启，0为关闭</span></span><br><span class="line"></span><br><span class="line">    discover_msg = make_discover_msg();</span><br><span class="line"></span><br><span class="line">    uv_ip4_addr(<span class="string">&quot;192.168.1.198&quot;</span>, <span class="number">6700</span>, &amp;send_addr);<span class="comment">//要发送到哪里</span></span><br><span class="line">    uv_udp_send(&amp;send_req, &amp;send_socket, &amp;discover_msg, <span class="number">1</span>, (<span class="type">const</span> <span class="keyword">struct</span> sockaddr *)&amp;send_addr, on_send);</span><br><span class="line"></span><br><span class="line">    uv_run(loop, UV_RUN_DEFAULT);</span><br><span class="line"></span><br><span class="line">    qDebug()&lt;&lt;<span class="string">&quot;end&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//void thread_uv_receive::on_send(uv_udp_send_t *req, int status) &#123;&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">alloc_buffer</span><span class="params">(<span class="type">uv_handle_t</span> *handle, <span class="type">size_t</span> suggested_size, <span class="type">uv_buf_t</span> *buf)</span> &#123;</span><br><span class="line">    buf-&gt;base =static_cast&lt;<span class="type">char</span> *&gt;( <span class="built_in">malloc</span>(suggested_size));</span><br><span class="line">    buf-&gt;len = suggested_size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">on_read</span><span class="params">(<span class="type">uv_udp_t</span> *req, <span class="type">ssize_t</span> nread, <span class="type">const</span> <span class="type">uv_buf_t</span> *buf, <span class="type">const</span> <span class="keyword">struct</span> sockaddr *addr, <span class="type">unsigned</span> flags)</span> &#123;</span><br><span class="line">    <span class="comment">//    qDebug()&lt;&lt;&quot;接收消息&quot;;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    qDebug()&lt;&lt;&quot;buf_base_size&quot;&lt;&lt;nread ;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    QByteArray j;</span></span><br><span class="line"><span class="comment">//    j.clear();</span></span><br><span class="line"><span class="comment">//    for(int i=0;i&lt;2;i++)&#123;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        j.append(buf-&gt;base[i]);</span></span><br><span class="line"><span class="comment">//        //        QString str=j.toHex();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    qDebug()&lt;&lt;&quot;buf_base:&quot;&lt;&lt;j.toHex();</span></span><br><span class="line">    <span class="comment">//    if(j.at(0)==0x60)</span></span><br><span class="line">    <span class="comment">//    uv_udp_send(&amp;send_req, &amp;send_socket, &amp;discover_msg, 1, (const struct sockaddr *)&amp;send_addr, on_send);</span></span><br><span class="line"><span class="comment">//    QFuture&lt;void&gt; future = QtConcurrent::run([=]()&#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="type">uint16_t</span> offset_data=<span class="number">6</span>;</span><br><span class="line">    <span class="type">uint16_t</span> index;</span><br><span class="line">    <span class="type">uint16_t</span> height_index= (((<span class="type">uint16_t</span>)buf-&gt;base[<span class="number">0</span>])&lt;&lt;<span class="number">8</span>)&amp;<span class="number">0xff00</span>;</span><br><span class="line">    index=height_index|(((<span class="type">uint16_t</span>)buf-&gt;base[<span class="number">1</span>])&amp;<span class="number">0x00ff</span>);</span><br><span class="line">    qDebug()&lt;&lt;<span class="string">&quot;index:&quot;</span>&lt;&lt;index;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    memcpy(read_image_data + index * (buf-&gt;len - offset_data),</span></span><br><span class="line"><span class="comment">//           buf-&gt;base + offset_data, buf-&gt;len - offset_data);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    if (nread &lt; 0) &#123;</span></span><br><span class="line"><span class="comment">//        fprintf(stderr, &quot;Read error %s\n&quot;, uv_err_name(nread));</span></span><br><span class="line"><span class="comment">//        uv_close((uv_handle_t*) req, NULL);</span></span><br><span class="line"><span class="comment">//        free(buf-&gt;base);</span></span><br><span class="line"><span class="comment">//        return;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    char sender[17] = &#123; 0 &#125;;</span></span><br><span class="line"><span class="comment">//    uv_ip4_name((const struct sockaddr_in*) addr, sender, 16);</span></span><br><span class="line"><span class="comment">//    //    fprintf(stderr, &quot;Recv from %s\n&quot;, sender);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    // ... DHCP specific code</span></span><br><span class="line"><span class="comment">//    unsigned int *as_integer = (unsigned int*)buf-&gt;base;</span></span><br><span class="line"><span class="comment">//    unsigned int ipbin = ntohl(as_integer[4]);</span></span><br><span class="line"><span class="comment">//    unsigned char ip[4] = &#123;0&#125;;</span></span><br><span class="line"><span class="comment">//    int i;</span></span><br><span class="line"><span class="comment">//    for (i = 0; i &lt; 4; i++)</span></span><br><span class="line"><span class="comment">//        ip[i] = (ipbin &gt;&gt; i*8) &amp; 0xff;</span></span><br><span class="line"><span class="comment">//    //    fprintf(stderr, &quot;Offered IP %d.%d.%d.%d\n&quot;, ip[3], ip[2], ip[1], ip[0]);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    //    free(buf-&gt;base);</span></span><br><span class="line"><span class="comment">//    //    uv_udp_recv_stop(req);</span></span><br><span class="line"><span class="comment">//    &#125;);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uv_buf_t</span> <span class="title function_">thread_uv_receive::make_discover_msg</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">uv_buf_t</span> buffer;</span><br><span class="line"></span><br><span class="line">    alloc_buffer(<span class="literal">NULL</span>, <span class="number">9</span>*<span class="number">1024</span>*<span class="number">7</span>, &amp;buffer);   <span class="comment">//设置发送缓存区（最大设置为64K，超过则会发送失败）</span></span><br><span class="line">    <span class="built_in">memset</span>(buffer.base, <span class="number">0</span>, buffer.len); <span class="comment">//初始化缓存区，全部设置为0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// BOOTREQUEST</span></span><br><span class="line">    buffer.base[<span class="number">0</span>] = <span class="number">0x1</span>;</span><br><span class="line">    <span class="comment">// HTYPE ethernet</span></span><br><span class="line">    buffer.base[<span class="number">1</span>] = <span class="number">0x1</span>;</span><br><span class="line">    <span class="comment">// HLEN</span></span><br><span class="line">    buffer.base[<span class="number">2</span>] = <span class="number">0x6</span>;</span><br><span class="line">    <span class="comment">// HOPS</span></span><br><span class="line">    buffer.base[<span class="number">3</span>] = <span class="number">0x0</span>;</span><br><span class="line">    <span class="comment">// XID 4 bytes</span></span><br><span class="line">    <span class="keyword">if</span> (uv_random(<span class="literal">NULL</span>, <span class="literal">NULL</span>, &amp;buffer.base[<span class="number">4</span>], <span class="number">4</span>, <span class="number">0</span>, <span class="literal">NULL</span>))</span><br><span class="line">        <span class="built_in">abort</span>();</span><br><span class="line">    <span class="comment">// SECS</span></span><br><span class="line">    buffer.base[<span class="number">8</span>] = <span class="number">0x0</span>;</span><br><span class="line">    <span class="comment">// FLAGS</span></span><br><span class="line">    buffer.base[<span class="number">10</span>] = <span class="number">0x80</span>;</span><br><span class="line">    <span class="comment">// CIADDR 12-15 is all zeros</span></span><br><span class="line">    <span class="comment">// YIADDR 16-19 is all zeros</span></span><br><span class="line">    <span class="comment">// SIADDR 20-23 is all zeros</span></span><br><span class="line">    <span class="comment">// GIADDR 24-27 is all zeros</span></span><br><span class="line">    <span class="comment">// CHADDR 28-43 is the MAC address, use your own</span></span><br><span class="line">    buffer.base[<span class="number">28</span>] = <span class="number">0xe4</span>;</span><br><span class="line">    buffer.base[<span class="number">29</span>] = <span class="number">0xce</span>;</span><br><span class="line">    buffer.base[<span class="number">30</span>] = <span class="number">0x8f</span>;</span><br><span class="line">    buffer.base[<span class="number">31</span>] = <span class="number">0x13</span>;</span><br><span class="line">    buffer.base[<span class="number">32</span>] = <span class="number">0xf6</span>;</span><br><span class="line">    buffer.base[<span class="number">33</span>] = <span class="number">0xd4</span>;</span><br><span class="line">    <span class="comment">// SNAME 64 bytes zero</span></span><br><span class="line">    <span class="comment">// FILE 128 bytes zero</span></span><br><span class="line">    <span class="comment">// OPTIONS</span></span><br><span class="line">    <span class="comment">// - magic cookie</span></span><br><span class="line">    buffer.base[<span class="number">236</span>] = <span class="number">99</span>;</span><br><span class="line">    buffer.base[<span class="number">237</span>] = <span class="number">130</span>;</span><br><span class="line">    buffer.base[<span class="number">238</span>] = <span class="number">83</span>;</span><br><span class="line">    buffer.base[<span class="number">239</span>] = <span class="number">99</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// DHCP Message type</span></span><br><span class="line">    buffer.base[<span class="number">240</span>] = <span class="number">53</span>;</span><br><span class="line">    buffer.base[<span class="number">241</span>] = <span class="number">1</span>;</span><br><span class="line">    buffer.base[<span class="number">242</span>] = <span class="number">1</span>; <span class="comment">// DHCPDISCOVER</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// DHCP Parameter request list</span></span><br><span class="line">    buffer.base[<span class="number">243</span>] = <span class="number">55</span>;</span><br><span class="line">    buffer.base[<span class="number">244</span>] = <span class="number">4</span>;</span><br><span class="line">    buffer.base[<span class="number">245</span>] = <span class="number">1</span>;</span><br><span class="line">    buffer.base[<span class="number">246</span>] = <span class="number">3</span>;</span><br><span class="line">    buffer.base[<span class="number">247</span>] = <span class="number">15</span>;</span><br><span class="line">    buffer.base[<span class="number">248</span>] = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> buffer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">on_send</span><span class="params">(<span class="type">uv_udp_send_t</span> *req, <span class="type">int</span> status)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (status) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Send error %s\n&quot;</span>, uv_strerror(status));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">thread_uv_receive::set_uv_receive</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> udp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> udp </tag>
            
            <tag> 测试 </tag>
            
            <tag> libuv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>libudt</title>
      <link href="/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libudt/"/>
      <url>/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libudt/</url>
      
        <content type="html"><![CDATA[<h1 id="libudt"><a href="#libudt" class="headerlink" title="libudt"></a>libudt</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>UDT 是一种可靠的基于 UDP 的应用程序级数据传输协议，用于 广域高速网络上的分布式数据密集型应用。 UDT 使用 UDP 传输批量数据，并具有自己的可靠性控制和 拥塞控制机制。新协议可以以 速度比TCP高。UDT 也是一个高度可配置的框架， 可以适应各种拥塞控制算法。</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>必须为两台主机之间建立 UDT 连接，然后才能使用 UDT 进行数据传输。</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> udp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> udp </tag>
            
            <tag> 测试 </tag>
            
            <tag> libudt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>libpcap</title>
      <link href="/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libpcap/"/>
      <url>/2023/11/16/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/xc7a200t/libpcap/</url>
      
        <content type="html"><![CDATA[<h1 id="libpcap"><a href="#libpcap" class="headerlink" title="libpcap"></a>libpcap</h1><h2 id="操作步骤："><a href="#操作步骤：" class="headerlink" title="操作步骤："></a>操作步骤：</h2><ol><li>获取网络设备名称pcap_lookupdev(err)返回值：char *设备名称</li><li>打开设备 pcap_dev_live(dev,1024,1,0,err)        参数1：设备名称，参数2：数据包长度，参数3：混杂模式（0为非混杂），参数4：0不等待，参数5：错误信息   返回值：句柄 pcap_t  pcap</li><li>获取网段，子网掩码pcap_lookupnet（dev,）</li><li>捕获一次数据包 pcap_next()</li><li>循环捕获数据包 pcap_loop()配合回调函数 : void callback (unsigned * )</li><li>pcap_close()关闭 释放内存</li></ol><h2 id="过滤规则："><a href="#过滤规则：" class="headerlink" title="过滤规则："></a>过滤规则：</h2><ol><li>pcap_compile(pcap_t *p,struct bpf_pro)只获取部分数据（否则将获取全部数据包数据）</li><li>pcap_setfilter()设置过滤规则，可以设置只获取udp</li></ol><h2 id="测试结论："><a href="#测试结论：" class="headerlink" title="测试结论："></a>测试结论：</h2><pre><code>仅linux可以使用，windows会报系统不支持错误。</code></pre>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> udp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> udp </tag>
            
            <tag> 测试 </tag>
            
            <tag> libpcap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HIK</title>
      <link href="/2023/11/16/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/HIK/"/>
      <url>/2023/11/16/%E7%9B%B8%E6%9C%BA%E7%9B%B8%E5%85%B3/HIK/</url>
      
        <content type="html"><![CDATA[<h1 id="HIK"><a href="#HIK" class="headerlink" title="HIK"></a>HIK</h1><h2 id="2K线扫-MV-CL024-91GM"><a href="#2K线扫-MV-CL024-91GM" class="headerlink" title="2K线扫(MV-CL024-91GM)"></a>2K线扫(MV-CL024-91GM)</h2><p><a href="https://www.hikrobotics.com/cn/machinevision/service/download?module=0">MVS下载地址</a></p><h3 id="接口定义"><a href="#接口定义" class="headerlink" title="接口定义"></a>接口定义</h3><p><img src="/.com//HIK/1711533797153.png" alt="1711533797153"></p><h3 id="引脚定义"><a href="#引脚定义" class="headerlink" title="引脚定义"></a>引脚定义</h3><p><img src="/.com//HIK/1711533805397.png" alt="1711533805397"></p><h3 id="倍频设置"><a href="#倍频设置" class="headerlink" title="倍频设置"></a>倍频设置</h3><ol><li>IO Input 类别下</li><li>Trigger Selector 设置 Line Start</li><li>Trigger Mode 设置 On</li><li>Trigger Source 设置 Frequency Conveter</li><li>Frequency Converter Contol 类别下</li><li>Input Source 选择 Line0（用哪个选哪个）</li><li>Multiplier 设置 倍频系数 （最大32倍频）</li></ol><p><img src="/.com//HIK/1711533815173.png" alt="1711533815173"></p><h3 id="编码器模式-部分验证"><a href="#编码器模式-部分验证" class="headerlink" title="编码器模式  (部分验证)"></a>编码器模式  (部分验证)</h3><p><strong>简述</strong>：正反转功能支持42亿，按300周长，每圈1000脉冲计算，可倒转1288490.1882米（一百二十万米） ，  与Basler相同（开启两相输入相当于4倍频，一相输入则相当于2倍频）</p><ol><li>IO Input 类别下</li><li>Trigger Selector 设置 Line Start</li><li>Trigger Mode 设置 On</li><li>Trigger Source 设置 Encoder Module Out</li><li>Encoder Control 类别下</li><li>Encoder Selector 选择 Encoder0</li><li>Encoder Source A 选择 Line0（用哪个选哪个）</li><li>Encoder Source B 选择 Line1</li><li>Encoder Trigger Mode 选择Any Direction（任意方向）还有仅正向或仅反向可选择</li><li>Encoder Counter Mode 选择 Follow Direction&#x2F;Backward Direction（根据方向选择）</li><li>Encoder Counter Max 设置 4294967294</li><li>Encoder Max Reverse Counter 设置 4294967294</li></ol><p><img src="/.com//HIK/1711533823796.png" alt="1711533823796"><br><img src="/.com//HIK/1711533831865.png" alt="1711533831865"></p><h4 id="调试中遇到的问题"><a href="#调试中遇到的问题" class="headerlink" title="调试中遇到的问题"></a>调试中遇到的问题</h4><ul><li>若仅使用1路差分拍照，则Encoder Max Reverse Counter 必须设置未0，否则不出图</li></ul><h3 id="输出IO-（已验证-23年12月）"><a href="#输出IO-（已验证-23年12月）" class="headerlink" title="输出IO  （已验证,23年12月）"></a>输出IO  （已验证,23年12月）</h3><p><strong>简述</strong>： 相机相应功能触发时输出信号给外部设备</p><ol><li>Line Selector 选择 Line3（用哪个选哪个）</li><li>Line Mode 选择 Strobe    (频闪输出)</li><li>Line Source 选择 fram end Active （其它说明：曝光开始有效，会每一行曝光都输出信号）</li><li>Strobe Enable 点击开启</li><li>Strobe Line Duration(us) 设置 10000</li></ol><p><img src="/.com//HIK/1711533841138.png" alt="1711533841138"></p><p>V4.3的驱动(MV-CL086-910C),补充设置如下.海康相机使用line3作为输出信号(差分信号输出),连接差分信号转接板Z+,Z-,通过OUTZ转发给控制器的Z信号输入.控制器开启信号接收打印消息.每张图一个信号,并通过串口返回B3,如图所示.(24年5月29日)</p><p><img src="/.com//HIK/1716950907144.png" alt="1716950907144"></p><p>信号输出类型如下</p><p><img src="/.com//HIK/1711533849526.png" alt="1711533849526"></p><h3 id="变帧-（动态图像高度）"><a href="#变帧-（动态图像高度）" class="headerlink" title="变帧 （动态图像高度）"></a>变帧 （动态图像高度）</h3><p><strong>简述</strong>: 相机输出图像的图像高度可变。最高为设定的图像高度。触发行数不足图像高度则根据Partial Image Output Mode 的设置输出图像，若触发行数超过图像高度，则立即输图像高度行数的图像，并继续触发行。</p><ol><li><p>接线</p><ul><li>行信号输入： Line0</li><li>帧信号输入： Line3</li></ul></li><li><p>设置</p><ul><li><p>触发选择器：行开始</p></li><li><p>触发模式：开启</p></li><li><p>触发源：线路0</p></li><li><p>触发极性：上升沿</p></li><li><p>触发选择器：帧开始</p></li><li><p>触发模式：开启</p></li><li><p>触发源：线路3</p></li><li><p>触发极性：低电平</p></li><li><p>Partial Image Output Mode:PartialImageOutput  &#x2F;&#x2F; 部分图像输出模式</p></li><li><p>行触发设置<img src="/.com//HIK/1711533859287.png" alt="1711533859287"></p></li><li><p>帧触发设置<img src="/.com//HIK/1711533868705.png" alt="1711533868705"></p></li></ul></li><li><p>Partial Image Output Mode 其它模式说明：</p></li></ol><p><img src="/.com//HIK/1711533877525.png" alt="1711533877525"></p><h3 id="帧-行触发缓存"><a href="#帧-行触发缓存" class="headerlink" title="帧&#x2F;行触发缓存"></a>帧&#x2F;行触发缓存</h3><h4 id="帧触发缓存"><a href="#帧触发缓存" class="headerlink" title="帧触发缓存"></a>帧触发缓存</h4><p><strong>简述</strong>： 触发过程若接收到新的触发信号，可将该信号保留并进行处理。在处理当前信号时，触发缓存使能最多能保留 3 个触发信号等待处理。</p><ol><li>设置<ul><li>帧触发缓存使能通过 Acquisition Control 属性下的 Trigger Cache Enable 参数进行控制（说明：必须开启帧触发才可以适用该功能）</li><li><img src="/.com//HIK/1711533887761.png" alt="1711533887761"></li><li>不开启该功能，则触发图像过程中接收到帧信号，则忽略帧信号</li><li>若开启该功能，则触发图像过程中接收到帧信号，则保留帧信号，直到当前图像完成后，立即继续开始第二个帧信号的图像触发，保留的帧信号数量最多可以达到3个。</li><li><img src="/.com//HIK/1711533896113.png" alt="1711533896113"></li></ul></li></ol><h4 id="行触发缓存"><a href="#行触发缓存" class="headerlink" title="行触发缓存"></a>行触发缓存</h4><p><strong>简述</strong>： 实际测试中，开启行触发缓存与关闭行触发缓存似乎并无区别。</p><ol><li>设置<ul><li><img src="/.com//HIK/1711533905446.png" alt="1711533905446"></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> 相机 </category>
          
          <category> HIK </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 相机 </tag>
            
            <tag> 海康 </tag>
            
            <tag> HIK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>部署博客</title>
      <link href="/2023/11/15/%E7%BB%BC%E5%90%88/%E5%8D%9A%E5%AE%A2/hexo_github_vscode_minio/"/>
      <url>/2023/11/15/%E7%BB%BC%E5%90%88/%E5%8D%9A%E5%AE%A2/hexo_github_vscode_minio/</url>
      
        <content type="html"><![CDATA[<h1 id="本地部署博客"><a href="#本地部署博客" class="headerlink" title="本地部署博客"></a>本地部署博客</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>以下方法实现了，同一台主机，部署多个服务，不同域名访问不同服务，同一域名访问不同服务。局域网访问图床图片。的良好体验。</p><h2 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h2><ol><li>安装node.js <a href="https://nodejs.org/en/download/">下载安装包</a></li><li>安装Git</li><li>安装hexo <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure></li><li>初始化<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo init blog</span><br><span class="line">cd blog</span><br><span class="line">npm install</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>安装hexo-deployer-git<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></li><li>在_config.yml中配置<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https://github.com/fengjie1223/fengjie1223.github.io</span><br><span class="line">  branch: main</span><br><span class="line">  token:    //从github设置中获取</span><br></pre></td></tr></table></figure></li><li>生产网页并上传<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d  //三个指令分别为清除，构建，上传</span><br></pre></td></tr></table></figure></li></ol><h2 id="github"><a href="#github" class="headerlink" title="github"></a>github</h2><ol><li>建立名为 &lt;你的 GitHub 用户名&gt;.github.io 的储存库，设置为public</li><li>仓库设置General-&gt;Default branch为main</li><li>仓库设置Pages Build and deployment -&gt; Source-&gt;Github Actions</li><li>Token ：</li></ol><h2 id="minio"><a href="#minio" class="headerlink" title="minio"></a>minio</h2><ol><li>安装minio    <a href="https://min.io/">下载安装包</a></li><li>部署minio    将下载好的exe文件放到准备作为图床文件夹下</li><li>启动minio     用cmd启动，或配置bat文件启动，下述代码为bat文件源码，cmd仅执行最后三行即可<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> @echo off</span><br><span class="line">if &quot;%1&quot; == &quot;h&quot; goto begin</span><br><span class="line">mshta vbscript:createobject(&quot;wscript.shell&quot;).run(&quot;&quot;&quot;%~nx0&quot;&quot; h&quot;,0)(window.close)&amp;&amp;exit</span><br><span class="line">:begin</span><br><span class="line">REM</span><br><span class="line">c:</span><br><span class="line">cd C:\MyServer\markdown_images</span><br><span class="line">setx MINIO_ROOT_USER admin                                  //设置用户名</span><br><span class="line">setx MINIO_ROOT_PASSWORD password                           //设置密码</span><br><span class="line">.\minio.exe server C:\MyServer\markdown_images --address :9000  //启动minio，并将端口号设置为9000（默认为9000）</span><br></pre></td></tr></table></figure></li><li>配置minio    打开127.0.0.1:9000，点击Create Bucket，创建名为mdimage的bucket</li><li>配置权限     点击mdimage仓库，设置Access Policy：为 public</li></ol><h3 id="minio迁移"><a href="#minio迁移" class="headerlink" title="minio迁移"></a>minio迁移</h3><ul><li>推测（未验证）-windows 下迁移，应该是将整个桶文件夹全部复制即可。引用路径似乎是文件夹path+图片名（保存在桶文件里会变成一个以png为后缀的文件夹）</li><li>推测（未验证）下述这三个一起复制即可</li></ul><p><img src="/.com//hexo_github_vscode_minio/1711530791605.png" alt="1711530791605"></p><h2 id="vscode"><a href="#vscode" class="headerlink" title="vscode"></a>vscode</h2><ol><li>安装扩展 vscode-minio-picman （设置地址路径不要带端口号，否则自动返回的地址不带端口号）</li><li>配置vscode-minio-picman  <ol><li>配置地址 <a href="http://cnbed.com:9000/">http://cnbed.com:9000</a> （这里用了域名映射，原地址为127.0.0.1）</li><li>Access Key   uG7bf1JZBf1eCqpjEZ0S</li><li>Secret Key   HAgtVMhGuFgQkGVbIgVSuo9rOKrGODH29H7PkXCy</li><li>Bucket Name  mdimage （这里填写minio创建的仓库的名字）</li><li>Directory    images&#x2F;vscode-minio-picman<br><img src="/.com//hexo_github_vscode_minio/1711531089050.png" alt="1711531089050"></li></ol></li></ol><h2 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h2><ol><li>配置多主机模式，将minio的IP地址及端口映射到cnbed.com</li><li>vscode 配置 minio 地址时填写cnbed.com:9000</li><li>返回的图片链接为cnbed.com&#x2F;***即可直接访问（无端口号）</li><li>路由器配置域名映射cnbed.com到服务器地址，内网即可访问图片</li><li>配置域名解析：C:\Windows\System32\drivers\etc下的hosts文件内最后一行填写&lt;IP地址 域名&gt;，端口号则由nginx解析</li><li>配置同一域名多个服务配置：server块中写多个location块即可，例：   <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    # root   html;</span><br><span class="line">    # index  index.<span class="property">html</span> index.<span class="property">htm</span>;</span><br><span class="line">    proxy_pass <span class="attr">http</span>:<span class="comment">//127.0.0.1:4000;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location /blog&#123;</span><br><span class="line">    proxy_pass <span class="attr">http</span>:<span class="comment">//127.0.0.1:4000/;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location /download&#123;</span><br><span class="line">    proxy_pass <span class="attr">http</span>:<span class="comment">//127.0.0.1:8000/;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>有些服务器不支持同域名多端口，则需要设置独立的域名，即写多个server块，路由器中也将独立的域名映射到服务器地址，例如：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   server&#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name cnbed.com;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:9000;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    server&#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name cnafgit.com;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:3000;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>最后将nginx 使用nssm工具，或使用bat脚本文件，添加到服务中</li></ol><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><ol><li>互联网图床 github smms qiniu等</li><li>图床工具 picgo</li><li>配合quick 脚本可以一键上传并返回链接</li><li>配合obsidian可以一键插入图片</li></ol><p>经验：<br>nginx</p><ul><li>反向代理hexo，若使用alias 指向public index.heml可以使用子域名访问，但会导致不能加载主题，解决办法为hexo使用独立的域名，alias指向改为root即可<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">//主页</span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line"></span><br><span class="line">            # root C:/Users/fengj/OneDrive/Programs/hexo_my_note/public;</span><br><span class="line">            # index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">//文件服务器</span><br><span class="line">                location /HID&#123;</span><br><span class="line"></span><br><span class="line">            autoindex on;             #开启索引功能</span><br><span class="line">            autoindex_exact_size off; # 关闭计算文件确切大小（单位bytes），只显示大概大小（单位kb、mb、gb）</span><br><span class="line">            autoindex_localtime on;   # 显示本机时间而非 GMT 时间</span><br><span class="line">#           charset utf-8; # 避免中文乱码</span><br><span class="line">            alias C:/MyServer/download/HID;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //图床</span><br><span class="line">            server&#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name cnbed.com;</span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://127.0.0.1:9000;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //论坛</span><br><span class="line">    server&#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name cnafbb.com;</span><br><span class="line">        location /&#123;</span><br><span class="line">            proxy_pass http://127.0.0.1:4567;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //同步盘</span><br><span class="line">            server&#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name cnafsyncthing.com;</span><br><span class="line">        location /&#123;</span><br><span class="line">            proxy_pass http://127.0.0.1:8384;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">//博客</span><br><span class="line">    server&#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name cnafblog.com;</span><br><span class="line">        location /&#123;</span><br><span class="line">            root C:/Users/fengj/OneDrive/Programs/hexo_my_note/public;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><p>syncthing</p><ul><li>下载syncthing</li><li>nssm安装服务</li><li>打开网页127.0.0.1:8384</li><li>若同一网络已经有syncthing则会发现设备ID</li><li>打开syncthing-gtk，点击“添加设备”</li><li>输入设备ID，点击“添加”</li><li>同步即可</li><li>评价：简单好用的文件同步软件（同步盘）</li></ul><p>hexo </p><ul><li>不要开启服务器运行（会导致一些问题，例如部分文件不能删除等），使用hexo d -g 生成静态文件，然后使用nginx反向代理即可</li></ul><p>nodebb</p><ul><li>参考<a href="https://docs.nodebb.org/installing/os/windows/">文档</a> </li><li>下载nodebb <a href="https://github.com/NodeBB/NodeBB">地址</a></li><li>检查环境 node -v  npm -v  ,若没有，则下载nodejs并安装</li><li>安装Mongodb 注意事项，只安装服务，不要安装gui（安装太慢），再根据参考文档设置，需要注意：use admin之后的指令，需要设置密码，拷贝指令的时候自己修改 <strong>pwd:</strong> 的密码</li><li>创建nodebb，密码也使用nodebb</li><li>在nodebb文件夹下执行 <code>nodebb setup</code></li><li>等待安装，时间会比较长（似乎不需要外网）</li><li>完成后会提示一些内容，按回车确认，注意：提示输入monogdb用户以及密码的时候 ， 输入之前自己设定的用户名nodebb，密码nodebb，另外提示输入管理用户名的时候，输入admin（或自定义），密码admin（或自定义），记住即可。</li><li>启动nodebb <code>nodebb start</code></li><li>访问127.0.0.1:4567</li><li>使用管理用户登录</li><li>管理设置-&gt;全局常规-&gt;修改标头-&gt;修改语言为中文</li><li>界面主题不要改，若改了之后，出现主题样式丢失，改回默认重新构建重启即可</li><li>nodebb所有信息存储在mongodb中，自己设定的nodebb表中，可以重置mongodb，然后删除nodebb文件夹，重新创建。重置mongodb指令如下：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use your_database_name</span><br><span class="line">db.dropDatabase() </span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
            <tag> hexo </tag>
            
            <tag> github </tag>
            
            <tag> minio </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows局域网共享文件以及远程控制</title>
      <link href="/2023/02/16/%E7%BB%BC%E5%90%88/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/"/>
      <url>/2023/02/16/%E7%BB%BC%E5%90%88/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="windows局域网共享文件以及远程控制"><a href="#windows局域网共享文件以及远程控制" class="headerlink" title="windows局域网共享文件以及远程控制"></a>windows局域网共享文件以及远程控制</h1><blockquote><p>简介:局域网操作,静态IP,支持设置网关,只要ping通即可</p></blockquote><h2 id="一-开启网络共享和网络发现"><a href="#一-开启网络共享和网络发现" class="headerlink" title="一. 开启网络共享和网络发现"></a>一. 开启网络共享和网络发现</h2><p><img src="/.com//windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/1711534038627.png" alt="1711534038627"></p><h2 id="二-共享的文件属性设置共享"><a href="#二-共享的文件属性设置共享" class="headerlink" title="二.共享的文件属性设置共享"></a>二.共享的文件属性设置共享</h2><p><img src="/.com//windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/1711534046031.png" alt="1711534046031"></p><p><img src="/.com//windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/1711534053663.png" alt="1711534053663"></p><h2 id="三-系统属性设置允许远程连接到此电脑"><a href="#三-系统属性设置允许远程连接到此电脑" class="headerlink" title="三.系统属性设置允许远程连接到此电脑"></a>三.系统属性设置允许远程连接到此电脑</h2><p><img src="/.com//windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/1711534062578.png" alt="1711534062578"></p><h2 id="四-设置无密码远程连接-Win-R打开运行输入指令gpedit-msc-打开-本地策略"><a href="#四-设置无密码远程连接-Win-R打开运行输入指令gpedit-msc-打开-本地策略" class="headerlink" title="四.设置无密码远程连接,Win+R打开运行输入指令gpedit.msc,打开:本地策略"></a>四.设置无密码远程连接,Win+R打开运行输入指令gpedit.msc,打开:本地策略</h2><p><img src="/.com//windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/1711534070035.png" alt="1711534070035"></p><p><img src="/.com//windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/1711534076800.png" alt="1711534076800"></p><h2 id="五-切换到远程电脑-打开网络-则会自动搜索到该计算机-若没有搜索到-则在资源管理器的地址栏中输入-192-168-这里的-号是静态IP-则会进入-两个反斜杠不可以少"><a href="#五-切换到远程电脑-打开网络-则会自动搜索到该计算机-若没有搜索到-则在资源管理器的地址栏中输入-192-168-这里的-号是静态IP-则会进入-两个反斜杠不可以少" class="headerlink" title="五. 切换到远程电脑,打开网络,则会自动搜索到该计算机,若没有搜索到,则在资源管理器的地址栏中输入\192.168..(这里的*号是静态IP),则会进入.两个反斜杠不可以少"></a>五. 切换到远程电脑,打开网络,则会自动搜索到该计算机,若没有搜索到,则在资源管理器的地址栏中输入\192.168.<em>.</em>(这里的*号是静态IP),则会进入.两个反斜杠不可以少</h2><p><img src="/.com//windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/1711534086956.png" alt="1711534086956"></p><h2 id="六-远程桌面控制连接-输入静态IP-弹出输入凭证-只需输入用户名-密码一栏不用填写-点击确认即可"><a href="#六-远程桌面控制连接-输入静态IP-弹出输入凭证-只需输入用户名-密码一栏不用填写-点击确认即可" class="headerlink" title="六. 远程桌面控制连接,输入静态IP,弹出输入凭证,只需输入用户名,密码一栏不用填写.点击确认即可"></a>六. 远程桌面控制连接,输入静态IP,弹出输入凭证,只需输入用户名,密码一栏不用填写.点击确认即可</h2><p><img src="/.com//windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/1711534096654.png" alt="1711534096654"></p><p><img src="/.com//windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/1711534104299.png" alt="1711534104299"></p><p><img src="/.com//windows%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/1711534111276.png" alt="1711534111276"></p><p>评价:</p><p>该方法可以在局域网内连接另一台电脑,作为服务器或者资料存储盘,再配合搭建一个http服务器,即可很方便管理,下载大文件.不会有云盘的限速问题.</p><pre><code>(本次的被控对象已经搭建了git服务器以及http服务器&lt;用于下载文件&gt;,远程操作软件使用的todesk(传输大文件很慢),搭建完成后即可使用windows远程桌面服务)</code></pre>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> 办公 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 环境搭建 </tag>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode-开发stm32</title>
      <link href="/2023/02/15/%E7%BB%BC%E5%90%88/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/vscode-%E5%BC%80%E5%8F%91stm32/"/>
      <url>/2023/02/15/%E7%BB%BC%E5%90%88/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/vscode-%E5%BC%80%E5%8F%91stm32/</url>
      
        <content type="html"><![CDATA[<h1 id="vscode-开发stm32"><a href="#vscode-开发stm32" class="headerlink" title="vscode-开发stm32"></a>vscode-开发stm32</h1><h2 id="扩展下载"><a href="#扩展下载" class="headerlink" title="扩展下载"></a>扩展下载</h2><ul><li>keil Assistant</li><li>打开设置</li><li>设置UV4.exe的路径</li><li><img src="/.com//vscode-%E5%BC%80%E5%8F%91stm32/1711531665788.png" alt="1711531665788"></li></ul><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><ul><li>点击KEIL UVISION PROJECT 右侧的加号</li><li>找到keil创建的项目并打开即可，编写代码，编译程序，下载程序等</li></ul><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><ul><li>使用vscode写代码的同时可以打开MDK，进行项目文件结构调整，仿真测试等</li></ul>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> 开发环境 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MDK </tag>
            
            <tag> vscode </tag>
            
            <tag> stm32 </tag>
            
            <tag> keil </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>visual studio 2022中编写Qt项目</title>
      <link href="/2023/02/14/%E7%BB%BC%E5%90%88/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/visual%20studio%202022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/"/>
      <url>/2023/02/14/%E7%BB%BC%E5%90%88/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/visual%20studio%202022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="visual-studio-中编写Qt项目"><a href="#visual-studio-中编写Qt项目" class="headerlink" title="visual studio 中编写Qt项目"></a>visual studio 中编写Qt项目</h1><h2 id="一-visual-studio-2022-安装组件的时候可以选择安装编译器版本（需与Qt版本一致，此处使用的vs2019编译器）"><a href="#一-visual-studio-2022-安装组件的时候可以选择安装编译器版本（需与Qt版本一致，此处使用的vs2019编译器）" class="headerlink" title="一. visual studio 2022 安装组件的时候可以选择安装编译器版本（需与Qt版本一致，此处使用的vs2019编译器）"></a>一. visual studio 2022 安装组件的时候可以选择安装编译器版本（需与Qt版本一致，此处使用的vs2019编译器）</h2><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711533937422.png" alt="1711533937422"></p><h2 id="二-安装Qt扩展-注-此处使用外网安装较快-若没有梯子-则点击右侧的详细信息-进入网页下载后安装"><a href="#二-安装Qt扩展-注-此处使用外网安装较快-若没有梯子-则点击右侧的详细信息-进入网页下载后安装" class="headerlink" title="二. 安装Qt扩展(注:此处使用外网安装较快,若没有梯子,则点击右侧的详细信息,进入网页下载后安装)"></a>二. 安装Qt扩展(注:此处使用外网安装较快,若没有梯子,则点击右侧的详细信息,进入网页下载后安装)</h2><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711533946634.png" alt="1711533946634"></p><h2 id="三-选择Qt版本"><a href="#三-选择Qt版本" class="headerlink" title="三.选择Qt版本"></a>三.选择Qt版本</h2><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711533955150.png" alt="1711533955150"></p><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711533964408.png" alt="1711533964408"></p><h2 id="四-打开Qt项目-将Qt项目转为vs项目"><a href="#四-打开Qt项目-将Qt项目转为vs项目" class="headerlink" title="四. 打开Qt项目(将Qt项目转为vs项目)"></a>四. 打开Qt项目(将Qt项目转为vs项目)</h2><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711533972146.png" alt="1711533972146"></p><h2 id="五-设置默认打开ui文件的打开方式"><a href="#五-设置默认打开ui文件的打开方式" class="headerlink" title="五. 设置默认打开ui文件的打开方式"></a>五. 设置默认打开ui文件的打开方式</h2><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711533981456.png" alt="1711533981456"></p><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711533989867.png" alt="1711533989867"></p><h2 id="六-执行项目-执行成功"><a href="#六-执行项目-执行成功" class="headerlink" title="六. 执行项目(执行成功)"></a>六. 执行项目(执行成功)</h2><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711534001598.png" alt="1711534001598"></p><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711534010120.png" alt="1711534010120"></p><h2 id="七-指定exe输出目录-配置属性-常规-输出目录-链接器-常规-输出文件-即可修改生成项目的exe的输出路径"><a href="#七-指定exe输出目录-配置属性-常规-输出目录-链接器-常规-输出文件-即可修改生成项目的exe的输出路径" class="headerlink" title="七. 指定exe输出目录,配置属性-&gt;常规-&gt;输出目录.链接器-&gt;常规-&gt;输出文件.即可修改生成项目的exe的输出路径."></a>七. 指定exe输出目录,配置属性-&gt;常规-&gt;输出目录.链接器-&gt;常规-&gt;输出文件.即可修改生成项目的exe的输出路径.</h2><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711534019094.png" alt="1711534019094"></p><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711534026687.png" alt="1711534026687"></p><h2 id="八-打开ui文件-几秒后异常退出"><a href="#八-打开ui文件-几秒后异常退出" class="headerlink" title="八. 打开ui文件,几秒后异常退出"></a>八. 打开ui文件,几秒后异常退出</h2><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711589652032.png" alt="1711589652032"></p><ul><li>解决方法1: 选择“扩展-&gt;QT VS Tools-&gt;Options”，对话框中左侧选择“Qt-&gt;General”，右侧选择“Qt Designer-&gt;Run in detached window”选项值设为true 即可解决。</li><li>解决方法2: 右键ui文件,选择打开方式,选择默认使用qtdesigner打开即可</li><li><a href="https://blog.csdn.net/weixin_32155265/article/details/114905744">参考资料</a></li></ul><h2 id="九-控制台输出-qdebug信息无输出"><a href="#九-控制台输出-qdebug信息无输出" class="headerlink" title="九. 控制台输出,qdebug信息无输出"></a>九. 控制台输出,qdebug信息无输出</h2><p>方法一：</p><ol><li><p>右键点击项目名，选择属性</p></li><li><p>更改为如下设置</p></li></ol><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711592413759.png" alt="1711592413759"></p><ol start="3"><li>在运行时就会额外弹出一个命令行窗口</li></ol><p>若不想再弹出这个窗口，将子系统调回 窗口(&#x2F;SUBSYSTEM:WINSOWS 即可</p><p>方法二：（推荐）</p><ol><li><p>在拓展中找到 Qt 选项</p></li><li><p>按如图所示进行修改</p></li></ol><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711592421875.png" alt="1711592421875"></p><ol start="3"><li><p>将 Show debug information 改为 True</p></li><li><p>调试信息将在“输出”栏显示，不会弹出额外的窗口</p></li></ol><p><strong>注意：要在调试器下运行才能看到信息,直接按F5或者点本地windows调试器。</strong></p><p>其他信息：</p><p>将 Qt Designer 中的 Run in detached window 修改为 True，就可以解决部分打不开 .ui 文件的问题</p><p><a href="https://blog.csdn.net/weixin_60101211/article/details/123953957">原文链接：</a></p><h2 id="十-快捷键"><a href="#十-快捷键" class="headerlink" title="十. 快捷键"></a>十. 快捷键</h2><h3 id="格式化代码"><a href="#格式化代码" class="headerlink" title="格式化代码"></a>格式化代码</h3><ol><li>选中需要格式化的代码，然后按Alt+F8</li><li>选中需要格式化的代码，先按Ctrl+K 变成下面的状态，然后再按Ctrl+F</li></ol><h3 id="注释-取消注释"><a href="#注释-取消注释" class="headerlink" title="注释&#x2F;取消注释"></a>注释&#x2F;取消注释</h3><ol><li>注释代码: 选中需要注释的代码，然后按Ctrl+K+C</li><li>取消注释: 选中需要取消注释的代码，然后按Ctrl+K+U</li></ol><h2 id="十一-括号自动补全"><a href="#十一-括号自动补全" class="headerlink" title="十一. 括号自动补全"></a>十一. 括号自动补全</h2><p>工具-&gt;选项-&gt;文本编辑器-&gt;所有语言-&gt;自动补全大括号</p><p><img src="/.com//visualstudio2022%E4%B8%AD%E7%BC%96%E5%86%99Qt%E9%A1%B9%E7%9B%AE/1711594770233.png" alt="1711594770233"></p>]]></content>
      
      
      <categories>
          
          <category> 综合 </category>
          
          <category> 开发环境 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> visual studio </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
